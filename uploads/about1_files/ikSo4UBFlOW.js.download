;/*FB_PKG_DELIM*/

__d("MAWCatQuery.graphql",["cr:11203"],(function(a,b,c,d,e,f){"use strict";e.exports=b("cr:11203")}),null);
__d("MAWCatQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="23999698219677129"}),null);
__d("MAWCatQuery.instagram.graphql",["MAWCatQuery_instagramRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"SecureMessageOverWACATGraphResult",kind:"LinkedField",name:"secure_message_over_wa_cat_query",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"encrypted_serialized_cat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiration_time_in_seconds",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MAWCatQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MAWCatQuery",selections:a},params:{id:b("MAWCatQuery_instagramRelayOperation"),metadata:{},name:"MAWCatQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("MAWCatQuery",["MAWCatQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h!==void 0?h:h=b("MAWCatQuery.graphql");c=a;g["default"]=c}),98);
__d("MAWCryptoAuthToken",["FBLogger","MAWCatQuery","RelayHooks"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a==null||a.secure_message_over_wa_cat_query==null||a.secure_message_over_wa_cat_query.encrypted_serialized_cat==null||a.secure_message_over_wa_cat_query.expiration_time_in_seconds==null?{error:"Crypto Auth Token was null or incomplete"}:{success:{encrypted_serialized_cat:a.secure_message_over_wa_cat_query.encrypted_serialized_cat,expiration_time_in_seconds:a.secure_message_over_wa_cat_query.expiration_time_in_seconds}}}function a(a){return d("RelayHooks").fetchQuery(a,c("MAWCatQuery"),{}).toPromise().then(h).then(function(a){if(a.error!==null&&a.error!==void 0)throw c("FBLogger")("mpf_web_foundations").mustfixThrow("[MAWCryptoAuthToken] Error while fetching CAT from GraphQL: %s",a.error);return a.success})}g.fetchFreshCAT=a}),98);
__d("MAWEARDecryptionError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.name="MawEARError";c.message=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f["default"]=a}),66);
__d("MAWEncryptionErrorHandler",["FBLogger","LSPlatformErrorChannel","MAWEARDecryptionError","MAWSetupWorker","MWDeleteAllDBs","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(){c("promiseDone")(c("MWDeleteAllDBs")("bridge"),function(a){},function(a){c("FBLogger")("mpf_web_foundations").catching(a).mustfix("fail to delete dbs")})}function a(a){c("promiseDone")(d("MAWSetupWorker").killSharedWorkerOrTerminateWebWorkerTmp("EARDecryptionError"),function(a){h()},function(a){c("FBLogger")("mpf_web_foundations").catching(a).mustfix("fail to stop worker"),h()}),c("LSPlatformErrorChannel").emit(new(c("MAWEARDecryptionError"))("MAW DB Decryption Error in "+a+" table"))}g.deleteAllDbs=a}),98);
__d("MAWMiActOnMiThreadReadyForJid",["I64","MAWMiActGetThreadLifecycleState","MAWMiActOnMiThreadReady","WAJids","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c,d,e){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){var g=(yield d("MAWMiActGetThreadLifecycleState").getThreadLifecycleStateByJid(a,(h||(h=d("I64"))).of_string(d("WAJids").threadIdForChatJid(b)),c));return d("MAWMiActOnMiThreadReady").onMiThreadReady(a,g,c,e,f,b)});return i.apply(this,arguments)}g.onMiThreadReadyForJid=a}),98);
__d("MAWMiActOnMiThreadReadyForChatIdOrJid",["MAWMiActOnMiThreadReadyForChatId","MAWMiActOnMiThreadReadyForJid","MAWODSProxy","WAOdsEnums"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e,f,g){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_THREADID_DEPRECATION,key:c!=null?"jid":"chatid"});c==null&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_THREADID_DEPRECATION_DETAILS,key:e});if(c!=null)return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJid(a,c,e,f,g);else return d("MAWMiActOnMiThreadReadyForChatId").onMiThreadReadyForChatId(a,b,e,f,g)}g.onMiThreadReadyForChatIdOrJid=a}),98);
__d("WAChatState",[],(function(a,b,c,d,e,f){"use strict";a="typing";b="recording_audio";c="idle";d={TYPING:a,RECORDING_AUDIO:b};e={IDLE:c};f.TYPING=a;f.RECORDING_AUDIO=b;f.IDLE=c;f.ACTIVE_CHAT_STATE_TYPE=d;f.IDLE_CHAT_STATE_TYPE=e}),66);
__d("MAWBridgeReceivedChatStateHandler",["I64","MAWMiActOnMiThreadReadyForChatIdOrJid","Promise","ServerTime","WAChatState"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.threadId,c.threadJid,"MAWBridgeReceivedChatStateHandler",function(a,e){var f=(i||(i=d("I64"))).of_string(c.senderId),g=i.of_float(3e3+d("ServerTime").getMillis());if(c.state===d("WAChatState").TYPING)return a.typing_indicator.upsert([e,f],{expirationTimestampMs:g,senderId:f,threadKey:e}).then(function(){});else if(c.state===d("WAChatState").IDLE)return a.typing_indicator["delete"](e,f).then(function(){});else return(h||(h=b("Promise"))).resolve()})}g.call=a}),98);
__d("MAWBridgeDeleteGroupInviteHandler",["MAWMiActOnMiThreadReadyForChatIdOrJid","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,c){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.threadId,c.threadJid,"MAWBridgeDeleteGroupInviteHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.group_invites).getKeyRange(c)));return(h||(h=b("Promise"))).all(c.map(function(b){return a.group_invites["delete"](b.threadKey,b.inviterId,b.inviteeId)})).then(function(){})});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeDeleteMessageRangesV2Handler",["I64","MAWMiActOnMiThreadReadyForChatIdOrJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.threadJid,"MAWBridgeDeleteMessageRangesV2Handler",function(a,c){return a.messages_ranges_v2__generated["delete"](c,(h||(h=d("I64"))).of_float(b.minTimestampMs),b.minMsgId)})}g.call=a}),98);
__d("MAWBridgeDeleteMessagesHandler",["MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.threadId,c.threadJid,"MAWBridgeDeleteMessagesHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(var e of c.messages)yield a.messages["delete"](b,d("MAWTimeUtils").toTimestamp(e.ts),e.msgId)});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeDeleteReactionHandler",["I64","MAWMiActOnMiThreadReadyForChatIdOrJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.chatJid,"MAWBridgeDeleteReactionHandler",function(a,c){return a.reactions["delete"](c,b.messageId,(h||(h=d("I64"))).of_string(b.actorId))})}g.call=a}),98);
__d("MAWBridgeEditMsgHistoryAddedHandler",["I64","LSMessageSendStatus","MAWChatJid","Promise","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,e,f){return(i||(i=b("Promise"))).all(f.map(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var f=(yield d("MAWChatJid").toThreadKey(a.tables,b.threadJid));b={messageContent:b.msgContent.content,originalMessagePk:b.originalMsgId,pk:b.editMsgHistoryId,sendStatus:b.sendStatus!=null?(h||(h=d("I64"))).of_int32(b.sendStatus):(h||(h=d("I64"))).of_int32(c("LSMessageSendStatus").SERVER_RECEIVED),serverAdjustedEditTsMs:(h||(h=d("I64"))).of_int32(b.editTs),threadKey:f};return e.edit_message_history.add(b)});return function(a){return f.apply(this,arguments)}}())).then(function(){})}g.call=a}),98);
__d("MAWBridgeGroupInfoUpdatedHandler",["MAWMiActOnMiThreadReadyForChatIdOrJid","ReQL","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,e.threadId,e.chatJid,"MAWBridgeGroupInfoUpdatedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f;f=(f=e.threadName)!=null?f:void 0;a=a.threads;b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(b)));if(b==null)return;var g=c("gkx")("33036")?{needsAdminApprovalForNewParticipant:e.memberAddMode!=="all_member_add"}:{};yield a.put(babelHelpers["extends"]({},b,g,{threadName:f}))});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeGroupInviteLoadedHandler",["fbt","I64","LSMessagingThreadTypeUtil","MAWMiActOnMiThreadReadyForChatIdOrJid","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i;function a(a,c){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.threadId,c.threadJid,"MAWBridgeGroupInviteLoadedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.threads,f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e).getKeyRange(b)));if(f==null)return;var g=d("LSMessagingThreadTypeUtil").isGroup(f.threadType);if(!g)return;var j=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.group_invites).getKeyRange(b)));if(j==null)return;g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts).filter(function(a){return!(i||(i=d("I64"))).equal((i||(i=d("I64"))).of_string(c.actorId),j.inviterId)&&(i||(i=d("I64"))).equal(a.id,j.inviterId)})));if(g==null)return;b=h._("__JHASH__UJFQkCMRFkv__JHASH__",[h._param("Inviter Name",g.name)]).toString();a=f.folderName==="inbox"?h._("__JHASH__4F6x7gUU1-S__JHASH__").toString():f.additionalThreadContext;yield e.put(babelHelpers["extends"]({},f,{additionalThreadContext:a,snippet:b}))});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),226);
__d("LSContactUserBlockAction",[],(function(a,b,c,d,e,f){a=Object.freeze({MN_UNBLOCK:0,MN_BLOCK:1,FB_UNBLOCK:2,FB_BLOCK:3});f["default"]=a}),66);
__d("MAWBlockUtils",["I64","LSContactUserBlockAction","LSIntEnum","LSThreadBitOffset","ReQL","asyncToGeneratorRuntime","promiseDone","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=(k||d("react")).useCallback,m=[0,31,35,55,56,58,24,25,19,85],n=[0,31,35,55,56,58,24,25,19,85,8,22],o=[35,19,85,56,24,25];function a(){var a=(h||(h=c("useReStore")))();return l(function(e,f){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("participants")).getKeyRange(e)));if(b==null)return;var g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("threads")).getKeyRange(b.threadKey).filter(function(a){return(i||(i=d("I64"))).equal(a.threadType,(j||(j=d("LSIntEnum"))).ofNumber(15))})));if(g==null)return;b=(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactUserBlockAction").MN_BLOCK))?d("LSThreadBitOffset").clear(m,g.capabilities,g.capabilities2,g.capabilities3,g.capabilities4):(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactUserBlockAction").FB_BLOCK))?d("LSThreadBitOffset").clear(n,g.capabilities,g.capabilities2,g.capabilities3,g.capabilities4):d("LSThreadBitOffset").set(o,g.capabilities,g.capabilities2,g.capabilities3,g.capabilities4);var h=b[0],k=b[1];yield a.runInTransaction(function(a){var b=babelHelpers["extends"]({},g,{capabilities:h,capabilities2:k});return a.threads.put(b)},"readwrite")})())},[a])}g.clearedMnBlockCapabilities=m;g.clearedFbBlockCapabilities=n;g.useChangeThreadBlockCapabilities=a}),98);
__d("MAWMessageRequestUtil",["I64","LSContactBitOffset","LSContactViewerRelationship","LSIntEnum","LSMessagingThreadTypeUtil"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b,e){if(a==="pending"||a==="other")return!0;var f=d("LSContactBitOffset").hasWithDefault(64,e,!0);return a==="inbox"&&(h||(h=d("I64"))).equal(e.contactViewerRelationship,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactViewerRelationship").NOT_CONTACT))&&!f?b:!1}function k(a){return a==="pending"||a==="other"}function a(a){return d("LSMessagingThreadTypeUtil").isOneToOne(a.threadType)?k(a.folderName):!1}function l(a,b){return b!=null?j(a.folderName,!(h||(h=d("I64"))).equal(a.lastActivityTimestampMs,h.zero),b[1]):!1}function b(a,b){return d("LSMessagingThreadTypeUtil").isOneToOne(a.threadType)?l(a,b):!1}e=[8,18,19,34,24,25,122];f=[21,48];g.isMessageRequestV2=j;g.isOneOnOneMessageRequest=a;g.isOneOnOneMessageRequestV2=b;g.disabledThreadCapabilitiesForIncomingRequest=e;g.enabledThreadCapabilitiesForIncomingRequest=f}),98);
__d("clearedMAWMnRestrictCapabilities",[],(function(a,b,c,d,e,f){"use strict";a=[0,31,35,55,56,58,24,25,35,19];b=a;f["default"]=b}),66);
__d("MAWUpdateLSThreadCapabilities",["fbt","I64","LSBitOffset","LSContactBitOffset","LSContactBlockedByViewerStatus","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MAWBlockUtils","MAWCurrentUser","MAWMessageRequestUtil","Promise","ReQL","asyncToGeneratorRuntime","clearedMAWMnRestrictCapabilities"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=d("MAWCurrentUser").getID(),m=(k||(k=d("I64"))).of_string(l);function a(a,c){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(c)).then(function(c){if(c==null)return(i||(i=b("Promise"))).resolve();var e=d("LSBitOffset").set((j||(j=d("LSIntEnum"))).ofNumber(27),c.capabilities);c=babelHelpers["extends"]({},c,{capabilities:e});return a.threads.put(c)}).then(function(){})}function e(a,c){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(c)).then(function(c){if(c==null)return(i||(i=b("Promise"))).resolve();var e=d("LSBitOffset").clear((j||(j=d("LSIntEnum"))).ofNumber(27),c.capabilities);c=babelHelpers["extends"]({},c,{capabilities:e});return a.threads.put(c)}).then(function(){})}function f(a,e){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(e)).then(function(c){if(c==null)return(i||(i=b("Promise"))).resolve([void 0,void 0]);var f=d("ReQL").firstAsync(d("LSMessagingThreadTypeUtil").isOneToOne(c.threadType)?d("ReQL").mergeJoin(d("ReQL").fromTableAscending(a.participants).getKeyRange(e),d("ReQL").fromTableAscending(a.contacts)).filter(function(a){a=a[1];return!(k||(k=d("I64"))).equal(a.id,m)}).map(function(a){a=a[1];return a}):d("ReQL").empty());return(i||(i=b("Promise"))).all([i.resolve(c),f])}).then(function(e){var f=e[0];if(f==null)return(i||(i=b("Promise"))).resolve();e=e[1];if(e==null)return(i||(i=b("Promise"))).resolve();var g=(k||(k=d("I64"))).equal(e.blockedByViewerStatus,(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactBlockedByViewerStatus").MESSAGE_BLOCKED)),h=k.equal(e.blockedByViewerStatus,j.ofNumber(c("LSContactBlockedByViewerStatus").FULLY_BLOCKED));e=d("LSContactBitOffset").has(66,e);h=h?d("LSThreadBitOffset").clear(d("MAWBlockUtils").clearedFbBlockCapabilities,f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4):g?d("LSThreadBitOffset").clear(d("MAWBlockUtils").clearedMnBlockCapabilities,f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4):e?d("LSThreadBitOffset").clear(c("clearedMAWMnRestrictCapabilities"),f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4):[f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4];g=h[0];e=h[1];var l=h[2];h=h[3];return a.threads.put(babelHelpers["extends"]({},f,{capabilities:g,capabilities2:e,capabilities3:l,capabilities4:h})).then(function(){})})}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=a.threads;c=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(c)));if(c==null)return(i||(i=b("Promise"))).resolve();var e=d("LSThreadBitOffset").set.apply(d("LSThreadBitOffset"),[d("MAWMessageRequestUtil").disabledThreadCapabilitiesForIncomingRequest].concat(d("LSThreadBitOffset").clear(d("MAWMessageRequestUtil").enabledThreadCapabilitiesForIncomingRequest,c.capabilities,c.capabilities2,c.capabilities3,c.capabilities4))),f=e[0],g=e[1],h=e[2];e=e[3];yield a.put(babelHelpers["extends"]({},c,{additionalThreadContext:void 0,capabilities:f,capabilities2:g,capabilities3:h,capabilities4:e}))});return o.apply(this,arguments)}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(b)));if(b==null)return;var e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts).filter(function(a){return(k||(k=d("I64"))).equal(a.id,c)})));if(e==null)return;e=h._("__JHASH__uQTwTbCP0iW__JHASH__",[h._param("Inviter Name",e.name)]).toString();var f=d("LSThreadBitOffset").set([105],b.capabilities,b.capabilities2,b.capabilities3,b.capabilities4),g=f[0],i=f[1],j=f[2];f=f[3];yield a.threads.put(babelHelpers["extends"]({},b,{capabilities:g,capabilities2:i,capabilities3:j,capabilities4:f,snippet:e}))});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(c)));if(e==null)return;c=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.group_invites).getKeyRange(c)));var f=d("LSThreadBitOffset").clear([105],e.capabilities,e.capabilities2,e.capabilities3,e.capabilities4),g=f[0],h=f[1],i=f[2];f=f[3];yield a.threads.put(babelHelpers["extends"]({},e,{capabilities:g,capabilities2:h,capabilities3:i,capabilities4:f,snippet:void 0}));yield c.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield a.group_invites["delete"](b.threadKey,b.inviterId,b.inviteeId)});return function(a){return c.apply(this,arguments)}}())});return s.apply(this,arguments)}g.enableAddMembersTxn=a;g.disableAddMembersTxn=e;g.disableBlockerCapabilitiesTxn=f;g.updateNonMessageRequestThreadTxn=n;g.setGroupInviteTxn=p;g.clearGroupInviteTxn=r}),226);
__d("MAWBridgeGroupInviteUpdateHandler",["I64","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWUpdateLSThreadCapabilities","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.threadId,c.threadJid,"MAWBridgeGroupInviteUpdateHandler",function(a,e){var f=(i||(i=d("I64"))).of_string(c.inviterId);return(h||(h=b("Promise"))).all([d("MAWUpdateLSThreadCapabilities").setGroupInviteTxn(a,e,f)]).then(function(){})})}g.call=a}),98);
__d("MAWBridgeHandleCOPDigest",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,c){return(g||(g=b("Promise"))).resolve()}f.call=a}),66);
__d("MAWBridgeMediaExpiredHandler",["MAWMiActOnMiThreadReadyForChatIdOrJid"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.threadJid,"MAWBridgeMediaExpiredHandler.bs",function(a,c){return a.attachments["delete"](c,b.msgId,String(b.mediaId))})}g.call=a}),98);
__d("LSInsertNewMessageRangeStoredProcedure",["LSInsertNewMessageRange","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.newMinTs;d[2]=b.newMaxTs;d[3]=b.newMinMid;d[4]=b.newMaxMid;d[5]=b.lowerOverlap;d[6]=b.upperOverlap;d[7]=b.hasMoreBefore;d[8]=b.hasMoreAfter;d[9]=b.requestedMessageId;return c("LSInsertNewMessageRange").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWBridgeMsgRangeLoadedHandler",["I64","LSFactory","LSInsertNewMessageRangeStoredProcedure","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils","Promise","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["No messages found for thread "," with message id ",""]);j=function(){return a};return a}function a(a,e){if(e.rangeExtensionType==null){d("WALogger").ERROR(j(),e.threadId,e.offsetMsgId);return(i||(i=b("Promise"))).resolve()}return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,e.threadId,e.threadJid,"MAWBridgeMsgRangeLoadedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f,g,i,j,k,l;f=((f=e.rangeExtensionType)==null?void 0:f.minMsgTs)!=null?(h||(h=d("I64"))).of_float(e.rangeExtensionType.minMsgTs):d("MAWTimeUtils").MIN_TIMESTAMP_MS;g=((g=e.rangeExtensionType)==null?void 0:g.maxMsgTs)!=null?(h||(h=d("I64"))).of_float(e.rangeExtensionType.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS;i=(i=(i=e.rangeExtensionType)==null?void 0:i.minMsgId)!=null?i:"";j=(j=(j=e.rangeExtensionType)==null?void 0:j.maxMsgId)!=null?j:"";k=(k=(k=e.rangeExtensionType)==null?void 0:k.hasMoreBefore)!=null?k:!1;l=(l=(l=e.rangeExtensionType)==null?void 0:l.hasMoreAfter)!=null?l:!1;var m=e.offsetMsgId;yield c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:l,hasMoreBefore:k,lowerOverlap:f,newMaxMid:j,newMaxTs:g,newMinMid:i,newMinTs:f,requestedMessageId:m,threadKey:b,upperOverlap:g})});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWLocalizationEphemeralSettingSetAdminMsg",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.EPHEMERAL_SETTINGS_AUTO_RESET}g.isEphemeralSettingSetAdminMsg=a}),98);
__d("MAWAdminMsgCTA",["fbt","I64","MAWLocalizationEphemeralSettingSetAdminMsg","MAWLocalizationType","MAWTimeUtils","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=h._("__JHASH__iw7A0LnsmaW__JHASH__").toString(),l=h._("__JHASH__jODYJ2eW1Pa__JHASH__").toString(),m=h._("__JHASH__xAOSvpC7vLN__JHASH__").toString(),n=h._("__JHASH__P5k2go6lj2P__JHASH__").toString();function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.admin_message_ctas.index("ctaId"))));return a!=null?(j||(j=d("I64"))).add(a.ctaId,(j||(j=d("I64"))).one):(j||(j=d("I64"))).zero});return p.apply(this,arguments)}function q(a,b,c){b=[b,c];return d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.admin_message_ctas).bounds({gte:b,lte:b}))}function r(a){if(a==null)return{showAdChoiceIcon:!1};if(d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(a))return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:k};switch(a){case d("MAWLocalizationType").CUTOVER_THREAD_ADMIN_MESSAGE:case d("MAWLocalizationType").CUTOVER_IGD_THREAD_ADMIN_MESSAGE:case d("MAWLocalizationType").E2EE_THREAD_DESCRIPTION:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:l};case d("MAWLocalizationType").CUTOVER_ROLLBACK_ADMIN_MESSAGE:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:m};case d("MAWLocalizationType").DUAL_THREAD_CUTOVER_ADMIN_MESSAGE:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:n};default:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:void 0}}}function s(a){if(a==null)return;if(d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(a))return"admin_msg_armadillo_ephemeral_change_duration";switch(a){case d("MAWLocalizationType").CUTOVER_THREAD_ADMIN_MESSAGE:case d("MAWLocalizationType").CUTOVER_IGD_THREAD_ADMIN_MESSAGE:return"admin_msg_thread_level_cutover";case d("MAWLocalizationType").E2EE_THREAD_DESCRIPTION:return"admin_msg_e2ee_thread";case d("MAWLocalizationType").CUTOVER_ROLLBACK_ADMIN_MESSAGE:return"admin_msg_cutover_rollback";case d("MAWLocalizationType").DUAL_THREAD_CUTOVER_ADMIN_MESSAGE:return"admin_msg_dual_thread_cutover"}}function t(a,b,c,d,e){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){yield a.admin_message_ctas.add({actionUrl:f.actionUrl,adClientToken:f.adClientToken,adHelpUrl:f.adHelpUrl,adminMessageNicknameParticipantId:f.adminMessageNicknameParticipantId,adPreferenceUrl:f.adPreferenceUrl,ctaId:b,messageId:e.msgId,showAdChoiceIcon:f.showAdChoiceIcon,targetId:f.targetId,targetTitle:f.targetTitle,threadKey:c,timestampMs:d("MAWTimeUtils").toTimestamp(e.ts),title:f.title})});return u.apply(this,arguments)}function v(a,b,c){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d){var e=(yield (i||(i=b("Promise"))).all([q(a,c,d.msgId),o(a)])),f=e[0];e=e[1];if(f!=null)return{ctaId:f.ctaId,ctaType:s(d.adminType),title:f.title};else{f=r(d.adminType);yield t(a,e,c,d,f);return{ctaId:e,ctaType:s(d.adminType),title:f.title}}});return w.apply(this,arguments)}function a(a,c,e){var f=e.adminType;return f!=null&&(d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(f)||f===d("MAWLocalizationType").CUTOVER_THREAD_ADMIN_MESSAGE||f===d("MAWLocalizationType").CUTOVER_IGD_THREAD_ADMIN_MESSAGE||f===d("MAWLocalizationType").E2EE_THREAD_DESCRIPTION||f===d("MAWLocalizationType").CUTOVER_ROLLBACK_ADMIN_MESSAGE||f===d("MAWLocalizationType").DUAL_THREAD_CUTOVER_ADMIN_MESSAGE)?v(a,c,e):(i||(i=b("Promise"))).resolve()}g.getAdminMsgCtaStep=a}),226);
__d("MAWMsgReplyStatus",["LSIntEnum","LSReplyMessageStatus","MAWMsgType"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){switch(a){case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:case d("MAWMsgType").MSG_TYPE.REVOKED:return c("LSReplyMessageStatus").DELETED;case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return c("LSReplyMessageStatus").VALID;case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:return c("LSReplyMessageStatus").TEMPORARY_UNAVAILABLE;case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:return c("LSReplyMessageStatus").UNKNOWN;case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:return c("LSReplyMessageStatus").EXPIRED;default:return void 0}}function a(a){a=i(a.replyStatusType);if(a!=null)return(h||(h=d("LSIntEnum"))).ofNumber(a)}g.getReplyMessageStatus=i;g.getLSReplyMessageStatus=a}),98);
__d("MAWMsgReplySnippet",["fbt","I64","LSIntEnum","LSReplyMessageAttachmentType","LSReplyMessageStatus","MAWMsgReplyStatus","MAWMsgType","MAWSubscribeToContactNames","MAWTimeUtils","ODS","Promise","ReQL","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l;function m(a){var b=a.isAuthorMe,e=a.isDeletedMsg,f=a.isIGXMAStoryShare;f=f===void 0?!1:f;var g=a.isNoteReply;g=g===void 0?!1:g;var i=a.isPostPrivateReply;i=i===void 0?!1:i;var k=a.isStoryHighlightShare;k=k===void 0?!1:k;var m=a.isStoryMention;m=m===void 0?!1:m;var n=a.isStoryReaction;n=n===void 0?!1:n;var o=a.isStoryReply;o=o===void 0?!1:o;var p=a.isStoryShare;p=p===void 0?!1:p;var q=a.recipientName,r=a.replyAttachmentType,s=a.replySenderIsMe;s=s===void 0?!1:s;var t=a.replySenderIsRecepient;t=t===void 0?!1:t;var u=a.senderName;a=a.storyShareAuthor;switch(!0){case k:return a!=null?h._("__JHASH__3A-F80NGMR1__JHASH__",[h._param("username",a)]):h._("__JHASH__btyC9aNJMDF__JHASH__");case f&&r!=null&&(j||(j=d("I64"))).equal(r,(l||(l=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").FEED_POST)):return a!=null?h._("__JHASH__xnZ-ffIPZnP__JHASH__",[h._param("username",a)]):h._("__JHASH__nEqZlivBoJj__JHASH__");case b&&e:return h._("__JHASH__FzueDOoURT8__JHASH__");case b&&p:return h._("__JHASH__d4DLCdwDC03__JHASH__");case b&&n:return h._("__JHASH__yaEVWahdF8q__JHASH__");case b&&m:return q!=null?h._("__JHASH__ZcIFbzn42DR__JHASH__",[h._param("name",q)]):h._("__JHASH__M3uJqhYYEHf__JHASH__");case m:return h._("__JHASH__dgpS1OhnF7B__JHASH__");case b&&i:return q!=null?h._("__JHASH__VKBGNzy_Yqs__JHASH__",[h._param("name",q)]):h._("__JHASH__n0YtGhrNuCJ__JHASH__");case i:return h._("__JHASH__i08IJ6pj_jc__JHASH__",[h._param("name",u)]);case!b&&g:return h._("__JHASH__6yn4tcYSSq3__JHASH__",[h._param("name",u)]);case b&&g:return h._("__JHASH__XYG_9W-CuAE__JHASH__");case b&&s:return h._("__JHASH__GiGYAtipVIl__JHASH__");case b&&o:return q!=null?h._("__JHASH__ZkkDtvZx-as__JHASH__",[h._param("name",q)]):h._("__JHASH__GEUovmERkjj__JHASH__");case b:return q!=null?h._("__JHASH__eQLjVyXwwuH__JHASH__",[h._param("other_name",q)]):h._("__JHASH__NYU_gsfRGpq__JHASH__");case e:return h._("__JHASH__30kvLEU_B_p__JHASH__",[h._param("name",u)]);case p:return h._("__JHASH__JQwHPEO2e9j__JHASH__",[h._param("user",u)]);case n:return h._("__JHASH__BS0JbOB2Hdc__JHASH__");case t:return h._("__JHASH__RWi7lW394uo__JHASH__",[h._param("other",u)]);case s&&o:return h._("__JHASH__zc6GoZLyKDZ__JHASH__",[h._param("name",u)]);case s:return h._("__JHASH__uU6-xunUPnp__JHASH__",[h._param("other_name",u)]);default:return q!=null?h._("__JHASH__iOHMd6RP1E7__JHASH__",[h._param("other",u),h._param("other_name",q)]):h._("__JHASH__JL2f9yie2zt__JHASH__",[h._param("other",u)])}}function a(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var h=f.isAuthorMe,l=f.isIGXMAStoryShare,n=f.isNoteReply,p=n===void 0?!1:n;n=f.isPostPrivateReply;var q=n===void 0?!1:n;n=f.isStoryHighlightShare;var r=n===void 0?!1:n;n=f.isStoryMention;var s=n===void 0?!1:n,t=f.isStoryReaction,u=f.isStoryReply;n=f.isStoryShare;var v=n===void 0?!1:n,w=f.msgId,x=f.originalTs,y=f.replySenderIsMe;n=f.replySourceId;var z=f.replyStatusType,A=f.replyToUserId,B=f.sender,C=f.storyShareAuthor,D=f.ts,E=f.type_;if(n==null&&!v&&!s&&!r&&!p)return(i||(i=b("Promise"))).resolve();if(A==null||B==null)throw c("err")("Error getting reply snippet without replyToUserId or sender");f=d("MAWSubscribeToContactNames").getContactNameFromContactID(e,(j||(j=d("I64"))).of_string(A),d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME,g)==null;n=d("MAWSubscribeToContactNames").getContactNameFromContactID(e,j.of_string(B),d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME,g)==null;(k||(k=d("ODS"))).bumpEntityKey(3185,"armadillo_reply","creating_reply_snippet");f&&n?(k||(k=d("ODS"))).bumpEntityKey(3185,"armadillo_reply","missing_both"):n?(k||(k=d("ODS"))).bumpEntityKey(3185,"armadillo_reply","missing_sender"):f&&(k||(k=d("ODS"))).bumpEntityKey(3185,"armadillo_reply","missing_reply_to");n=(yield d("MAWSubscribeToContactNames").getContactNamesFromContactIDs({contactIDs:[A,B],db:a,nameMode:d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME,onResolve:function(b){var e,f=b[0];b=b[1];return o(a,g,d("MAWTimeUtils").toTimestamp(E===d("MAWMsgType").MSG_TYPE.REVOKED?(e=x)!=null?e:D:D),w,(e=m({isAuthorMe:h,isDeletedMsg:d("MAWMsgReplyStatus").getReplyMessageStatus(z)===c("LSReplyMessageStatus").DELETED,isIGXMAStoryShare:l,isNoteReply:p,isPostPrivateReply:q,isStoryHighlightShare:r,isStoryMention:s,isStoryReaction:t,isStoryReply:u,isStoryShare:v,recipientName:f,replySenderIsMe:y,replySenderIsRecepient:B===A,senderName:b,storyShareAuthor:C}))==null?void 0:e.toString())},subscriptionKey:w,threadKey:g,txn:e}));e=n[0];n=n[1];return(i||(i=b("Promise"))).resolve((f=m({isAuthorMe:h,isDeletedMsg:d("MAWMsgReplyStatus").getReplyMessageStatus(z)===c("LSReplyMessageStatus").DELETED,isIGXMAStoryShare:l,isNoteReply:p,isPostPrivateReply:q,isStoryHighlightShare:r,isStoryMention:s,isStoryReaction:t,isStoryReply:u,isStoryShare:v,recipientName:f?void 0:e,replySenderIsMe:y,replySenderIsRecepient:B===A,senderName:n,storyShareAuthor:C}))==null?void 0:f.toString())});return n.apply(this,arguments)}function o(a,c,e,f,g){return a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.messages;var b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(c,e,f)));b&&(yield a.put(babelHelpers["extends"]({},b,{replySnippet:g})))});return function(b){return a.apply(this,arguments)}}(),"readwrite")}g.buildLocalizedReplySnippet=m;g.getReplySnippet=a}),226);
__d("MAWAdminMsg",["fbt","MAWLocalizationType"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a,b,c){switch(c){case d("MAWLocalizationType").LOCALIZATION_TYPE.EMPTY_SNIPPET:return"";case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CREATED_GROUP:return h._("__JHASH__28E9UX9VhHs__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CREATED_GROUP:return h._("__JHASH__vc0hFTqTXzB__JHASH__",[h._param("actor",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_CREATED_GROUP:return h._("__JHASH__A65kSvLIBs0__JHASH__",[h._param("product name","group")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP:return h._("__JHASH__ioocxZa3RHl__JHASH__",[h._param("custom group name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP:return h._("__JHASH__BkA5SKyiWz8__JHASH__",[h._param("custom group name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP:return h._("__JHASH__3pkJPr0kqiB__JHASH__",[h._param("actor",b[0]),h._param("custom group name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE:return h._("__JHASH__7HvCssg8rpe__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:return h._("__JHASH__HcuOxk4Ti9n__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE:return h._("__JHASH__z8kxY36E7hc__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:return h._("__JHASH__CWI7wNEpg6X__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE:return h._("__JHASH__dMTvVUpHIHh__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:return h._("__JHASH__B5b_7hBmzMu__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:return h._("__JHASH__IquH8JP7g3o__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:return h._("__JHASH__6LexHwivW4N__JHASH__",[h._param("user_name_1",b[0]),h._param("user_name_2",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:return h._("__JHASH__xpYfCqAeoRq__JHASH__",[h._param("user_name",b[0]),h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:return h._("__JHASH__6Z1J4va4_8C__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:return h._("__JHASH__Usbik5t1nBt__JHASH__",[h._param("actor",b[0]),h._param("user_name",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:return h._("__JHASH__P_OgxVnWQoE__JHASH__",[h._param("actor",b[0]),h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:return h._("__JHASH__bobEEsoK5wj__JHASH__",[h._param("actor",b[0]),h._param("user_name",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:return h._("__JHASH__XQQ_fX0JL2u__JHASH__",[h._param("actor",b[0]),h._param("user_name_1",b[1]),h._param("user_name_2",b[2])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:return h._("__JHASH__gdN-cHBGTgb__JHASH__",[h._param("actor",b[0]),h._param("user_name_1",b[1]),h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:return h._("__JHASH__T1eI6-R4Ys3__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:return h._("__JHASH___J2BJijyg1Y__JHASH__",[h._param("user_name_1",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:return h._("__JHASH__GQYeJHPPFBL__JHASH__",[h._param("user_name_1",b[0]),h._param("user_name_2",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:return h._("__JHASH__7gBXJGJs1RC__JHASH__",[h._param("name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_LEFT_GROUP:return h._("__JHASH__twBESU9lMQ5__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_PROMOTED:return h._("__JHASH__P-TnfmXUkkU__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_DEMOTED:return h._("__JHASH__TyOeMbh9c3n__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_PROMOTED:return h._("__JHASH__g2Y-AkokbQi__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_DEMOTED:return h._("__JHASH__QbDk7QLMtd0__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_YOU:return h._("__JHASH__vcVM9mG_n59__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_YOU:return h._("__JHASH__0ly_0rO21jd__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_PARTICIPANT:return h._("__JHASH__aRkzLhFK0tk__JHASH__",[h._param("actor",b[0]),h._param("target",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_PARTICIPANT:return h._("__JHASH__wIEAcacoGC2__JHASH__",[h._param("actor",b[0]),h._param("target",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_DEMOTED_PARTICIPANT:return h._("__JHASH__BVroDb3uWvG__JHASH__",[h._param("target",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PROMOTED_PARTICIPANT:return h._("__JHASH__XW8QFefwwka__JHASH__",[h._param("target",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SELF_DEMOTED:return h._("__JHASH__-JHaYRzvfpN__JHASH__",[h._param("actor",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SELF_DEMOTED:return h._("__JHASH__h_Dfa2FiN92__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT:return h._("__JHASH__3iBxxmwApDO__JHASH__").toString()+": "+a[0];case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT:return a[0];case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP:return b[0]+": "+a[0];case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_IMAGE:return h._("__JHASH__4-ojL4cFyDj__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_VIDEO:return h._("__JHASH___R0NFo7psqZ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_AUDIO:return h._("__JHASH__NHZzbHt5fju__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_GIF:return h._("__JHASH__GgLzAe6GAAY__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STICKER:return h._("__JHASH__WYnHcQZeijb__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT:return h._("__JHASH__SkQ-qpSqtIH__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_POST:return h._("__JHASH__Z9w9ch9TmJt__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_REEL:return h._("__JHASH__-kgYEsPaCeZ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY:return h._("__JHASH__BxMycMKsI8g__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_EVENT:return h._("__JHASH__AdIYNNW8_BB__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY_HIGHLIGHT:return h._("__JHASH__HZfnisG5R39__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MENTIONED_STORY_IG:return h._("__JHASH__Mv-TBSZDdsn__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_RECEIVED_STORY_MENTION_IG:return h._("__JHASH__XUTKHUpfCZy__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_IMAGE:return h._("__JHASH__u9NG1-EYfRE__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_VIDEO:return h._("__JHASH__GZrAjs4uDve__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_AUDIO:return h._("__JHASH__B_Zg5gCb8wv__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_GIF:return h._("__JHASH__-LJU6ON9QlF__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER:return h._("__JHASH__j_PEgQByu4Z__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_POST:return h._("__JHASH__kF-N_lTEwQJ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_REEL:return h._("__JHASH__T_Dsx3yPqqa__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT:return h._("__JHASH__1gzdEGkoXLS__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY:return h._("__JHASH__ssliyU4f4NG__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_EVENT:return h._("__JHASH___YfY9t5KQWL__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY_HIGHLIGHT:return h._("__JHASH__8KU-2G3ySrJ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET:return h._("__JHASH__7Iefg1P6g_q__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.TWO_USERS_CONNECTED:return h._("__JHASH__m7k67dqAe-2__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.TWO_USERS_CONNECTED_ONE_MSPLIT:return h._("__JHASH__aRupJlbtkO6__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.REACHABILITY_ERROR:return h._("__JHASH__NRCMN2f5KgC__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS:return h._("__JHASH__sj-fVuDqzhT__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES:return h._("__JHASH__5cVU7cjznSj__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS:return h._("__JHASH__kA9pD-FL4Ok__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS:return h._("__JHASH__zs_s82I9sqr__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS:return h._("__JHASH__yoeh6xz8ysN__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES:return h._("__JHASH__IR8E-wTaoC7__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS:return h._("__JHASH__FtQHajIZT7O__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS:return h._("__JHASH__X1cC2Zoa_3e__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS:return h._("__JHASH__-Icsu85gBJR__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES:return h._("__JHASH__UyMMdA4sswt__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS:return h._("__JHASH__73KeDoE7JjC__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS:return h._("__JHASH__CPSmiyxmjWu__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS:return h._("__JHASH__q1Dv0IsA2nN__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES:return h._("__JHASH__p0MNCtvKqaA__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS:return h._("__JHASH__kwfHljZ5QBG__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS:return h._("__JHASH__LHoPMyBE8HS__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:return h._("__JHASH__3payMdHFpIG__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:return h._("__JHASH__jGBmm4ejMgy__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:return h._("__JHASH__qhFzcdaO4tc__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:return h._("__JHASH__mFO6ihhTf9z__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:return h._("__JHASH__rFeQsz2D0mv__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:return h._("__JHASH__vASZV8VZvhw__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:return h._("__JHASH__Xyk76kpov4j__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:return h._("__JHASH__qtvuopqU1MA__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS:return h._("__JHASH__JZBNdaseKxP__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES:return h._("__JHASH__A8DUzBDIb2y__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS:return h._("__JHASH__HDouCIRR46A__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS:return h._("__JHASH__Al3hxA_-BOo__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS:return h._("__JHASH__tOdgin1piov__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES:return h._("__JHASH__tU7ZycHCBtt__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS:return h._("__JHASH__SXTBhBt2NNW__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS:return h._("__JHASH__oSyzRtJUP0d__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOUR_DEVICE_ICDC_ALERT_ADMIN_MESSAGE:return h._("__JHASH__CwVMDBdJz99__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE:return h._("__JHASH__J_nCpYMiV9y__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE:return h._("__JHASH__cFpYB9yRAJx__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE:return h._("__JHASH__2BRCng4CCeO__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_ROLLBACK_ADMIN_MESSAGE:return h._("__JHASH__EP_oerZBdU2__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.ICDC_ALERT_ADMIN_MESSAGE:return h._("__JHASH__m4TBULz6nGb__JHASH__",[h._param("name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS:return h._("__JHASH__OlufOqEL22J__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES:return h._("__JHASH__WsnGvhfXA1z__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS:return h._("__JHASH__-AjaRzqpVqP__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS:return h._("__JHASH__9J66m6GILCR__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_SECONDS:return h._("__JHASH__hcupvvFLxCq__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_MINUTES:return h._("__JHASH__fBAvJP2p_1B__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_HOURS:return h._("__JHASH__4ozbPFF4k4a__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_YOU_EPHEMERAL_SETTING_CHANGE_DAYS:return h._("__JHASH__WyaiaRRbnKj__JHASH__",[h._plural(parseInt(a[0],10),"number")]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:return h._("__JHASH__xMDY8VdzA5b__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:return h._("__JHASH__iM5zzplvQK3__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:return h._("__JHASH__Bm8ehdh1jFk__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:return h._("__JHASH__9pVHLxCaDgx__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:return h._("__JHASH__iNw3Tti4Hyx__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:return h._("__JHASH__fCn7GcPwiSh__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:return h._("__JHASH__g-ahVqaxxG1__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SEND_BASED_PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:return h._("__JHASH__WlJQEt8_oGK__JHASH__",[h._plural(parseInt(a[0],10),"number"),h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF:return h._("__JHASH__Loj0OkThL6V__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF:return h._("__JHASH__tR4q6c00--C__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF:return h._("__JHASH__M2dZfT7rhFT__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.EPHEMERAL_SETTINGS_AUTO_RESET:return h._("__JHASH__iGMaDEsRW87__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNSENT_MESSAGE:return h._("__JHASH__HpovaTJp70W__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNSENT_MESSAGE:return h._("__JHASH__zbO84srNMHF__JHASH__",[h._param("first name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE_IN_GROUP:return h._("__JHASH__31MoZ8hsHC1__JHASH__",[h._param("name",b[0]),h._param("emoji",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE:return h._("__JHASH__5oboVZPgKpA__JHASH__",[h._param("emoji",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_TAKE_SCREENSHOT:return h._("__JHASH__j47-K7rZuN___JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_RECORD_SCREEN:return h._("__JHASH__NNSrUYXKqRz__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_TAKE_SCREENSHOT:return h._("__JHASH__7NL8DHtxILK__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_RECORD_SCREEN:return h._("__JHASH__vrGwrec4csR__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT:return h._("__JHASH__GAoFX2GSYx-__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN:return h._("__JHASH__f2dqrRKp1Rl__JHASH__",[h._param("user",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION:return h._("__JHASH__84N8vT7fmIh__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU:return h._("__JHASH__k7nqRDWCEqt__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_ONE_USER:return h._("__JHASH__vzYvZZNuBUQ__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER:return h._("__JHASH__kEvDhH7xulF__JHASH__",[h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_ONE_USER:return h._("__JHASH__xyM-QHTai_C__JHASH__",[h._param("user_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_TWO_USER:return h._("__JHASH__5P3Id9aMhA-__JHASH__",[h._param("user_name_1",b[0]),h._param("user_name_2",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_MORE_THAN_TWO_USER:return h._("__JHASH__8qUm4dkQH-w__JHASH__",[h._param("user_name_1",b[0]),h._param("number of participants",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.DEBUG_MSG:return a[0];case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_AUDIO_CALL:c=b[0];return c!=null?h._("__JHASH__3CQShXTU-3b__JHASH__",[h._param("user",c)]).toString():h._("__JHASH__ZdLYEgeUYUi__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_AUDIO_CALL:c=b[0];return c!=null?h._("__JHASH__hSqnAb21UU0__JHASH__",[h._param("user",c)]).toString():h._("__JHASH__FhbzN0qv73L__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_VIDEO_CALL:c=b[0];return c!=null?h._("__JHASH__YM-2KpKGx7o__JHASH__",[h._param("user",c)]).toString():h._("__JHASH__rUeoGw7ywMT__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_VIDEO_CALL:c=b[0];return c!=null?h._("__JHASH__PRszNN6obpG__JHASH__",[h._param("user",c)]).toString():h._("__JHASH__IdxQnq18Kxe__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_AUDIO_CALLED:c=b[0];return c!=null?h._("__JHASH__qpT_2Hq8aLK__JHASH__",[h._param("user",c)]).toString():h._("__JHASH__1D3Mug6ESYE__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_AUDIO_CALLED:c=b[0];return c!=null?h._("__JHASH__Q2D56NwN4Z2__JHASH__",[h._param("user",c)]).toString():h._("__JHASH__-LOVer9reHI__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_VIDEO_CALLED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_VIDEO_CALLED:return h._("__JHASH__N6tiOur0IeU__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_AUDIO_CALL:return h._("__JHASH__281zrADSR3K__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_AUDIO_CALL:c=b[0];return c!=null?h._("__JHASH__BRFQbCVtB3g__JHASH__",[h._param("user",c)]).toString():h._("__JHASH__Y_6qv9Uzxa8__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_VIDEO_CALL:return h._("__JHASH__-bjuy5QVW7S__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_VIDEO_CALL:c=b[0];return c!=null?h._("__JHASH__G7PmoxqH97J__JHASH__",[h._param("user",c)]).toString():h._("__JHASH__6N0ah9mUAzA__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE:return h._("__JHASH__EEsmX-_LHlK__JHASH__",[h._param("emoji",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE:return h._("__JHASH__6MdK4yng1UK__JHASH__",[h._param("participant_name",b[0]),h._param("emoji",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:return h._("__JHASH__GyMG8O-C9S5__JHASH__",[h._param("participant_name",b[0]),h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME:return a[1]!=null?h._("__JHASH__WKommDcgo9P__JHASH__",[h._param("theme_name",a[0]),h._param("theme_emoji",a[1])]).toString():h._("__JHASH__t4yd3Wxrq8W__JHASH__",[h._param("theme_name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_PHOTO:return h._("__JHASH__yuNBxRHgSDK__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:return h._("__JHASH__yI8AwJDDXA8__JHASH__",[h._param("participant_name_1",b[0]),h._param("participant_name_2",b[1]),h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME:return h._("__JHASH__Nu4trdH0AZV__JHASH__",[h._param("participant_name_1",b[0]),h._param("participant_name_2",b[1])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_THEME:return a[1]!=null?h._("__JHASH__pUsACsMNiGM__JHASH__",[h._param("participant_name",b[0]),h._param("theme_name",a[0]),h._param("theme_emoji",a[1])]).toString():h._("__JHASH__5cPy2yotEtg__JHASH__",[h._param("participant_name",b[0]),h._param("theme_name",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO:return h._("__JHASH__Dxwz5K9j7Bk__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:return h._("__JHASH__6qQ7QWA5Qmg__JHASH__",[h._param("participant_name",b[0]),h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME:return h._("__JHASH__oAeegILBLai__JHASH__",[h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_OWN_NICKNAME:return h._("__JHASH__NEVYqiJ_yny__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:return h._("__JHASH__QyW1FG-2acm__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME:return h._("__JHASH__-bMyTbFv0nI__JHASH__",[h._param("participant_name",b[0]),h._param("nickname",a[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:return h._("__JHASH__Yhh1rYSenJQ__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:return h._("__JHASH__cwzLDs_ko4T__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ADMIN_ONLY:return h._("__JHASH__x0YG4R4fIWJ__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ALL_MEMBERS:return h._("__JHASH__OS47S8NROIK__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ADMIN_ONLY:return h._("__JHASH__qoR_RAXP6cF__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ALL_MEMBERS:return h._("__JHASH__QFNAQIQatHV__JHASH__",[h._param("participant_name",b[0])]).toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ADMIN_ONLY:return h._("__JHASH__BGd7wYLVNyr__JHASH__").toString();case d("MAWLocalizationType").LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ALL_MEMBERS:return h._("__JHASH__ogqmOECI7p3__JHASH__").toString();default:return""}}g.buildLocalizedString=a}),226);
__d("MAWThreadCustomizationUtils",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME}function b(a){return a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME}g.skipNicknameCheck=a;g.nicknameOnlyForFirstParticipantChecking=b}),98);
__d("toThreadKeyMaybe",["I64","ODS","ReQL","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=new Set();function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table.index("chat_id")).getKeyRange((h||(h=d("I64"))).of_int32(b))));if(a!=null){j["delete"](b);return a.serverThreadKey}j.has(b)||(d("WALogger").LOG(["[Occamadillo] Thread id: "+b.toString()+" is not yet in miActMapping table."]),(i||(i=d("ODS"))).bumpEntityKey(5765,"thread_not_in_miActMapping","[Occamadillo] Thread id: "+b.toString()+" is not yet in miActMapping table."),j.add(b));return});return k.apply(this,arguments)}g.toThreadKeyMaybe_DEPRECATED=a}),98);
__d("MAWBridgeBuildAdminMsg",["I64","MAWAdminMsg","MAWAdminMsgNormalized","MAWLocalizationType","MAWSubscribeToContactNames","MAWThreadCustomizationUtils","MAWUpdateMsg","asyncToGeneratorRuntime","toThreadKeyMaybe"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c,d,e,f,g,h,j){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,i,j,k){k===void 0&&(k=0);i=d("MAWAdminMsgNormalized").deconstructContactIdsFromAdminContent(j,i);var l=i.contactIds,m=i.contents;i=(yield d("toThreadKeyMaybe").toThreadKeyMaybe_DEPRECATED(a.tables,c));var n=d("MAWThreadCustomizationUtils").nicknameOnlyForFirstParticipantChecking(j),o=d("MAWThreadCustomizationUtils").skipNicknameCheck(j);if(k===1){k=j===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP?d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME;k=(yield d("MAWSubscribeToContactNames").getContactNamesFromContactIDs({contactIDs:[].concat(l),db:a,nameMode:k,nicknameOnlyForFirstParticipant:n,onResolve:function(b){b=d("MAWAdminMsg").buildLocalizedString(m,b,j);return d("MAWUpdateMsg").mutateThreadText(a,c,e,f,g,{text:b})},skipNickname:o,subscriptionKey:(h||(h=d("I64"))).to_string(f),threadKey:i,txn:b}));return d("MAWAdminMsg").buildLocalizedString(m,k,j)}return d("MAWAdminMsg").buildLocalizedString(m,l,j)});return i.apply(this,arguments)}g.buildAdminMsgText=a}),98);
__d("mapPull",[],(function(a,b,c,d,e,f){function a(a,b,c){var d=new Map();for(var a=a,e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;d.set(c(g),b(g))}return d}f["default"]=a}),66);
__d("MAWBridgeBuildMsgMentions",["MAWLocalizationType","MAWSubscribeToContactNames","MAWThreadCustomizationUtils","WAJids","asyncToGeneratorRuntime","emptyFunction","fillArray","mapPull","toThreadKeyMaybe"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a.length>0?a.join(","):void 0}function i(a,b){return a.index-b.index}function j(a,b){return a==null||a===""?a:Array.from(b).reduce(function(a,b){var c=b[0];b=b[1];return a.replaceAll(c,b)},a)}function k(a,b){return a==null||a===""?[]:Array.from(b.keys()).flatMap(function(b){return Array.from(a.matchAll(b))}).sort(i)}function l(a,b,e,f){e=c("mapPull")(e,function(a){var c=a[0];a[1];return d("MAWSubscribeToContactNames").getContactNameFromLookup(b,c)},function(a){a[0];a=a[1];return a});var g=k(a,e),i=[],l=[],m=[],n=0;for(var o of g){var p=d("WAJids").unsafeCoerceToUserJid(o[0]);i.push(d("WAJids").userIdFromJid(p));var q=d("MAWSubscribeToContactNames").getContactNameFromLookup(e,p);l.push(q.length+1);m.push(Math.max(o.index-1+n,0));n+=q.length-p.length}q=c("fillArray")(g.length,"p");return{mentionIds:h(i),mentionLengths:h(l),mentionOffsets:h(m),mentionTypes:h(q),replyMessageText:j(f,e),text:j(a,e)}}function m(a,b,c,e){a=l(a,c,e);e=a.text;a=b.map(function(a){return d("MAWSubscribeToContactNames").getContactNameFromLookup(c,a)});return[e,a]}function a(a,b,c,d,e,f,g){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h,i){var j=c("mapPull")(g,c("emptyFunction").thatReturnsArgument,d("WAJids").userIdFromJid);g=(yield d("MAWSubscribeToContactNames").genContacts({contactIDs:Array.from(j.keys()),db:a,nameMode:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME,onResolve:function(a){a=l(f,a,j,i);return h(a)},subscriptionKey:e,txn:b}));return l(f,g,j,i)});return n.apply(this,arguments)}function e(a,b,c,d,e,f,g,h){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h,i,j){var k=c("mapPull")((g=g)!=null?g:[],c("emptyFunction").thatReturnsArgument,d("WAJids").userIdFromJid);if(k.size===0||f==null||f===""){var l;(i===d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MENTIONED_STORY_IG||i===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP)&&(l=d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME);g=d("MAWThreadCustomizationUtils").nicknameOnlyForFirstParticipantChecking(i);i=d("MAWThreadCustomizationUtils").skipNicknameCheck(i);var n=(yield d("toThreadKeyMaybe").toThreadKeyMaybe_DEPRECATED(a.tables,typeof e==="string"?parseInt(e,10):e));g=(yield d("MAWSubscribeToContactNames").getContactNamesFromContactIDs({contactIDs:h,db:a,nameMode:l,nicknameOnlyForFirstParticipant:g,onResolve:function(a){return j([f,a])},skipNickname:i,subscriptionKey:e,threadKey:n,txn:b}));return[f,g]}i=(yield d("MAWSubscribeToContactNames").genContacts({contactIDs:[].concat(Array.from(k.keys()),h),db:a,nameMode:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME,onResolve:function(a){a=m(f,h,a,k);return j(a)},subscriptionKey:e,txn:b}));return m(f,h,i,k)});return o.apply(this,arguments)}g.buildMsgTextWithMentions=a;g.buildThreadSnippetWithMentions=e}),98);
__d("MAWMsgReply",["I64","LSIntEnum","LSMessageReplySourceTypeV2","LSReplyMessageAttachmentType","cr:2472"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a){return a.replySourceId!=null}function a(a){a=a.replyToUserId;return a==null?void 0:(h||(h=d("I64"))).of_string(a)}function e(a){var b=a.isForwarded,e=a.isStoryReply,f=a.isStoryShare;a=j(a);if(b)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").FORWARD);if(f!=null&&f)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").FB_STORY_SHARE);if(a)if(e!=null&&e)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").STORY);else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE)}function f(a){var b=j(a),e=a.isStoryReply;a=a.isStoryShare;if(a!=null&&a)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").FB_STORY_SHARE);if(b)if(e!=null&&e)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").STORY);else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE)}function k(a){if(a.replySourceId!=null)return a.replySourceId}function l(a){if(a.replySourceId!=null)return a.replyMessageText}function m(a){if(a.replySourceId!=null)return a.replyMentionedJids}function n(a){return a.replySourceId==null?!1:a.replyMediaUrlMimeType!=null}function o(a){return a.replyStatusType==="XMA"&&a.replyMessageText!=null}function p(a){if(n(a)&&!o(a))return a.replyMediaUrlMimeType}function q(a){if(n(a))return a.replyMediaPreviewHeight!=null?(h||(h=d("I64"))).of_int32(a.replyMediaPreviewHeight):void 0}function r(a){if(n(a))return a.replyMediaPreviewWidth!=null?(h||(h=d("I64"))).of_int32(a.replyMediaPreviewWidth):void 0}function s(a){var e=a.replyMessageText;e=e!=null?b("cr:2472")==null?e:b("cr:2472").unvault(e):"";e=e==="\ud83d\udc4d"&&a.replyStatusType==="Sticker";var f=n(a),g=a.replyStatusType;if(f){if(g==null)return;switch(g){case"Gif":if(e)return;else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").GIF);case"Ptt":if(e)return;else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").OTHER);case"Sticker":if(!e)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").STICKER);break;case"Video":if(e)return;else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").VIDEO);case"Image":case"XMA":if(e)return;if(a.isIGXMAPostShare===!0||a.isIGXMAStoryShare===!0||a.isStoryHighlightShare===!0||a.isPostPrivateReply===!0)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").FEED_POST);if(o(a))return;return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").PHOTO);case"DocumentFile":if(e)return;return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").OTHER);default:}}if(g!=null&&g==="Sticker"&&e)return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").STICKER)}function t(a){var b=a.replyMediaId,c=a.replyXMAId;if(n(a)&&b!=null)return c!=null?void 0:(h||(h=d("I64"))).of_int32(b);if(b!=null||c==null)return;if(c!=null&&o(a))return;return(h||(h=d("I64"))).of_int32(c)}function u(a){var b=a.isStoryReply,c=a.replyMessageText,e=a.replyStatusType,f=s(a);a=t(a);if(e!=null&&e==="XMA"&&f==null){if(a!=null)return;if(c==null)return(h||(h=d("I64"))).zero}if(a!=null||!(b!=null&&b))return;return(h||(h=d("I64"))).zero}g.getReplyUserId=a;g.getReplySourceTypeV2=e;g.getReplySourceType=f;g.getReplySourceId=k;g.getReplyMessageText=l;g.getReplyMentionedJids=m;g.getReplyMediaMimeType=p;g.getReplyMediaHeight=q;g.getReplyMediaWidth=r;g.getReplyAttachmentType=s;g.getReplyAttachmentId=t;g.getReplyMediaExpirationTimestampMs=u}),98);
__d("MAWBridgeBuildMsg",["I64","MAWBridgeBuildAdminMsg","MAWBridgeBuildMsgMentions","MAWJids","MAWMiActOnActThreadReady","MAWMsgReply","MAWUpdateMsg","MAWVault","Promise","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.filter(Boolean).reduce(function(a,b){return[].concat(a,b)},[])}function k(a){return a!=null?d("MAWVault").unvault(a):void 0}function l(a){return a!=null?d("MAWVault").vault(a):void 0}function m(a){return babelHelpers["extends"]({},a,{replyMessageText:l(a.replyMessageText),text:l(a.text)})}function a(a){a=a.ephemeralDurationInSec;return a!=null?(i||(i=d("I64"))).of_int32(a):void 0}function c(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=d("MAWMsgReply").getReplyMessageText(c),g=c.adminContent,h=c.adminType,i=c.adminVersion,l=c.chatId,n=c.chatJid,o=c.content,p=c.isAdminMessage,q=c.msgId,r=o;p&&g!=null&&h!=null&&(r=(yield d("MAWBridgeBuildAdminMsg").buildAdminMsgText(a,b,l,n,e,q,g,h,i)));p=j(c.mentionedJids,d("MAWMsgReply").getReplyMentionedJids(c));return p.length>0?d("MAWBridgeBuildMsgMentions").buildMsgTextWithMentions(a,b,q,k(o),p,function(b){return d("MAWUpdateMsg").mutateThreadText(a,l,n,e,q,m(b))},k(f)).then(m):{replyMessageText:f,text:r}});return n.apply(this,arguments)}function e(a,c,e,f,g,i,l,n){var o=i==null?void 0:i.text;i=j(n,i==null?void 0:(n=i.mentionIds)==null?void 0:n.split(",").map(d("MAWJids").toUserJid));return i.length>0?d("MAWBridgeBuildMsgMentions").buildMsgTextWithMentions(a,c,f,k(e),i,function(b){return d("MAWMiActOnActThreadReady").onActThreadReady(a.tables,g,"MAWBridgeBuildMsg",function(c,e,g){return d("MAWUpdateMsg").mutateThreadText(a,e,g,l,f,m(b))})},k(o)).then(m):(h||(h=b("Promise"))).resolve({replyMessageText:o,text:e})}g.getEphemeralDurationInSec=a;g.buildMessage=c;g.buildOptimisticMessage=e}),98);
__d("LSTransportKey",[],(function(a,b,c,d,e,f){a=Object.freeze({ADVANCED_CRYPTO:"AdvancedCrypto",CARRIER_MESSAGING:"CarrierMessaging",FB_BROKER:"FBBroker",FB_LEGACY_BROKER:"FBLegacyBroker",TAM:"TAM",WHATS_APP:"WhatsApp",INSTAMADILLO:"Instamadillo",ENCRYPTED_BACKUPS:"EncryptedBackups",CLIENT_CONTACTS_PLACEHOLDER:""});f["default"]=a}),66);
__d("MAWBridgeMsgUtils",["LSTransportKey"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=Object.keys(c("LSTransportKey")).find(function(b){return c("LSTransportKey")[b]===a});return b?c("LSTransportKey")[b]:"WhatsApp"}g.convertStringToLSTransportKeyType=a}),98);
__d("MAWUpdateMsg",["I64","LSAuthorityLevel","LSIntEnum","LSMessageUnsendabilityStatus","MAWAckLevel","MAWBridgeBuildMsg","MAWBridgeMsg","MAWBridgeMsgUtils","MAWDbChatId","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWMsg","MAWMsgReply","MAWMsgReplyStatus","MAWTimeUtils","ReQL","asyncToGeneratorRuntime","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c,e,f,g,h){return a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,d("MAWDbChatId").unsafeCoerceToChatId(c),e,"MAWUpdateMsg",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a.messages;b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(b,f,g)));b!=null&&(yield a.put(babelHelpers["extends"]({},b,h)))});return function(b,c){return a.apply(this,arguments)}}())});return function(b){return a.apply(this,arguments)}}(),"readwrite")}function e(a,b,c,d,e,f){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,j){var k,l;k=d("MAWTimeUtils").toTimestamp(e.type_===d("MAWMsg").unsent?(k=e.originalTs)!=null?k:e.ts:e.ts);var m=e.type_===d("MAWMsg").unsent;a=(yield d("MAWBridgeBuildMsg").buildMessage(a,b,e,k));l=(l=d("MAWBridgeMsgUtils").convertStringToLSTransportKeyType(e.transportKey))!=null?l:"WhatsApp";var n=c("qex")._("972")===!0?f.primarySortKey:(h||(h=d("I64"))).of_float(e.sortOrderMs);yield b.messages.put(babelHelpers["extends"]({},f,a,{adminMsgCtaId:g==null?void 0:g.ctaId,adminMsgCtaTitle:g==null?void 0:g.title,adminMsgCtaType:g==null?void 0:g.ctaType,authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),cannotUnsendReason:m||!e.isAuthorMe?(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageUnsendabilityStatus").DENY_FOR_NON_SENDER):void 0,displayedContentTypes:d("MAWMsg").getDisplayedContentTypes(e.type_,e.isForwarded,e.isExpiredXmaMsg),editCount:e.editCount!=null?(h||(h=d("I64"))).of_int32(e.editCount):(h||(h=d("I64"))).zero,ephemeralDurationInSec:d("MAWBridgeBuildMsg").getEphemeralDurationInSec(e),hotEmojiSize:d("MAWBridgeMsg").getSpecialTextSize(e),isUnsent:e.type_===d("MAWMsg").unsent,messageId:e.msgId,primarySortKey:n,replyAttachmentId:d("MAWMsgReply").getReplyAttachmentId(e),replyAttachmentType:d("MAWMsgReply").getReplyAttachmentType(e),replyMediaExpirationTimestampMs:d("MAWMsgReply").getReplyMediaExpirationTimestampMs(e),replyMediaPreviewHeight:d("MAWMsgReply").getReplyMediaHeight(e),replyMediaPreviewWidth:d("MAWMsgReply").getReplyMediaWidth(e),replyMediaUrlMimeType:d("MAWMsgReply").getReplyMediaMimeType(e),replySnippet:j,replySourceId:d("MAWMsgReply").getReplySourceId(e),replySourceType:d("MAWMsgReply").getReplySourceType(e),replySourceTypeV2:d("MAWMsgReply").getReplySourceTypeV2(e),replyStatus:d("MAWMsgReplyStatus").getLSReplyMessageStatus(e),replyToUserId:d("MAWMsgReply").getReplyUserId(e),sendStatus:d("MAWAckLevel").levelToMessagingSendStatus(e.ack),sendStatusV2:d("MAWAckLevel").levelToMessagingSendStatusV2(e.ack),timestampMs:k,transportKey:l}))});return j.apply(this,arguments)}g.mutateThreadText=a;g.call=e}),98);
__d("MAWBridgeMsgUpdatedHandler",["I64","LSIntEnum","MAWAckLevel","MAWAdminMsgCTA","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWMsgReplySnippet","MAWTimeUtils","MAWUpdateMsg","MWChatInteraction","MWLSLogSend","Promise","QPLUserFlow","ReQL","asyncToGeneratorRuntime","justknobx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b){var e=d("MWChatInteraction").get(d("MWChatInteraction").s2sKey(a));a=d("MWLSLogSend").getS2sKeyFromOfflineMessageId(a);if(e!=null){var f=d("MAWAckLevel").levelToMessagingSendStatusV2(b.ack);(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(2))?d("MWChatInteraction").addMarkerPoint(e,"received_successful_server_ack"):(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(4))&&d("MWChatInteraction").addMarkerPoint(e,"received_failure_server_ack")}if(a!=null){f=d("MAWAckLevel").levelToMessagingSendStatusV2(b.ack);(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(2))?c("QPLUserFlow").endSuccess(c("qpl")._(25313175,"1551"),{instanceKey:a}):(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(4))&&c("QPLUserFlow").endFailure(c("qpl")._(25313175,"1551"),"error_from_server",{instanceKey:a})}}function a(a,e,f){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(e,f.chatId,f.chatJid,"MAWBridgeMsgUpdatedHandler",function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e,g){var j=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.messages).getKeyRange(g).filter(function(a){return a.messageId===f.msgId})));if(j==null)return;var l=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.attachments).getKeyRange(g,f.msgId))),m=[j.offlineThreadingId,l==null?void 0:l.offlineAttachmentId];m.forEach(function(a){a!=null&&k(a,f)});m=(yield d("MAWAdminMsgCTA").getAdminMsgCtaStep(e,g,f));g=(yield d("MAWMsgReplySnippet").getReplySnippet(a,e,f,g));yield d("MAWUpdateMsg").call(a,e,f,j,m,g);if(c("justknobx")._("2257")&&l!=null&&j!=null&&!(i||(i=d("I64"))).equal(j.timestampMs,d("MAWTimeUtils").toTimestamp(f.ts))){m=babelHelpers["extends"]({},l,{timestampMs:d("MAWTimeUtils").toTimestamp(f.ts)});yield e.attachments.put(m)}return(h||(h=b("Promise"))).resolve()});return function(a,b){return e.apply(this,arguments)}}())}g.call=a}),98);
__d("LSClearMessagePlaceholderRangeStoredProcedure",["LSClearMessagePlaceholderRange","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.messageId;d[2]=b.maxTimestampMs;return c("LSClearMessagePlaceholderRange").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWBridgeMsgsLoadedHandler",["I64","LSClearMessagePlaceholderRangeStoredProcedure","LSFactory","LSInsertNewMessageRangeStoredProcedure","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.chatJid,"MAWBridgeMsgsLoadedHandler",function(a,e){return c("LSClearMessagePlaceholderRangeStoredProcedure")(c("LSFactory")(a),{maxTimestampMs:d("MAWTimeUtils").MAX_TIMESTAMP_MS,messageId:"",threadKey:e}).then(function(){if(c("gkx")("23927")){var f,g,i,j,k,l,m,n;f=(f=(f=b.rangeExtensionType)==null?void 0:f.hasMoreBefore)!=null?f:!1;g=(g=(g=b.rangeExtensionType)==null?void 0:g.hasMoreAfter)!=null?g:!1;i=f&&((i=b.rangeExtensionType)==null?void 0:i.minMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.minMsgTs):d("MAWTimeUtils").MIN_TIMESTAMP_MS;j=g&&((j=b.rangeExtensionType)==null?void 0:j.maxMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS;k=(k=(k=b.rangeExtensionType)==null?void 0:k.minMsgId)!=null?k:"";l=(l=(l=b.rangeExtensionType)==null?void 0:l.maxMsgId)!=null?l:"";m=((m=b.rangeExtensionType)==null?void 0:m.rangeKind)==="before"?i:d("MAWTimeUtils").MIN_TIMESTAMP_MS;n=((n=b.rangeExtensionType)==null?void 0:n.rangeKind)==="after"?j:d("MAWTimeUtils").MAX_TIMESTAMP_MS;return c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:g,hasMoreBefore:f,lowerOverlap:m,newMaxMid:l,newMaxTs:j,newMinMid:k,newMinTs:i,threadKey:e,upperOverlap:n})}else{f=((g=b.rangeExtensionType)==null?void 0:g.minMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.minMsgTs):d("MAWTimeUtils").MIN_TIMESTAMP_MS;l=((m=b.rangeExtensionType)==null?void 0:m.maxMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS;i=(k=(j=b.rangeExtensionType)==null?void 0:j.minMsgId)!=null?k:"";m=(g=(n=b.rangeExtensionType)==null?void 0:n.maxMsgId)!=null?g:"";k=((j=b.rangeExtensionType)==null?void 0:j.rangeKind)==="extensionBefore"?f:d("MAWTimeUtils").MIN_TIMESTAMP_MS;g=((n=b.rangeExtensionType)==null?void 0:n.rangeKind)==="extensionAfter"?l:d("MAWTimeUtils").MAX_TIMESTAMP_MS;j=(n=(j=b.rangeExtensionType)==null?void 0:j.hasMoreBefore)!=null?n:!1;n=(n=(n=b.rangeExtensionType)==null?void 0:n.hasMoreAfter)!=null?n:!1;return c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:n,hasMoreBefore:j,lowerOverlap:k,newMaxMid:m,newMaxTs:l,newMinMid:i,newMinTs:f,threadKey:e,upperOverlap:g})}})})}g.call=a}),98);
__d("MAWEphemeralMessageExpirationStorage",["LSDatabaseSingleton","MAWBridgeDeleteMessagesHandler","Promise","asyncToGeneratorRuntime","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=new Map();function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){yield (i||(i=b("Promise"))).all(c.map(function(b){var c=b.ts,e=b.chatId,f=b.msgId;f={msgId:f,threadId:e,ts:c};e=b.chatId;c=b.threadJid;b=[f];f={messages:b,threadId:e,threadJid:c};return d("MAWBridgeDeleteMessagesHandler").call(a,f)})),j["delete"](e)});return l.apply(this,arguments)}function m(a,e,f){return c("setTimeout")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var f=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton);c("promiseDone")(f.runInTransaction(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield k(b,a,e)});return function(a){return c.apply(this,arguments)}}(),"readwrite"))}),f)}function a(a,b,d,e){a=j.get(d);var f;if(a==null)f=[b];else{c("clearTimeout")(a.timeoutId);var g=a.msgs.map(function(a){return a.msgId}).indexOf(b.msgId)===-1;g&&a.msgs.push(b);f=a.msgs}g=m(f,d,e);j.set(d,{expirationTs:d,msgs:f,timeoutId:g})}function e(a){var b=a.msgId;a=j.get(a.countdownTs);if(a==null)return;b=a.msgs.map(function(a){return a.msgId}).indexOf(b);if(b>-1){a.msgs.splice(b,1);return}}g.setMessageForExpiration=a;g.clearMessageFromExpiration=e}),98);
__d("MAWBridgeMsgsStartCountdownHandler",["I64","MAWEphemeralMessageExpirationStorage","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c){return c.msgs.reduce(function(c,e){return c.then(function(){d("MAWEphemeralMessageExpirationStorage").setMessageForExpiration(a,e,e.countdownTs,e.millisecondsUntilCountdownTs);(i||(i=d("I64"))).of_int32(e.millisecondsUntilCountdownTs);return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,e.chatId,e.threadJid,"MAWBridgeMsgsStartCountdownHandler",function(a,c){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages).getKeyRange(c,d("MAWTimeUtils").toTimestamp(e.ts),e.msgId)).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){if(c==null)return(h||(h=b("Promise"))).resolve();c=babelHelpers["extends"]({},c,{ephemeralExpirationTs:(i||(i=d("I64"))).of_float(e.countdownTs)});yield a.messages.put(c)});return function(a){return c.apply(this,arguments)}}())})})},(h||(h=b("Promise"))).resolve())}g.call=a}),98);
__d("MAWMedia",["LSIntEnum","MAWDbMedia","MessagingAttachmentType"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){if(a===d("MAWDbMedia").IMAGE)return b!=null?(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE):(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE);else if(a===d("MAWDbMedia").VIDEO)return b!=null?(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO):(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO);else if(a===d("MAWDbMedia").PTT)return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO);else if(a===d("MAWDbMedia").GIF)return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE);else if(a===d("MAWDbMedia").STICKER)return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER);else if(a===d("MAWDbMedia").DOCUMENT_FILE)return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE);return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").NONE)}g.mediaTypeToMessageAttachmentType=a}),98);
__d("MAWBridgeNewMediaHandler",["I64","LSAuthorityLevel","LSIntEnum","MAWMedia","MAWMiActOnMiThreadReadyForChatIdOrJid","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b,e,f,g,h){return{attachmentFbid:f,attachmentIndex:(f=a==null?void 0:a.attachmentIndex)!=null?f:(i||(i=d("I64"))).zero,attachmentType:(f=a==null?void 0:a.attachmentType)!=null?f:d("MAWMedia").mediaTypeToMessageAttachmentType(b.mediaType,b.ephemeralMediaViewMode),authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),ephemeralMediaState:b.ephemeralMediaState!=null?(i||(i=d("I64"))).of_int32(b.ephemeralMediaState):a==null?void 0:a.ephemeralMediaState,ephemeralMediaViewMode:b.ephemeralMediaViewMode!=null?(i||(i=d("I64"))).of_int32(b.ephemeralMediaViewMode):a==null?void 0:a.ephemeralMediaViewMode,filename:(f=(f=b.filenames!=null?b.filenames[e]:null)!=null?f:b.defaultFilename)!=null?f:a==null?void 0:a.filename,filesize:b.filesize==null?a==null?void 0:a.filesize:(i||(i=d("I64"))).of_int32(b.filesize),hasMedia:b.hasMedia,hasXma:!1,isSharable:!1,messageId:e,offlineAttachmentId:g,playableDurationMs:b.duration==null?a==null?void 0:a.playableDurationMs:(i||(i=d("I64"))).of_int32(b.duration),previewHeight:b.previewHeight==null?a==null?void 0:a.previewHeight:(i||(i=d("I64"))).of_int32(b.previewHeight),previewHeightLarge:b.previewHeightLarge==null?a==null?void 0:a.previewHeightLarge:(i||(i=d("I64"))).of_int32(b.previewHeightLarge),previewWidth:b.previewWidth==null?a==null?void 0:a.previewWidth:(i||(i=d("I64"))).of_int32(b.previewWidth),previewWidthLarge:b.previewWidthLarge==null?a==null?void 0:a.previewWidthLarge:(i||(i=d("I64"))).of_int32(b.previewWidthLarge),threadKey:h,timestampMs:b.sortOrderMs!=null?(i||(i=d("I64"))).of_float(b.sortOrderMs):(i||(i=d("I64"))).of_float(b.ts*1e3),transportKey:(f=b.transportKey)!=null?f:"WhatsApp"}}function l(a,c){var e=c.mediaId,f=c.msgIds,g=c.offlineAttachmentId,i=c.threadId,j=c.threadJid;return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,i,j,"MAWBridgeNewMediaHandler",function(a,i){var j,l=e.toString(),m=(j=g)!=null?j:l;return(h||(h=b("Promise"))).all(f.map(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var e=a.attachments,f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e).getKeyRange(i,b)));b=k(f,c,b,l,m,i);if(f!=null){f.attachmentFbid!==b.attachmentFbid&&(yield e["delete"](f.threadKey,f.messageId,f.attachmentFbid));return e.put(babelHelpers["extends"]({},f,b))}return e.add(b)});return function(a){return e.apply(this,arguments)}}())).then(function(){})})}function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield l(a,b)});return m.apply(this,arguments)}g.call=a}),98);
__d("LSThreadMediaGalleryGroup",[],(function(a,b,c,d,e,f){a=Object.freeze({PHOTOS_AND_VIDEOS:0,FILES_ONLY:1,LINKS:2});f["default"]=a}),66);
__d("LSUpsertAttachmentRange",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.sequence([function(c){return b.forEach(b.db.table(17).fetch([[[a[0],a[1]]]]),function(a){return a["delete"]()})},function(c){return b.db.table(17).add({threadKey:a[0],mediaGroup:a[1],minTimestampMs:a[2],maxTimestampMs:b.i64.cast([2328,1316134911]),hasMoreBefore:a[3],hasMoreAfter:!1,isLoadingBefore:!1,isLoadingAfter:!1})}])},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("LSUpsertAttachmentRangeStoredProcedure",["LSUpsertAttachmentRange","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.mediaGroup;d[2]=b.newMinTs;d[3]=b.hasMoreBefore;return c("LSUpsertAttachmentRange").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWBridgeNewMediaRangeHandler",["I64","LSFactory","LSIntEnum","LSThreadMediaGalleryGroup","LSUpsertAttachmentRangeStoredProcedure","MAWMiActOnMiThreadReadyForChatIdOrJid"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.threadJid,"MAWBridgeNewMediaRangeHandler",function(a,e){var f=(h||(h=d("I64"))).of_int32(b.earliestLoadedMediaTs),g=b.hasMoreBefore;return c("LSUpsertAttachmentRangeStoredProcedure")(c("LSFactory")(a),{hasMoreBefore:g,mediaGroup:(i||(i=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),newMinTs:f,threadKey:e})})}function a(a,b){return j(a,b).then(function(){})}g.call=a}),98);
__d("MAWBridgeNewMsgHandler",["FBLogger","I64","LSAuthorityLevel","LSIntEnum","LSMessageUnsendabilityStatus","LSQuickReplyType","MAWAckLevel","MAWAdminMsgCTA","MAWBridgeBuildMsg","MAWBridgeMsg","MAWBridgeMsgUtils","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWMsg","MAWMsgReply","MAWMsgReplySnippet","MAWMsgReplyStatus","MAWTimeUtils","MAWUpdateMsg","Promise","ReQL","asyncToGeneratorRuntime","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b,c,d,e,f){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h){var k;k=d("MAWTimeUtils").toTimestamp(f.type_===d("MAWMsg").unsent?(k=f.originalTs)!=null?k:f.ts:f.ts);a=(yield d("MAWBridgeBuildMsg").buildMessage(a,b,f,k));var l=d("MAWBridgeMsgUtils").convertStringToLSTransportKeyType(f.transportKey),m;f.externalId!=null?m=f.externalId:(c("FBLogger")("messenger_e2ee_web").mustfix("MAWBridgeNewMsgHandler create new msg without externalId"),m=f.msgId);yield b.messages.add(babelHelpers["extends"]({},a,{adminMsgCtaId:g==null?void 0:g.ctaId,adminMsgCtaTitle:g==null?void 0:g.title,adminMsgCtaType:g==null?void 0:g.ctaType,authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),cannotUnsendReason:f.type_===d("MAWMsg").unsent||!f.isAuthorMe?(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageUnsendabilityStatus").DENY_FOR_NON_SENDER):void 0,displayedContentTypes:d("MAWMsg").getDisplayedContentTypes(f.type_,f.isForwarded,f.isExpiredXmaMsg),editCount:(j||(j=d("I64"))).of_int32((b=f.editCount)!=null?b:0),ephemeralDurationInSec:d("MAWBridgeBuildMsg").getEphemeralDurationInSec(f),ephemeralExpirationTs:void 0,forwardScore:j.of_float(f.forwardingScore),hasQuickReplies:!1,hotEmojiSize:d("MAWBridgeMsg").getSpecialTextSize(f),isAdminMessage:f.isAdminMessage,isCollapsed:!1,isForwarded:f.isForwarded,isUnsent:f.type_===d("MAWMsg").unsent,localDataId:void 0,messageId:f.msgId,msUntilExpirationTs:void 0,offlineThreadingId:m,primarySortKey:j.of_float(f.sortOrderMs),quickReplyType:i.ofNumber(c("LSQuickReplyType").NONE),replyAttachmentExtra:void 0,replyAttachmentId:d("MAWMsgReply").getReplyAttachmentId(f),replyAttachmentType:d("MAWMsgReply").getReplyAttachmentType(f),replyCtaId:void 0,replyCtaTitle:void 0,replyMediaExpirationTimestampMs:d("MAWMsgReply").getReplyMediaExpirationTimestampMs(f),replyMediaPreviewHeight:d("MAWMsgReply").getReplyMediaHeight(f),replyMediaPreviewWidth:d("MAWMsgReply").getReplyMediaWidth(f),replyMediaUrl:void 0,replyMediaUrlFallback:void 0,replyMediaUrlMimeType:d("MAWMsgReply").getReplyMediaMimeType(f),replySnippet:h,replySourceId:d("MAWMsgReply").getReplySourceId(f),replySourceTimestampMs:void 0,replySourceType:d("MAWMsgReply").getReplySourceType(f),replySourceTypeV2:d("MAWMsgReply").getReplySourceTypeV2(f),replyStatus:d("MAWMsgReplyStatus").getLSReplyMessageStatus(f),replyToUserId:d("MAWMsgReply").getReplyUserId(f),replyType:void 0,secondarySortKey:void 0,senderId:j.of_string(f.sender),sendStatus:d("MAWAckLevel").levelToMessagingSendStatus(f.ack),sendStatusV2:d("MAWAckLevel").levelToMessagingSendStatusV2(f.ack),stickerId:void 0,subscriptErrorMessage:void 0,takedownState:void 0,textHasLinks:!1,threadKey:e,timestampMs:k,transportKey:l,unsentTimestampMs:d("MAWTimeUtils").toTimestamp(f.ts),viewedPluginContext:void 0,viewedPluginKey:void 0,viewFlags:i.ofNumber(0)}))});return l.apply(this,arguments)}function m(a,e,f){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(e,f.chatId,f.chatJid,"BridgeNewMsgHandler",function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e,g){var i=(yield d("MAWAdminMsgCTA").getAdminMsgCtaStep(e,g,f)),l=(yield d("MAWMsgReplySnippet").getReplySnippet(a,e,f,g)),m=f.offlineMsg,n=c("gkx")("23961");if(m==null&&!n)return k(a,e,g,f,i,l);var p;m!=null&&(p=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.messages).getKeyRange(g,(j||(j=d("I64"))).of_float(m.ts),m.msgId))));if(p==null){m=!1;if(n&&f.externalId!=null){n=f.externalId;p=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.messages.index("optimistic")).getKeyRange(n)));if(p!=null){(j||(j=d("I64"))).to_int32(p.authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC&&(m=!0,yield d("MAWUpdateMsg").call(a,e,f,p,i,l));n=(yield o(e,g,n));yield q(e,n,f.msgId,c("LSAuthorityLevel").AUTHORITATIVE);return(h||(h=b("Promise"))).resolve()}}if(!m)return k(a,e,g,f,i,l)}else{var r;(j||(j=d("I64"))).to_int32(p.authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC&&c("qex")._("972")===!0&&(r=(yield o(e,g,p.messageId)));yield d("MAWUpdateMsg").call(a,e,f,p,i,l);r!=null&&(yield q(e,r,f.msgId));return(h||(h=b("Promise"))).resolve()}return(h||(h=b("Promise"))).resolve()});return function(a,b){return e.apply(this,arguments)}}())}function a(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d){yield (h||(h=b("Promise"))).all(d.map(function(b){return m(a,c,b)}))});return n.apply(this,arguments)}function o(a,b,c){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){a=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.attachments).getKeyRange(b,e)));return a.filter(function(a){return(j||(j=d("I64"))).to_int32(a.authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC})});return p.apply(this,arguments)}function q(a,b,c,d){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){yield (h||(h=b("Promise"))).all(c.map(function(b){b=babelHelpers["extends"]({},b,{messageId:e});f!=null&&(b.authorityLevel=(i||(i=d("LSIntEnum"))).ofNumber(f));return a.attachments.put(b)}));return h.resolve()});return r.apply(this,arguments)}g.call=m;g.bulkCall=a}),98);
__d("MAWReceiverFetchQPLLogger",["QuickPerformanceLogger","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("qpl")._(973799425,"190"),j={PREVIEW_FETCH_START:"preview_fetch_start",PREVIEW_FETCH_TASK_COMPLETED:"preview_fetch_task_completed",PREVIEW_LOAD_COMPLETED:"preview_load_completed"};function a(a,b){a=Number(a);(h||(h=c("QuickPerformanceLogger"))).markerStart(i,a);h.markerAnnotate(i,{"int":{hummingbird:Number(b)}},{instanceKey:a});b||(h||(h=c("QuickPerformanceLogger"))).markerEnd(i,4,a)}function b(a){(h||(h=c("QuickPerformanceLogger"))).markerPoint(i,j.PREVIEW_FETCH_START,{instanceKey:Number(a)})}function d(a){a=Number(a);(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,{string:{preview_fetch_task_state:"succeeded"}},{instanceKey:a});h.markerEnd(i,2,a)}function e(a,b){a=Number(a);(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,{string:{error:b,preview_fetch_task_state:"failed"}},{instanceKey:a});h.markerEnd(i,3,a)}function f(a){a=Number(a);(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,{bool:{preview_load_has_results:!0}},{instanceKey:a});h.markerPoint(i,j.PREVIEW_LOAD_COMPLETED,{instanceKey:a})}g.logReceiveReceiverFetchXMA=a;g.logFetchStart=b;g.logFetchSuccess=d;g.logFetchFailure=e;g.logLoadCompleted=f}),98);
__d("MAWBridgeHandleReceiverFetchXMA",["FBLogger","I64","LSIntEnum","LSXmaContentType","MAWDbMsg","MAWReceiverFetchQPLLogger","MessagingAttachmentType","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=e.contentRef,k=e.msgId;e=e.xmaId;if(k==null)return;e=String(e);var l=(j||(j=d("I64"))).of_int32(d("MAWDbMsg").getInChatMsgIdFromMsgId(k)),m=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages.index("messageId")).getKeyRange(k)));if(m==null){c("FBLogger")("messenger_e2ee_web").mustfix("message does not exist to handle receiver fetch XMA");return}d("MAWReceiverFetchQPLLogger").logReceiveReceiverFetchXMA(e,!0);if(g==null){c("FBLogger")("messenger_e2ee_web").mustfix("contentRef is empty for a MSG_RECEIVER_FETCH XMA");return}var n;try{g=JSON.parse(g);g=g.fetch_params;g!=null&&(n=JSON.stringify(g))}catch(a){c("FBLogger")("messenger_e2ee_web").mustfix("Failed to parse msg.contentRef as XmsgMsgrXmaContentRefDataclass")}yield (h||(h=b("Promise"))).all([a.messages.put(babelHelpers["extends"]({},m,{xmaReceiverFetchParams:n})),a.attachments.add({attachmentFbid:e,attachmentIndex:j.zero,attachmentType:(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA),authorityLevel:j.zero,hasMedia:!1,hasXma:!0,isSharable:!0,messageId:k,threadKey:f,timestampMs:l,transportKey:"WhatsApp",xmaContentType:i.ofNumber(c("LSXmaContentType").MSG_RECEIVER_FETCH)})]);return});return k.apply(this,arguments)}g.call=a}),98);
__d("getTargetUrlFromContentRefXmaDataclass",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){try{a=JSON.parse(a);return a.target_url}catch(a){c("FBLogger")("messenger_e2ee_web").mustfix("Error parsing contentRef for target url");return""}}g["default"]=a}),98);
__d("MAWHandleXMAPreviewOptOut",["FBLogger","I64","LSIntEnum","MAWMsg","MAWMsgType","ReQL","WAArmadilloXMA.pb","asyncToGeneratorRuntime","getTargetUrlFromContentRefXmaDataclass","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){return c("isStringNullOrEmpty")(a)?b:a+" "+b}function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.msgId;if(e==null){c("FBLogger")("messenger_e2ee_web").mustfix("BridgeXMA msgId is null to handle the opt-out experience for XMAs");return}e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages.index("messageId")).getKeyRange(e)));if(e==null||(h||(h=d("I64"))).equal(e.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(1)))return;var f;if(b.targetType===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH&&b.contentRef!=null)f=c("getTargetUrlFromContentRefXmaDataclass")(b.contentRef);else{var g;f=(g=b==null?void 0:(g=b.defaultCTA)==null?void 0:g.actionUrl)!=null?g:b==null?void 0:(g=b.defaultCTA)==null?void 0:g.nativeUrl}if(f!=null){yield a.messages.put(babelHelpers["extends"]({},e,{displayedContentTypes:d("MAWMsg").getDisplayedContentTypes(d("MAWMsgType").MSG_TYPE.TEXT,(g=e.isForwarded)!=null?g:!1,!1),text:(g=j(e.text,f))!=null?g:""}))}else c("FBLogger")("messenger_e2ee_web").mustfix("Failed to get a target URL for XMA, where user opted out of previews. XMA target type=%s",b.targetType),yield a.messages.put(babelHelpers["extends"]({},e,{displayedContentTypes:(i||(i=d("LSIntEnum"))).ofNumber(262144)}))});return k.apply(this,arguments)}g.call=a}),98);
__d("getXMAPreviewsDisabledSettings",["MessengerWebPrivacySettings","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messaging_privacy_settings)));return a==null?c("MessengerWebPrivacySettings").e2ee_xma_previews_disabled:(a=a==null?void 0:a.e2eeXmaPreviewsDisabled)!=null?a:!1});return h.apply(this,arguments)}g.getXMAPreviewsDisabledSettings=a}),98);
__d("MAWBridgeNewXMAHandler",["I64","LSIntEnum","MAWBridgeHandleReceiverFetchXMA","MAWBridgeUIEventDataValidation","MAWDbMsg","MAWHandleXMAPreviewOptOut","MAWMiActOnMiThreadReadyForChatIdOrJid","MNLSXMALayoutType","MNXMAPreviewImageDecorationType","MessagingAttachmentType","Promise","ReQL","WAArmadilloXMA.pb","asyncToGeneratorRuntime","getXMAPreviewsDisabledSettings","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b){if(a==null)return;a=a[b-1];if(a==null)return;return a.buttonType===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE?"xma_open_native":void 0}function l(a,b){if(a==null)return;a=a[b-1];if(a!=null)return a.title}function m(a){return a===0||a!==3?(i||(i=d("LSIntEnum"))).ofNumber(c("MNLSXMALayoutType").SINGLE):(i||(i=d("LSIntEnum"))).ofNumber(c("MNLSXMALayoutType").PORTRAIT)}function n(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:return(i||(i=d("LSIntEnum"))).ofNumber(c("MNXMAPreviewImageDecorationType").COLLAGE);case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:return(i||(i=d("LSIntEnum"))).ofNumber(c("MNXMAPreviewImageDecorationType").REEL);case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:return(i||(i=d("LSIntEnum"))).ofNumber(c("MNXMAPreviewImageDecorationType").INSTAGRAM_ICON);default:return(i||(i=d("LSIntEnum"))).ofNumber(c("MNXMAPreviewImageDecorationType").DEFAULT)}}function o(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH:return!0;default:return!1}}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=String(e.xmaId),p=e.msgId;if(p==null)return;var q=(j||(j=d("I64"))).of_int32(d("MAWDbMsg").getInChatMsgIdFromMsgId(p)),r=e.targetType===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH,s=(yield d("getXMAPreviewsDisabledSettings").getXMAPreviewsDisabledSettings(a)),t=c("gkx")("23991");if(t&&s&&o(e.targetType))return d("MAWHandleXMAPreviewOptOut").call(a,e);s=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.attachment_ctas)));if(r&&t)return d("MAWBridgeHandleReceiverFetchXMA").call(a,e,f);r=s!=null?(j||(j=d("I64"))).add(s.ctaId,(j||(j=d("I64"))).one):(j||(j=d("I64"))).one;t=e.defaultCTA;if(t!=null){s=t.actionUrl;var u=t.nativeUrl,v="xma_web_url";switch(e.targetType){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:v="xma_rtc_audio";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:v="xma_rtc_video";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:v="xma_rtc_missed_audio";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:v="xma_rtc_missed_video";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:v="igd_web_post_share";break}var w=e.targetId!=null?d("MAWBridgeUIEventDataValidation").stringToI64Opt(e.targetId):void 0;yield a.attachment_ctas.add({actionContentBlob:void 0,actionUrl:s!=null?s:u,attachmentFbid:g,attachmentIndex:(j||(j=d("I64"))).zero,ctaId:r,enableExtensions:!1,extensionHeightType:void 0,messageId:p,nativeUrl:u!=null?u:s,platformToken:void 0,targetId:w,threadKey:f,title:(u=t.title)!=null?u:"",type_:v,urlWebviewType:void 0})}s=t==null?void 0:r;var x=r,y=[];w=e.ctas;if(w!=null){u=w.map(function(b,c){c=(j||(j=d("I64"))).add(x,j.of_int32(c+1));y.push(c);var e=b.actionUrl,h=b.nativeUrl;return a.attachment_ctas.add({actionContentBlob:void 0,actionUrl:e!=null?e:h,attachmentFbid:g,attachmentIndex:j.zero,ctaId:c,enableExtensions:!1,extensionHeightType:void 0,messageId:p,nativeUrl:h!=null?h:e,platformToken:void 0,targetId:void 0,threadKey:f,title:(c=b.title)!=null?c:"Tap to view status update",type_:"xma_web_url",urlWebviewType:void 0})});yield (h||(h=b("Promise"))).all(u)}var z;switch(e.targetType){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:z={height:(j||(j=d("I64"))).of_int32(108),width:(j||(j=d("I64"))).of_int32(72),xmaContentType:"xma_montage_share"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:z={xmaContentType:"xma_rtc_audio"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:z={xmaContentType:"xma_rtc_video"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:z={xmaContentType:"xma_rtc_missed_audio"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:z={xmaContentType:"xma_rtc_missed_video"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:z={xmaContentType:"xma_rtc_missed_group_audio"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:z={xmaContentType:"xma_rtc_missed_group_video"};break;default:z={height:e.previewHeight!=null?(j||(j=d("I64"))).of_int32(e.previewHeight):void 0,width:e.previewWidth!=null?(j||(j=d("I64"))).of_int32(e.previewWidth):void 0,xmaContentType:"xma_web_url"};break}yield a.attachments.add({accessibilitySummaryText:void 0,actionUrl:void 0,attachmentCta1Id:y.length>0?y[0]:void 0,attachmentCta2Id:y.length>1?y[1]:void 0,attachmentCta3Id:y.length>2?y[2]:void 0,attachmentFbid:g,attachmentIndex:j.zero,attachmentLoggingType:void 0,attachmentType:(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA),attributionAppIcon:void 0,attributionAppIconFallback:void 0,attributionAppIconUrlExpirationTimestampMs:void 0,attributionAppId:void 0,attributionAppName:void 0,authorityLevel:j.zero,avatarCount:void 0,avatarViewAccessibilityLabel:void 0,avatarViewSize:void 0,avatarViewTitleList:void 0,avatarViewUrlExpirationTimestampList:void 0,avatarViewUrlFallbackList:void 0,avatarViewUrlList:void 0,captionBodyText:void 0,cta1Title:l(e.ctas,1),cta1Type:k(e.ctas,1),cta2Title:l(e.ctas,2),cta2Type:k(e.ctas,2),cta3Title:l(e.ctas,3),cta3Type:k(e.ctas,3),dashManifest:void 0,decryptionKey:void 0,defaultCtaId:s,defaultCtaTitle:(v=e.defaultCTA)==null?void 0:v.title,defaultCtaType:z.xmaContentType,descriptionText:void 0,ephemeralMediaState:void 0,faviconUrl:void 0,faviconUrlExpirationTimestampMs:void 0,faviconUrlFallback:void 0,filename:void 0,filesize:e.filesize!=null?(j||(j=d("I64"))).of_int32(e.filesize):void 0,gatingTitle:e.overlayTitle,gatingType:e.overlayIconGlyph!=null?String(e.overlayIconGlyph):void 0,hasMedia:!1,hasXma:!0,headerImageUrl:void 0,headerImageUrlExpirationTimestampMs:void 0,headerImageUrlFallback:void 0,headerImageUrlMimeType:void 0,headerTitle:e.headerTitle,imageUrl:void 0,imageUrlExpirationTimestampMs:void 0,imageUrlFallback:void 0,imageUrlMimeType:void 0,isBorderless:void 0,isPreviewImage:void 0,isSharable:!0,listItemAccessibilityText1:void 0,listItemAccessibilityText2:void 0,listItemAccessibilityText3:void 0,listItemContactUrlExpirationTimestampList1:void 0,listItemContactUrlExpirationTimestampList2:void 0,listItemContactUrlExpirationTimestampList3:void 0,listItemContactUrlFallbackList1:void 0,listItemContactUrlFallbackList2:void 0,listItemContactUrlFallbackList3:void 0,listItemContactUrlList1:void 0,listItemContactUrlList2:void 0,listItemContactUrlList3:void 0,listItemId1:void 0,listItemId2:void 0,listItemId3:void 0,listItemProfilePictureUrl1:void 0,listItemProfilePictureUrl2:void 0,listItemProfilePictureUrl3:void 0,listItemProfilePictureUrlExpirationTimestamp1:void 0,listItemProfilePictureUrlExpirationTimestamp2:void 0,listItemProfilePictureUrlExpirationTimestamp3:void 0,listItemProfilePictureUrlFallback1:void 0,listItemProfilePictureUrlFallback2:void 0,listItemProfilePictureUrlFallback3:void 0,listItemProgressBarFilledPercentage1:void 0,listItemProgressBarFilledPercentage2:void 0,listItemProgressBarFilledPercentage3:void 0,listItemsDescriptionSubtitleText:void 0,listItemsDescriptionText:void 0,listItemsId:void 0,listItemsSecondaryDescriptionText:void 0,listItemTitleText1:void 0,listItemTitleText2:void 0,listItemTitleText3:void 0,localPlayableUrl:void 0,maxSubtitleNumOfLines:e.maxSubtitleNumOfLines!=null?(j||(j=d("I64"))).of_int32(e.maxSubtitleNumOfLines):void 0,maxTitleNumOfLines:e.maxTitleNumOfLines!=null?(j||(j=d("I64"))).of_int32(e.maxTitleNumOfLines):void 0,messageId:p,miniPreview:void 0,offlineAttachmentId:(t=e.offlineAttachmentId)!=null?t:g,originalFileHash:void 0,originalPageSenderId:void 0,playableDurationMs:void 0,playableUrl:void 0,playableUrlExpirationTimestampMs:void 0,playableUrlFallback:void 0,playableUrlMimeType:void 0,preheaderText:void 0,previewHeight:z.height,previewHeightLarge:e.previewHeightLarge!=null?(j||(j=d("I64"))).of_int32(e.previewHeightLarge):void 0,previewImageDecorationType:n(e.targetType),previewUrl:void 0,previewUrlExpirationTimestampMs:void 0,previewUrlFallback:void 0,previewUrlLarge:void 0,previewUrlMimeType:void 0,previewWidth:z.width,previewWidthLarge:e.previewWidthLarge!=null?(j||(j=d("I64"))).of_int32(e.previewWidthLarge):void 0,samplingFrequencyHz:void 0,shouldAutoplayVideo:void 0,shouldHighlightHeaderTitleInTitle:void 0,shouldRespectServerPreviewSize:void 0,sourceText:void 0,subtitleIconUrl:void 0,subtitleText:e.subtitleText,targetId:void 0,threadKey:f,timestampMs:q,titleText:e.titleText,transportKey:"WhatsApp",viewerSeenTimestampMs:void 0,waveformData:void 0,xmaLayoutType:e.xmaLayoutType!=null?m(e.xmaLayoutType):void 0,xmasTemplateType:e.xmaLayoutType!=null?m(e.xmaLayoutType):void 0})});return q.apply(this,arguments)}function r(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.threadJid,"MAWBridgeNewXMAHandler",function(a,c){return p(a,b,c)})}function a(a,b){return r(a,b)}g.call=a}),98);
__d("LSCoreClientFolderType",[],(function(a,b,c,d,e,f){a=Object.freeze({INBOX:0,PENDING:1,OTHER:2,SPAM:3,ARCHIVED:4,HIDDEN:5,MARKETPLACE:12,RESTRICTED:15,INTEROP:19});f["default"]=a}),66);
__d("LSCreateE2EEMetadataThread",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("wa_jid",a[0]),d[0].set("offline_thread_key",a[1]),d[0].set("thread_type",a[2]),d[0].set("folder_type",a[3]),d[0].set("bump_timestamp_ms",a[4]),d[0].set("tam_thread_subtype",c.i64.cast([0,0])),d[1]=d[0].get("offline_thread_key"),d[0],d[2]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[1]),c.i64.cast([0,388]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSCreateE2EEMetadataThreadStoredProcedure",["LSCreateE2EEMetadataThread","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.waJid;d[1]=b.offlineThreadKey;d[2]=b.threadType;d[3]=b.folderType;d[4]=b.bumpTimestampMs;return c("LSCreateE2EEMetadataThread").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWFolderUtils",["LSCoreClientFolderType","LSIntEnum","MAWFolderTypes","MessagingFolderTag"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){switch(a){case d("MAWFolderTypes").PENDING:return c("MessagingFolderTag").PENDING;case d("MAWFolderTypes").OTHER:return c("MessagingFolderTag").OTHER;case d("MAWFolderTypes").SPAM:return c("MessagingFolderTag").SPAM;case d("MAWFolderTypes").ARCHIVED:return c("MessagingFolderTag").UNKNOWN;default:return c("MessagingFolderTag").INBOX}}function b(a){switch(a){case d("MAWFolderTypes").PENDING:return(h||(h=d("LSIntEnum"))).ofNumber(-101);case d("MAWFolderTypes").OTHER:return(h||(h=d("LSIntEnum"))).ofNumber(-102);case d("MAWFolderTypes").SPAM:return(h||(h=d("LSIntEnum"))).ofNumber(-103);case d("MAWFolderTypes").ARCHIVED:return(h||(h=d("LSIntEnum"))).ofNumber(-110);default:return(h||(h=d("LSIntEnum"))).ofNumber(-100)}}function e(a){switch(a){case d("MAWFolderTypes").INBOX:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").INBOX);case d("MAWFolderTypes").PENDING:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").PENDING);case d("MAWFolderTypes").OTHER:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").OTHER);case d("MAWFolderTypes").SPAM:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").SPAM);case d("MAWFolderTypes").ARCHIVED:return(h||(h=d("LSIntEnum"))).ofNumber(c("LSCoreClientFolderType").ARCHIVED)}}function f(a){switch(a){case(h||(h=d("LSIntEnum"))).ofNumber(-1):return(h||(h=d("LSIntEnum"))).ofNumber(-101);case(h||(h=d("LSIntEnum"))).ofNumber(-2):return(h||(h=d("LSIntEnum"))).ofNumber(-102);case(h||(h=d("LSIntEnum"))).ofNumber(-3):return(h||(h=d("LSIntEnum"))).ofNumber(-103);case(h||(h=d("LSIntEnum"))).ofNumber(-10):return(h||(h=d("LSIntEnum"))).ofNumber(-110);default:return(h||(h=d("LSIntEnum"))).ofNumber(-100)}}g.getMessagingFolderTag=a;g.getClientSystemFolder=b;g.systemFolderToLSCoreClientFolder=e;g.systemFolderToClientSystemFolder=f}),98);
__d("MAWThreadDefaults",["fbt","I64","LSBitOffset","LSIntEnum","gkx","qex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;function k(){if(c("qex")._("327")===!0)return!0;else return c("qex")._("121")===!0}function a(a){if(k())return d("LSBitOffset").set((j||(j=d("LSIntEnum"))).ofNumber(42),a);else return a}function b(a){if(c("gkx")("23997"))return d("LSBitOffset").set((j||(j=d("LSIntEnum"))).ofNumber(4),a);else return a}e=d("LSBitOffset").set((j||(j=d("LSIntEnum"))).ofNumber(18),d("LSBitOffset").set(j.ofNumber(56),d("LSBitOffset").set(j.ofNumber(14),d("LSBitOffset").set(j.ofNumber(23),d("LSBitOffset").set(j.ofNumber(8),d("LSBitOffset").set(j.ofNumber(15),d("LSBitOffset").set(j.ofNumber(2),d("LSBitOffset").empty)))))));f=a(b(d("LSBitOffset").set(j.ofNumber(7),d("LSBitOffset").set(j.ofNumber(6),d("LSBitOffset").set(j.ofNumber(9),d("LSBitOffset").set(j.ofNumber(10),d("LSBitOffset").set(j.ofNumber(19),d("LSBitOffset").set(j.ofNumber(35),d("LSBitOffset").set(j.ofNumber(43),e)))))))));a=d("LSBitOffset").set(j.ofNumber(17),d("LSBitOffset").set(j.ofNumber(60),d("LSBitOffset").set(j.ofNumber(16),d("LSBitOffset").set(j.ofNumber(26),d("LSBitOffset").set(j.ofNumber(28),d("LSBitOffset").clear(j.ofNumber(27),f))))));b=d("LSBitOffset").set((i||(i=d("I64"))).sub(j.ofNumber(103),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(85),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(109),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(74),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(65),i.of_string("64")),d("LSBitOffset").set(i.sub(j.ofNumber(64),i.of_string("64")),d("LSBitOffset").empty))))));e=h._("__JHASH__9ZFn8zMzjpf__JHASH__").toString();g.defaultThreadCapabilities=f;g.defaultGroupThreadCapabilities=a;g.defaultThreadCapabilities_2=b;g.nullstateDescriptionText1=e;g.defaultThreadCapabilities_3=d("LSBitOffset").empty;g.defaultThreadCapabilities_4=d("LSBitOffset").empty}),226);
__d("MAWBridgeOccamadilloVerifyThreadExistsHandler",["FBLogger","I64","LSAuthorityLevel","LSCoreClientFolderType","LSCreateE2EEMetadataThreadStoredProcedure","LSFactory","LSIntEnum","LSThreadBitOffset","MAWBridgeFireAndForget","MAWCreateOptimisticThread","MAWFolderUtils","MAWMiActGetThreadLifecycleState","MAWMiActOnActThreadReadyQueue","MAWMiActOnMiThreadReadyQueue","MAWMiActThreadLifecycleState","MAWThreadDefaults","MAWTimeUtils","Promise","WAJids","WALoggerDeferred","WATimeUtils","asyncToGeneratorRuntime","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] 1. Let MI server know about WA thread for JID: "," and state: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] 3. Thread loading is fully complete for threadKey: ",", JID: ",", and state: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] 2. Handle new authoritative thread for threadKey: ",", JID: ",", and state: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] 1. Let MI server know about WA thread for JID: "," and state: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] 5. Authoritative thread not found for chatId: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Thread is missing in Occamadillo verify thread exists"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Duplicated thread creation.\n      threadKey: ","\n      bumpTimestampMs: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Creating e2ee metadata optimistic thread.\n  threadKey: ","\n  bumpTimestampMs: ",",\n  description: ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Detected 0 for last activity timestamp from MI for thread: ",", using local state timestamp: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] no folder type was supplied to Occamadillo verify thread exists handler"]);t=function(){return a};return a}var u=new Set();function v(a){return(i||(i=d("I64"))).of_string(d("WAJids").threadIdForChatJid(a))}function w(a){a=d("MAWFolderUtils").systemFolderToLSCoreClientFolder(a);a==null&&(c("promiseDone")(d("WALoggerDeferred").WARN(t())),a=(i||(i=d("I64"))).of_int32(c("LSCoreClientFolderType").INBOX));return a}function x(a,b){return b==null?d("MAWCreateOptimisticThread").createOptimisticThread(a):(i||(i=d("I64"))).of_string(b)}function y(a){a=d("MAWTimeUtils").millisTimeToTimestamp(a);return(i||(i=d("I64"))).equal(a,(i||(i=d("I64"))).zero)?d("MAWTimeUtils").millisTimeToTimestamp(d("WATimeUtils").millisTime()):a}function z(a,b){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=c("LSFactory")(a),f=y(b.lastActivityTs),g=(yield x(a,b.clientThreadKey)),h=(i||(i=d("I64"))).of_int32(b.chatId),k=w(b.folder),l=v(b.jid),m=b.isGroup?(j||(j=d("LSIntEnum"))).ofNumber(16):(j||(j=d("LSIntEnum"))).ofNumber(15);yield a.mi_act_mapping_table.put({clientThreadPk:h,jid:l,serverThreadKey:g});a=i.to_string(g);b=(h=b.description)!=null?h:"unknown";c("promiseDone")(d("WALoggerDeferred").LOG(r(),a,i.to_string(f),b));u.has(a)?c("promiseDone")(d("WALoggerDeferred").WARN(q(),a,(i||(i=d("I64"))).to_string(f))):u.add(a);return c("LSCreateE2EEMetadataThreadStoredProcedure")(e,{bumpTimestampMs:f,folderType:k,offlineThreadKey:g,threadType:m,waJid:l})});return A.apply(this,arguments)}function B(a,b,e){a=a;(i||(i=d("I64"))).equal(a,(i||(i=d("I64"))).zero)&&(c("promiseDone")(d("WALoggerDeferred").WARN(s(),(i||(i=d("I64"))).to_string(e),i.to_string(b))),a=b);return a}var C=[105,17,25,24];function D(a,b){var e=C.filter(function(b){return d("LSThreadBitOffset").has(b,a)});if(c("gkx")("23998")){var f=61,g=d("LSThreadBitOffset").has(f,a);g&&e.push(f)}return d("LSThreadBitOffset").set(e,b?d("MAWThreadDefaults").defaultGroupThreadCapabilities:d("MAWThreadDefaults").defaultThreadCapabilities,d("MAWThreadDefaults").defaultThreadCapabilities_2,d("MAWThreadDefaults").defaultThreadCapabilities_3,d("MAWThreadDefaults").defaultThreadCapabilities_4)}function E(a,b,c){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=(yield a.threads.get(e));if(g==null){c("promiseDone")(d("WALoggerDeferred").ERROR(p()));return(h||(h=b("Promise"))).resolve()}var j=f.clientThreadKey!=null?(i||(i=d("I64"))).of_string(f.clientThreadKey):g.clientThreadKey,k=B(g.lastActivityTimestampMs,d("MAWTimeUtils").millisTimeToTimestamp(f.lastActivityTs),e),l=d("MAWTimeUtils").millisTimeToTimestamp(f.lastReadTs);f=D(g,f.isGroup);return a.threads.upsert([e],babelHelpers["extends"]({},g,{capabilities:f[0],capabilities2:f[1],capabilities3:f[2],capabilities4:f[3],clientThreadKey:j,lastActivityTimestampMs:k,lastReadWatermarkTimestampMs:l}))});return F.apply(this,arguments)}function G(a,b,c){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){yield a.mi_act_mapping_table.put({clientThreadPk:(i||(i=d("I64"))).of_int32(e.chatId),jid:v(e.jid),serverThreadKey:c}),yield (h||(h=b("Promise"))).all([E(a,c,e),I(a,c,e)])});return H.apply(this,arguments)}function I(a,b,c){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(c.clientThreadKey!=null){c=(i||(i=d("I64"))).of_string(c.clientThreadKey);(i||(i=d("I64"))).equal(b,c)||(yield a.threads["delete"](c))}});return J.apply(this,arguments)}function K(a,b,c){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=(yield a.threads.get(e));g!=null&&(i||(i=d("I64"))).to_int32(g.authorityLevel)===c("LSAuthorityLevel").AUTHORITATIVE&&(yield (h||(h=b("Promise"))).all([E(a,e,f),I(a,e,f)]));g==null&&c("promiseDone")(d("WALoggerDeferred").LOG(o(),f.chatId))});return L.apply(this,arguments)}function M(a,b){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f=(i||(i=d("I64"))).of_string(d("WAJids").threadIdForChatJid(b.jid));f=(yield d("MAWMiActGetThreadLifecycleState").getThreadLifecycleStateByJidOrThreadKey(a,f,b.authoritativeThreadKey,"MAWBridgeOccamadilloVerifyThreadExistsHandler"));e=(e=b.description)!=null?e:"unknown";switch(f.type){case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.JID_MISSING_MAPPING_ROW:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.JID_MISSING_MI_THREAD:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.OPTIMISTIC_THREAD_WITH_ACT:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.ACT_THREAD_ONLY:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.ACT_THREAD_ONLY_BY_JID:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.ACT_THREAD_ONLY_BY_CHAT_ID:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.CLIENT_PARTIAL_MI_THREAD:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.CLIENT_PARTIAL_MI_THREAD_WITH_ACT:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.SERVER_PARTIAL_MI_THREAD:c("promiseDone")(d("WALoggerDeferred").LOG(n(),b.jid,f.type));return z(a,b);case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.AUTHORITATIVE_THREAD_ONLY:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.AUTHORITATIVE_THREAD_MISSING_MAPPING_ROW:var g=(i||(i=d("I64"))).to_string(f.serverThreadKey);c("promiseDone")(d("WALoggerDeferred").LOG(m(),g,b.jid,f.type));return G(a,f.serverThreadKey,b);case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.MI_AND_ACT_THREAD_COMPLETE:g=(i||(i=d("I64"))).to_string(f.serverThreadKey);c("promiseDone")(d("WALoggerDeferred").LOG(l(),g,b.jid,f.type));return K(a,f.serverThreadKey,b);case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.THREAD_KEY_ONLY:if(c("gkx")("33058")){c("promiseDone")(d("WALoggerDeferred").LOG(k(),b.jid,f.type));return z(a,b)}else throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[Occamadillo] Unimplemented VerifyThreadExists state: %s for JID: %s, from %s",f.type,b.jid,e);case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.OPTIMISTIC_THREAD_NO_ACT:throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[Occamadillo] Unimplemented VerifyThreadExists state: %s for JID: %s, from %s",f.type,b.jid,e);default:f.type;throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[Occamadillo] Unhandled VerifyThreadExists state: %s for JID: %s, from %s",f.type,b.jid,e)}});return N.apply(this,arguments)}function O(a,b,c){return P.apply(this,arguments)}function P(){P=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(c("gkx")("23920")){a=(yield a.threads.get(b));if(a!=null){a={ephemeralExpirationInSec:(i||(i=d("I64"))).to_int32((b=a.disappearingSettingTtl)!=null?b:(i||(i=d("I64"))).zero),ephemeralLastUpdatedOrSetTimestamp:d("WATimeUtils").castMilliSecondsToUnixTime(i.to_float((b=a.disappearingSettingUpdatedTs)!=null?b:(i||(i=d("I64"))).zero))};d("MAWBridgeFireAndForget").fireAndForget("backend","setEphemeralSettingCache",{jid:e,settings:a})}}});return P.apply(this,arguments)}function a(a,b){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield M(a,b);if(b.clientThreadKey!=null){var e=(i||(i=d("I64"))).of_string(b==null?void 0:b.clientThreadKey);c("promiseDone")(d("MAWMiActOnActThreadReadyQueue").processQueueOnActThreadReady(e,b.chatId,b.jid))}if(b.authoritativeThreadKey!=null){e=(i||(i=d("I64"))).of_string(b.authoritativeThreadKey);c("promiseDone")(d("MAWMiActOnActThreadReadyQueue").processQueueOnActThreadReady(e,b.chatId,b.jid))}e=(e=b.authoritativeThreadKey)!=null?e:b.clientThreadKey;if(e!=null){e=(i||(i=d("I64"))).of_string(e);yield O(a,e,b.jid);return d("MAWMiActOnMiThreadReadyQueue").processQueueOnMiThreadReady(a,e,b.chatId,b.jid)}return});return Q.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeOneToOneMessageRequestLoadedHandler",["fbt","FBLogger","I64","LSAuthorityLevel","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MAWContactRelationshipType","MAWDbContact","MAWMessageRequestUtil","MAWMiActOnMiThreadReadyForChatIdOrJid","Promise","ReQL"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k;function a(a,e){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,e.threadId,e.threadJid,"MAWBridgeOneToOneMessageRequestLoadedHandler",function(a,f){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(f)).then(function(c){if(c==null)return(k||(k=b("Promise"))).resolve([void 0,void 0,void 0,!1]);var f=d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts).getKeyRange((i||(i=d("I64"))).of_string(e.fbid)));return(k||(k=b("Promise"))).all([k.resolve(c),f,k.resolve(d("LSMessagingThreadTypeUtil").isOneToOne(c.threadType))])}).then(function(e){var f=e[0];if(f==null)return(k||(k=b("Promise"))).resolve();var g=e[1];if(g==null)return(k||(k=b("Promise"))).resolve();e=e[2];if(e===!1||e==null)return(k||(k=b("Promise"))).resolve();e=d("MAWContactRelationshipType").getContactRelationshipType(g);e=f.folderName==="inbox"&&e===d("MAWDbContact").REVERSED_ONE_WAY_CONTACT&&!(i||(i=d("I64"))).equal(f.lastActivityTimestampMs,(i||(i=d("I64"))).zero);e&&(i||(i=d("I64"))).lt(g.authorityLevel,(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))&&(c("FBLogger")("messenger_web_product").mustfix("[MAW] Message Request loaded before contact is fully loaded"),e=!1);if(f.folderName==="pending"||f.folderName==="other"||f.folderName==="spam"||e){g=d("LSThreadBitOffset").clear(d("MAWMessageRequestUtil").disabledThreadCapabilitiesForIncomingRequest,f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4);e=g[0];var l=g[1],m=g[2];g=g[3];var n=void 0;f.folderName==="inbox"&&(n=h._("__JHASH__4F6x7gUU1-S__JHASH__").toString());e=[d("LSThreadBitOffset").set(d("MAWMessageRequestUtil").enabledThreadCapabilitiesForIncomingRequest,e,l,m,g),n]}else e=[[f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4],void 0];l=e[0];m=e[1];g=babelHelpers["extends"]({},f,{additionalThreadContext:m,capabilities:l[0],capabilities2:l[1],capabilities3:l[2],capabilities4:l[3]});return a.threads.put(g).then(function(){})})})}g.call=a}),226);
__d("MAWBridgeParticipantRemovedHandler",["I64","MAWMiActOnMiThreadReadyForChatIdOrJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.threadJid,"MAWBridgeParticipantRemovedHandler",function(a,c){return a.participants["delete"](c,(h||(h=d("I64"))).of_string(b.userId))})}g.call=a}),98);
__d("MAWBridgeParticipantUpdatedHandler",["fbt","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSGroupParticipantJoinState","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","MAWCurrentUser","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils","MAWUpdateLSThreadCapabilities","Promise","ReQLTable"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=d("MAWCurrentUser").getID(),m=(k||(k=d("I64"))).of_string(l);function a(a,e){if(e.fbid.startsWith("shadow_"))return(i||(i=b("Promise"))).resolve();else return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,e.threadId,e.threadJid,"MAWBridgeParticipantUpdatedHandler",function(a,f){var g=(k||(k=d("I64"))).of_string(e.fbid),n=d("MAWTimeUtils").toTimestamp(e.readWatermarkTs),o=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),p=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs),q=e.isSuperAdmin?h._("__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,r={contents:!1},s={contents:!1};return d("ReQLTable").update(a.participants,[f,g],function(a){if(a!=null){s.contents=!0;return{authorityLevel:a.authorityLevel,contactId:g,deliveredWatermarkTimestampMs:o,groupParticipantJoinState:e.isInvited?(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:a.isSuperAdmin,nickname:a.nickname,normalizedSearchTerms:a.normalizedSearchTerms,participantCapabilities:a.participantCapabilities,readActionTimestampMs:p,readWatermarkTimestampMs:n,subscribeSource:q,threadKey:f}}else{s.contents=!0;r.contents=!0;return{authorityLevel:(k||(k=d("I64"))).zero,contactId:g,deliveredWatermarkTimestampMs:o,groupParticipantJoinState:e.isInvited?(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:e.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:k.zero,readWatermarkTimestampMs:n,subscribeSource:q,threadKey:f}}}).then(function(){if(s.contents)return d("MAWUpdateLSThreadCapabilities").disableBlockerCapabilitiesTxn(a,f).then(function(){var c=e.isAdmin;if((k||(k=d("I64"))).equal(m,g))if(c)return d("MAWUpdateLSThreadCapabilities").enableAddMembersTxn(a,f);else return d("MAWUpdateLSThreadCapabilities").disableAddMembersTxn(a,f);else return(i||(i=b("Promise"))).resolve()});else return(i||(i=b("Promise"))).resolve()}).then(function(){if(r.contents)return c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(a),{authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:j.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:j.ofNumber(c("LSContactIdType").FBID),contactType:j.ofNumber(c("LSContactType").USER),contactViewerRelationship:j.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:j.ofNumber(c("LSContactGender").UNKNOWN),id:g,isBlocked:!1,isMemorialized:!1,isSelf:l===e.fbid,workForeignEntityType:j.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)});else return(i||(i=b("Promise"))).resolve()})})}g.call=a}),226);
__d("MAWBridgeParticipantsUpdatedHandler",["fbt","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSGroupParticipantJoinState","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","MAWCurrentUser","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils","MAWUpdateLSThreadCapabilities","Promise","ReQLTable","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=d("MAWCurrentUser").getID(),m=(k||(k=d("I64"))).of_string(l);function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=e.participants.filter(function(a){return!a.fbid.startsWith("shadow_")});yield (i||(i=b("Promise"))).all(e.map(function(e){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,e.threadId,e.threadJid,"MAWBridgeParticipantsUpdatedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f=(k||(k=d("I64"))).of_string(e.fbid),g=d("MAWTimeUtils").toTimestamp(e.readWatermarkTs),i=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),n=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs),o=e.isSuperAdmin?h._("__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,p=!1,q=!1;yield d("ReQLTable").update(a.participants,[b,f],function(a){if(a!=null){q=!0;return{authorityLevel:a.authorityLevel,contactId:f,deliveredWatermarkTimestampMs:(k||(k=d("I64"))).equal(i,(k||(k=d("I64"))).zero)?a.deliveredWatermarkTimestampMs:i,groupParticipantJoinState:e.isInvited?(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:a.isSuperAdmin,nickname:a.nickname,normalizedSearchTerms:a.normalizedSearchTerms,participantCapabilities:a.participantCapabilities,readActionTimestampMs:(k||(k=d("I64"))).equal(n,(k||(k=d("I64"))).zero)?a.readActionTimestampMs:n,readWatermarkTimestampMs:(k||(k=d("I64"))).equal(g,(k||(k=d("I64"))).zero)?a.readWatermarkTimestampMs:g,subscribeSource:o,threadKey:b}}else{q=!0;p=!0;return{authorityLevel:(k||(k=d("I64"))).zero,contactId:f,deliveredWatermarkTimestampMs:i,groupParticipantJoinState:e.isInvited?(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:e.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:k.zero,readWatermarkTimestampMs:g,subscribeSource:o,threadKey:b}}});q&&(yield d("MAWUpdateLSThreadCapabilities").disableBlockerCapabilitiesTxn(a,b),(k||(k=d("I64"))).equal(m,f)&&(e.isAdmin?yield d("MAWUpdateLSThreadCapabilities").enableAddMembersTxn(a,b):yield d("MAWUpdateLSThreadCapabilities").disableAddMembersTxn(a,b)));p&&(yield c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(a),{authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:j.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:j.ofNumber(c("LSContactIdType").FBID),contactType:j.ofNumber(c("LSContactType").USER),contactViewerRelationship:j.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:j.ofNumber(c("LSContactGender").UNKNOWN),id:f,isBlocked:!1,isMemorialized:!1,isSelf:l===e.fbid,workForeignEntityType:j.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)}))});return function(b,c){return a.apply(this,arguments)}}())}))});return n.apply(this,arguments)}g.call=a}),226);
__d("MAWBridgeRavenActionMsgForUIHandler",["I64","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWMsg","MAWRavenUtils","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.threadId,c.threadJid,"MAWBridgeRavenActionMsgForUIHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){a=a.attachments;e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(e,c.ravenMsgId)));if(e==null)return(i||(i=b("Promise"))).resolve();if(e.ephemeralMediaState==null)return(i||(i=b("Promise"))).resolve();var f=(h||(h=d("I64"))).to_int32(e.ephemeralMediaState);if(e.ephemeralMediaViewMode==null)return(i||(i=b("Promise"))).resolve();var g=h.to_int32(e.ephemeralMediaViewMode);f=d("MAWMsg").MAWRavenMsgEphemeralMediaState.cast(f);g=d("MAWMsg").MAWRavenMsgEphemeralType.cast(g);if(f==null||g==null)return(i||(i=b("Promise"))).resolve();f=d("MAWRavenUtils").getNextRavenMessageEphemeralState(f,g);if(f==null)return(i||(i=b("Promise"))).resolve();e.ephemeralMediaState;g=babelHelpers.objectWithoutPropertiesLoose(e,["ephemeralMediaState"]);e=babelHelpers["extends"]({ephemeralMediaState:h.of_int32(f)},g,{transportKey:"WhatsApp"});f=[g.threadKey,g.messageId,g.attachmentFbid];return a.upsert(f,e)});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeReactionUpsertHandler",["I64","LSAuthorityLevel","LSIntEnum","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b,e,f,g,j){return a.reactions.upsert([e,f,(h||(h=d("I64"))).of_string(b)],{actorId:h.of_string(b),authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),messageId:f,reaction:j,reactionCreationTimestampMs:d("MAWTimeUtils").toTimestamp(g),threadKey:e,timestampMs:d("MAWTimeUtils").toTimestamp(g)})}function a(a,b,c,d,e,f){return j(a,b,c,d,e,f)}function b(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.chatJid,"MAWBridgeReactionUpsertHandler",function(a,c){return j(a,b.actorId,c,b.messageId,b.ts,b.reaction)})}g.attachmentMutationsOptimisticHandler=a;g.call=b}),98);
__d("MAWBridgeReceivedReceiptHandler",["I64","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils","Promise","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.threadId,c.chatJid,"MAWBridgeReceivedReceiptHandler",function(a,e){var f=(i||(i=d("I64"))).of_string(c.fbid),g=d("MAWTimeUtils").toTimestamp(c.lastReadWatermarkTs),j=d("MAWTimeUtils").toTimestamp(c.deliveredWatermarkTs),k=d("MAWTimeUtils").toTimestamp(c.lastReadActionTs);return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.participants).getKeyRange(e,f)).then(function(c){if(c!=null)return a.participants.put({authorityLevel:c.authorityLevel,contactId:c.contactId,deliveredWatermarkTimestampMs:(i||(i=d("I64"))).equal(j,(i||(i=d("I64"))).zero)?c.deliveredWatermarkTimestampMs:j,groupParticipantJoinState:c.groupParticipantJoinState,isAdmin:c.isAdmin,isModerator:c.isModerator,isSuperAdmin:c.isSuperAdmin,nickname:c.nickname,normalizedSearchTerms:c.normalizedSearchTerms,participantCapabilities:c.participantCapabilities,readActionTimestampMs:(i||(i=d("I64"))).equal(k,(i||(i=d("I64"))).zero)?c.readActionTimestampMs:k,readWatermarkTimestampMs:(i||(i=d("I64"))).equal(g,(i||(i=d("I64"))).zero)?c.readWatermarkTimestampMs:g,subscribeSource:c.subscribeSource,threadKey:c.threadKey,threadRoles:(i||(i=d("I64"))).zero});else return(h||(h=b("Promise"))).resolve()}).then(function(){})})}g.call=a}),98);
__d("MAWBridgeSyncContacts",["CurrentMessengerUser","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=d("CurrentMessengerUser").getID();function a(a,e){return e.reduce(function(b,e){var f=(i||(i=d("I64"))).of_string(e);return b.then(function(){return c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(a),{authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:j.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:j.ofNumber(c("LSContactIdType").FBID),contactType:j.ofNumber(c("LSContactType").USER),contactViewerRelationship:j.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:j.ofNumber(c("LSContactGender").UNKNOWN),id:f,isBlocked:!1,isMemorialized:!1,isSelf:k===e,workForeignEntityType:j.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)})}).then(function(){})},(h||(h=b("Promise"))).resolve())}g.call=a}),98);
__d("MAWBridgeBuildThreadSnippet",["MAWAdminMsg","MAWBridgeBuildMsgMentions","MAWLocalizationType","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWVault","ReQL","asyncToGeneratorRuntime","first"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a!=null?d("MAWVault").unvault(a):void 0}function i(a,b,c){if(a==null)return b;b=[].concat(b);switch(c){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP:b[0]=a;break}return b}function a(a,b,c,d){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){var g=e.snippetContactIDs,j=e.snippetMentionJIDs,l=e.snippetParams,m=e.snippetType,n=e.threadId,o=e.threadJid;if(l==null||m==null||g==null)return f;e=(yield d("MAWBridgeBuildMsgMentions").buildThreadSnippetWithMentions(a,b,n,h(c("first")(l)),j,g,m,function(b){var c=b[0];b=b[1];c=d("MAWAdminMsg").buildLocalizedString(i(c,l,m),b,m);return k(a,n,o,c)}));f=e[0];b=e[1];return d("MAWAdminMsg").buildLocalizedString(i(f,l,m),b,m)});return j.apply(this,arguments)}function k(a,c,e,f){return a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c,e,"MAWBridgeBuildThreadSnippet",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a.threads;b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(b)));b&&(yield a.put(babelHelpers["extends"]({},b,{snippet:f})))});return function(b,c){return a.apply(this,arguments)}}())});return function(b){return a.apply(this,arguments)}}(),"readwrite")}g.buildBridgeThreadSnippet=a}),98);
__d("MAWBumpThread",["ODS","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c,d,e,f,g){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,i){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(b)));if(b==null)return(h||(h=d("ODS"))).bumpEntityKey(3185,"armadillo_thread_bump","missing_thread");g=(g=g)!=null?g:b.snippetSenderContactId;yield a.threads.put(babelHelpers["extends"]({},b,{lastActivityTimestampMs:c,lastMessageCtaType:i,lastReadWatermarkTimestampMs:e,snippet:f,snippetSenderContactId:g}))});return i.apply(this,arguments)}g.threadMutation=a}),98);
__d("getMAWLastMessageCtaType",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.snippetType;switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_AUDIO_CALL:return"xma_rtc_missed_audio";case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_AUDIO_CALL:return"xma_rtc_missed_group_audio";case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_VIDEO_CALL:return"xma_rtc_missed_video";case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_VIDEO_CALL:return"xma_rtc_missed_group_video"}}g["default"]=a}),98);
__d("MAWBridgeThreadBumpedHandler",["I64","MAWBridgeBuildThreadSnippet","MAWBumpThread","MAWCalculateBumpTimestampMs","MAWMiActOnMiThreadReadyForChatIdOrJid","ReQL","WALoggerDeferred","asyncToGeneratorRuntime","getMAWLastMessageCtaType","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bumping thread on local device. threadKey: ",", lastActivityTs: ",", lastReadTs: ",", from: ",""]);i=function(){return a};return a}function a(a,e,f){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(e,f.threadId,f.threadJid,"MAWBridgeThreadBumpedHandler",function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){var g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(b.threads).getKeyRange(e)));if(g==null)return;var j=d("MAWCalculateBumpTimestampMs").calculateBumpTimestampMs(f.lastActivityTs,f.lastMsgExternalId),k=d("MAWCalculateBumpTimestampMs").calculateBumpTimestampMs(f.lastReadTs,f.lastMsgExternalId);c("promiseDone")(d("WALoggerDeferred").LOG(i(),(h||(h=d("I64"))).to_string(e),h.to_string(j),h.to_string(k),f.description));g=(yield d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(a,b,f,g.snippet));var l=f.snippetSenderContactId!=null?(h||(h=d("I64"))).of_string(f.snippetSenderContactId):void 0,m=c("getMAWLastMessageCtaType")(f);return d("MAWBumpThread").threadMutation(b,e,j,k,g,l,m)});return function(a,b){return e.apply(this,arguments)}}())}g.call=a}),98);
__d("LSBumpE2EEMetadataThread",["LSCancelTaskByQueueName","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("bump_timestamp_ms",a[1]),d[0].set("thread_key",a[0]),d[0].set("bumped_by_local_device_send",a[2]),d[0].set("tam_thread_subtype",c.i64.cast([0,0])),d[0].set("wa_jid",void 0),d[0].set("message_ephemeral_duration_in_sec",c.i64.cast([0,0])),d[0].set("message_product_type",void 0),d[0].set("is_message_deletion",!1),d[1]=d[0].get("thread_key"),d[0],c.storedProcedure(b("LSCancelTaskByQueueName"),c.i64.to_string(d[1]),c.i64.cast([0,389]))},function(e){return d[2]=new c.Map(),d[2].set("bump_timestamp_ms",a[1]),d[2].set("thread_key",a[0]),d[2].set("bumped_by_local_device_send",a[2]),d[2].set("tam_thread_subtype",c.i64.cast([0,0])),d[2].set("wa_jid",void 0),d[2].set("message_ephemeral_duration_in_sec",c.i64.cast([0,0])),d[2].set("message_product_type",void 0),d[2].set("is_message_deletion",!1),d[3]=d[2].get("thread_key"),d[2],d[4]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[3]),c.i64.cast([0,389]),d[4],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSBumpE2EEMetadataThreadStoredProcedure",["LSBumpE2EEMetadataThread","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.serverAuthoritativeTimestampMs;d[2]=b.bumpedByLocalDeviceSend;return c("LSBumpE2EEMetadataThread").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWBridgeThreadBumpedServerHandler",["I64","LSBumpE2EEMetadataThreadStoredProcedure","LSFactory","MAWCalculateBumpTimestampMs","MAWMiActOnMiThreadReadyForChatIdOrJid","WALoggerDeferred","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Bumping thread on server. threadKey: ",", bumpTimestampMs: ",", isLocalDeviceSend: ",", from ",""]);i=function(){return a};return a}function a(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.threadJid,"MAWBridgeThreadBumpedServerHandle",function(a,e){var f=b.lastActivityTs;f=d("MAWCalculateBumpTimestampMs").calculateBumpTimestampMs(f,b.lastMsgExternalId);c("promiseDone")(d("WALoggerDeferred").LOG(i(),(h||(h=d("I64"))).to_string(e),h.to_string(f),b.isCurrentDeviceSendingMsg,b.description));return c("LSBumpE2EEMetadataThreadStoredProcedure")(c("LSFactory")(a),{bumpedByLocalDeviceSend:b.isCurrentDeviceSendingMsg,serverAuthoritativeTimestampMs:f,threadKey:e})})}g.call=a}),98);
__d("MAWBridgeThreadBumpedV2Handler",["I64","LSBumpE2EEMetadataThreadStoredProcedure","LSFactory","LSOptimisticMarkThreadReadV2StoredProcedure","MAWBridgeBuildThreadSnippet","MAWMiActOnMiThreadReadyForChatIdOrJid","ODS","Promise","ReQL","WALoggerDeferred","asyncToGeneratorRuntime","getMAWLastMessageCtaType","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Skipping local bump for thread: ",", bumpTimestampMs: ",", DB lastActivityTimestampMs: ",", from ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Bumping thread on local (v2). threadKey: ",", bumpTimestampMs: ",", originalTimestampMs: ",", isMessageAuthorMe: ",", from ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] missing thread for bumping threadKey: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Bumping thread v2. threadKey: ",", bumpTimestampMs: ",", isMessageAuthorMe: ",", skipServerThreadBump: ",", from ",""]);n=function(){return a};return a}function a(a,e,f){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(e,f.threadId,f.threadJid,"MAWBridgeThreadBumpedV2Handler",function(){var g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(g,o){var p,q,r=f.bumpTimestampMs;p=(p=f.skipServerThreadBump)!=null?p:!1;q=(q=f.isMessageAuthorMe)!=null?q:f.isCurrentDeviceSendingMsg;c("promiseDone")(d("WALoggerDeferred").LOG(n(),(i||(i=d("I64"))).to_string(o),i.to_string(r),q,p,f.description));var s=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(g.threads).getKeyRange(o)));if(s==null){c("promiseDone")(d("WALoggerDeferred").WARN(m(),(i||(i=d("I64"))).to_string(o)));return(j||(j=d("ODS"))).bumpEntityKey(3185,"armadillo_thread_bump","missing_thread")}if((i||(i=d("I64"))).ge(r,s.lastActivityTimestampMs)){c("promiseDone")(d("WALoggerDeferred").LOG(l(),(i||(i=d("I64"))).to_string(o),i.to_string(r),i.to_string(s.lastActivityTimestampMs),q,f.description));var t=f.snippetSenderContactId!=null?(i||(i=d("I64"))).of_string(f.snippetSenderContactId):void 0;t=(t=t)!=null?t:s.snippetSenderContactId;var u=(yield d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(a,g,f,s.snippet)),v=c("getMAWLastMessageCtaType")(f);v=babelHelpers["extends"]({},s,{lastActivityTimestampMs:r,lastMessageCtaType:v,snippet:u,snippetSenderContactId:t});q&&(v=babelHelpers["extends"]({},v,{lastReadWatermarkTimestampMs:r}));yield e.threads.put(v)}else c("promiseDone")(d("WALoggerDeferred").LOG(k(),(i||(i=d("I64"))).to_string(o),i.to_string(r),i.to_string(s.lastActivityTimestampMs),f.description));if(!p){q&&void c("LSOptimisticMarkThreadReadV2StoredProcedure")(c("LSFactory")(e),{readWatermarkTimestampMs:r,threadKey:o});return c("LSBumpE2EEMetadataThreadStoredProcedure")(c("LSFactory")(g),{bumpedByLocalDeviceSend:q,serverAuthoritativeTimestampMs:r,threadKey:o})}return(h||(h=b("Promise"))).resolve()});return function(a,b){return g.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeThreadHiddenHandler",["LSFactory","LSIntEnum","LSOptimisticRemoveThreadStoredProcedure","LSThreadRemoveType","MAWDbChatId","MAWMiActOnMiThreadReadyForChatId"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForChatId").onMiThreadReadyForChatId(a,d("MAWDbChatId").unsafeCoerceToChatId(b),"MAWBridgeThreadHiddenHandler",function(a,b){a=c("LSFactory")(a);return c("LSOptimisticRemoveThreadStoredProcedure")(a,{removeType:(h||(h=d("LSIntEnum"))).ofNumber(c("LSThreadRemoveType").DELETE_THREAD),threadKey:b})})}g.call=a}),98);
__d("MAWBridgeThreadTimestampsHandler",["CurrentMessengerUser","I64","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,c){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.threadId,c.threadJid,"MAWBridgeThreadTimestampsHandler",function(a,e){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(e)).then(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e==null)return(i||(i=b("Promise"))).resolve();e=babelHelpers["extends"]({},e,{lastReadWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs)});yield a.threads.put(e)});return function(a){return e.apply(this,arguments)}}())})}function a(a,c){return j(a,c).then(function(){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.threadId,c.threadJid,"MAWBridgeThreadTimestampsHandler",function(a,e){var f=(h||(h=d("I64"))).of_string(d("CurrentMessengerUser").getID());return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.participants).getKeyRange(e,f)).then(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b!=null&&(yield a.participants.put({authorityLevel:b.authorityLevel,contactId:b.contactId,deliveredWatermarkTimestampMs:b.deliveredWatermarkTimestampMs,groupParticipantJoinState:b.groupParticipantJoinState,isAdmin:b.isAdmin,isModerator:b.isModerator,isSuperAdmin:b.isSuperAdmin,nickname:b.nickname,normalizedSearchTerms:b.normalizedSearchTerms,participantCapabilities:b.participantCapabilities,readActionTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastActivityTimestampMs),readWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs),subscribeSource:b.subscribeSource,threadKey:b.threadKey}))});return function(a){return e.apply(this,arguments)}}())})})}g.call=a}),98);
__d("MAWBridgeThreadUpdatedHandler",["FBLogger","I64","LSBitOffset","MAWBridgeBuildThreadSnippet","MAWBridgeUIEventDataValidation","MAWFolderUtils","MAWMiActOnMiThreadReadyForChatIdOrJid","ReQL","asyncToGeneratorRuntime","getMAWLastMessageCtaType"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){return b!=null&&b==="viewer_not_subscribed"?d("LSBitOffset").clear((h||(h=d("I64"))).sub(h.of_int32(28),h.of_string("64")),a):a}function j(a,b){var c=b.folder!=null?d("MAWFolderUtils").getMessagingFolderTag(b.folder):a.folderName;return(b=b.cannotReplyReason)!=null?b:c==="inbox"?void 0:a.cannotReplyReason}function a(a,e,f){var g=f.muteExpireTimeMs,k=f.snippetSenderContactId,l=f.threadId,m=f.threadJid;return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(e,l,m,"MAWBridgeThreadUpdatedHandler",function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(b.threads).getKeyRange(e)));if(e==null)return;f.fromCheckIfParticipant!=null&&f.fromCheckIfParticipant&&c("FBLogger")("labyrinth_web","checkIfParticipant").warn("[Occamdillo] User not a participant from checkIfParticipant, thread folder: %s",e.folderName);var l=(yield d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(a,b,f,e.snippet)),m=j(e,f),n=c("getMAWLastMessageCtaType")(f);yield b.threads.put(babelHelpers["extends"]({},e,{cannotReplyReason:m,capabilities2:i(e.capabilities2,m),folderName:e.folderName,lastMessageCtaType:n,muteExpireTimeMs:g==null?e.muteExpireTimeMs:(h||(h=d("I64"))).of_float(g),parentThreadKey:e.parentThreadKey,snippet:l,snippetSenderContactId:k==null?e.snippetSenderContactId:d("MAWBridgeUIEventDataValidation").stringToI64Opt(k)}))});return function(a,b){return e.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeThreadsLoadedHandler",["I64","MAWFolderUtils","MAWTimeUtils","Promise","ReQL","asyncToGeneratorRuntime","toThreadKeyMaybe"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c){var e=d("MAWFolderUtils").getClientSystemFolder(c.folderId);return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads_ranges_v2__generated).getKeyRange(e)).then(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(f){if(f!=null)return a.threads_ranges_v2__generated["delete"](f.parentThreadKey,f.minThreadKey,f.minLastActivityTimestampMs).then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(c.rangeKind==="threadRangeExtensionForLoadBefore")return d("toThreadKeyMaybe").toThreadKeyMaybe_DEPRECATED(a,c.minThreadId).then(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b!=null&&(yield a.threads_ranges_v2__generated.put({hasMoreAfter:f.hasMoreAfter,hasMoreBefore:c.hasMore,isLoadingAfter:f.isLoadingAfter,isLoadingBefore:!1,maxLastActivityTimestampMs:f.maxLastActivityTimestampMs,maxThreadKey:f.maxThreadKey,minLastActivityTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.minLastActivityTs),minThreadKey:b,parentThreadKey:f.parentThreadKey}))});return function(a){return e.apply(this,arguments)}}());yield a.threads_ranges_v2__generated.put({hasMoreAfter:f.hasMoreAfter,hasMoreBefore:f.hasMoreBefore,isLoadingAfter:f.isLoadingAfter,isLoadingBefore:!1,maxLastActivityTimestampMs:f.maxLastActivityTimestampMs,maxThreadKey:f.maxThreadKey,minLastActivityTimestampMs:f.minLastActivityTimestampMs,minThreadKey:f.minThreadKey,parentThreadKey:f.parentThreadKey})}));switch(c.rangeKind){case"initialNoThread":yield a.threads_ranges_v2__generated.put({hasMoreAfter:!1,hasMoreBefore:!1,isLoadingAfter:!1,isLoadingBefore:!1,maxLastActivityTimestampMs:d("MAWTimeUtils").MAX_TIMESTAMP_MS,maxThreadKey:(i||(i=d("I64"))).zero,minLastActivityTimestampMs:d("MAWTimeUtils").MAX_TIMESTAMP_MS,minThreadKey:(i||(i=d("I64"))).zero,parentThreadKey:e});return;case"initialThreadRange":return(h||(h=b("Promise"))).all([d("toThreadKeyMaybe").toThreadKeyMaybe_DEPRECATED(a,c.minThreadId),d("toThreadKeyMaybe").toThreadKeyMaybe_DEPRECATED(a,c.maxThreadId)]).then(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var f=b[0];b=b[1];f!=null&&b!=null&&(yield a.threads_ranges_v2__generated.add({hasMoreAfter:!1,hasMoreBefore:c.hasMore,isLoadingAfter:!1,isLoadingBefore:!1,maxLastActivityTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.maxLastActivityTs),maxThreadKey:b,minLastActivityTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.minLastActivityTs),minThreadKey:f,parentThreadKey:e}))});return function(a){return f.apply(this,arguments)}}());case"threadRangeExtensionForLoadBefore":return(h||(h=b("Promise"))).resolve()}});return function(a){return f.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeUIEventQueueQPLLogger",["QPLUserFlow","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){c("QPLUserFlow").start(c("qpl")._(1056849266,"1765"),{annotations:{string_array:{events:b}},instanceKey:a})}function b(a){c("QPLUserFlow").endSuccess(c("qpl")._(1056849266,"1765"),{instanceKey:a})}function d(a,b){c("QPLUserFlow").endFailure(c("qpl")._(1056849266,"1765"),"MAWBridgeUIEventHandlerFailure",{annotations:{string:{failedEventTag:b}},instanceKey:a})}g.start=a;g.endSuccess=b;g.endFailure=d}),98);
__d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,c){return(g||(g=b("Promise"))).resolve()}f.call=a}),66);
__d("LSEncryptedBackupsClientRestoreState",[],(function(a,b,c,d,e,f){a=Object.freeze({RESTORE_IN_PROGRESS:1,RESTORE_COMPLETE:2});f["default"]=a}),66);
__d("MAWEncryptedBackupsUpdateGlobalRestoreStatus",["WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Thread with thread id "," is not currently being tracked, but restore seems to be in progress"]);h=function(){return a};return a}var i=new Set(),j=new Set();function k(a){if(a==="restore")return i;else return j}function a(a,b){b=k(b);b.add(a)}function b(a,b){b=k(b);b.has(a)?b["delete"](a):d("WALogger").WARN(h(),a)}function c(a){a=k(a);return a.size}g.addThreadIdToStatusArray=a;g.removeThreadIdFromStatusArray=b;g.getCurrentGlobalRestoreStatusArrayLength=c}),98);
__d("MAWBridgeUpdateClientRestoreStatus",["I64","LSEncryptedBackupsClientRestoreState","LSIntEnum","MAWEncryptedBackupsUpdateGlobalRestoreStatus","MAWJobDefinitions","MAWMIC","MAWUpdateClientRestoreStatusOperationType","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,c){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.encrypted_backups_client_restore_status).filter(function(a){return a.threadId===c})).then(function(c){if(c!=null)return a.encrypted_backups_client_restore_status["delete"](c.threadId).then(function(){});else return(j||(j=b("Promise"))).resolve()})}function l(a,e,f,g){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.encrypted_backups_client_restore_status).filter(function(a){return a.threadId===e})).then(function(k){if(k!=null)return a.encrypted_backups_client_restore_status.put({lastUpdated:(h||(h=d("I64"))).of_float(Date.now()),restoreStatus:(i||(i=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsClientRestoreState").RESTORE_COMPLETE),serverThreadKey:f,threadId:e}).then(function(){if(g!=null)if(!g){d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").removeThreadIdFromStatusArray(d("MAWJobDefinitions").toThreadJidPrimaryId(e),"restore");var a=d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").getCurrentGlobalRestoreStatusArrayLength("restore");a===0&&d("MAWMIC").markEvent("eb_restore_end")}else{d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").removeThreadIdFromStatusArray(d("MAWJobDefinitions").toThreadJidPrimaryId(e),"ebprefetch");a=d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").getCurrentGlobalRestoreStatusArrayLength("ebprefetch");a===0&&d("MAWMIC").markEvent("eb_prefetch_end")}});else return(j||(j=b("Promise"))).resolve()})}function a(a){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.encrypted_backups_client_restore_status)).then(function(c){return c.reduce(function(b,c){return b.then(function(){return k(a,c.threadId)})},(j||(j=b("Promise"))).resolve())})}function m(a,c){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table)).then(function(a){a=a.find(function(a){return(h||(h=d("I64"))).to_string(a.jid)===c});return a==null?(j||(j=b("Promise"))).resolve(void 0):(j||(j=b("Promise"))).resolve((h||(h=d("I64"))).to_string(a.serverThreadKey))})}function e(a,e){var f=e.threadId;return m(a,f).then(function(){var g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var g=e.action;yield g===d("MAWUpdateClientRestoreStatusOperationType").upsertClientRestoreStatus?a.encrypted_backups_client_restore_status.put({lastUpdated:(h||(h=d("I64"))).of_float(Date.now()),restoreStatus:(i||(i=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsClientRestoreState").RESTORE_IN_PROGRESS),serverThreadKey:b,threadId:f}):l(a,e.threadId,b,e.ebPrefetch)});return function(a){return g.apply(this,arguments)}}())}g.truncateClientRestoreStatusTable=a;g.findServerThreadKey=m;g.call=e}),98);
__d("LSUpdateE2EEMetadataParticipants",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[1]=d[0].get("thread_key"),d[0],d[2]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[1]),c.i64.cast([0,394]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSUpdateE2EEMetadataParticipantsStoredProcedure",["LSUpdateE2EEMetadataParticipants","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;return c("LSUpdateE2EEMetadataParticipants").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWBridgeUpdateE2EEMetadataParticipantsHandler",["LSFactory","LSUpdateE2EEMetadataParticipantsStoredProcedure","MAWMiActOnMiThreadReadyForChatIdOrJid"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.threadJid,"MAWBridgeThreadsLoadedHandler",function(a,b){return c("LSUpdateE2EEMetadataParticipantsStoredProcedure")(c("LSFactory")(a),{threadKey:b})})}g.call=a}),98);
__d("MAWBridgeUpdateMessageRangeHandler",["I64","LSClearMessagePlaceholderRangeStoredProcedure","LSFactory","LSInsertNewMessageRangeStoredProcedure","MAWMiActOnMiThreadReadyForChatIdOrJid","MAWTimeUtils","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,e.threadId,e.threadJid,"MAWBridgeUpdateMessageRangeHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f;yield c("LSClearMessagePlaceholderRangeStoredProcedure")(c("LSFactory")(a),{maxTimestampMs:d("MAWTimeUtils").MAX_TIMESTAMP_MS,messageId:"",threadKey:b});var g=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.messages_ranges_v2__generated).getKeyRange(b)));g!=null&&(yield a.messages_ranges_v2__generated["delete"](g.threadKey,g.minTimestampMs,g.minMessageId));var i=e.hasMoreAfter,j=e.hasMoreBefore,k=e.maxMsgId,l=e.minMsgId,m=j&&e.minMsgTs!=null?(h||(h=d("I64"))).of_float(e.minMsgTs):(g==null?void 0:g.minTimestampMs)||d("MAWTimeUtils").MIN_TIMESTAMP_MS,n=(g==null?void 0:g.minTimestampMs)!=null&&(h||(h=d("I64"))).lt(g==null?void 0:g.minTimestampMs,m),o=i&&e.maxMsgTs!=null?(h||(h=d("I64"))).of_float(e.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS,p=d("MAWTimeUtils").MIN_TIMESTAMP_MS;f=(f=o)!=null?f:d("MAWTimeUtils").MAX_TIMESTAMP_MS;return c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:i,hasMoreBefore:n?(g==null?void 0:g.hasMoreBefore)||!0:j,lowerOverlap:p,newMaxMid:(a=k)!=null?a:"",newMaxTs:o,newMinMid:n?(i=g==null?void 0:g.minMessageId)!=null?i:"":(j=l)!=null?j:"",newMinTs:n?(g==null?void 0:g.minTimestampMs)||d("MAWTimeUtils").MIN_TIMESTAMP_MS:m,threadKey:b,upperOverlap:f})});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeUpdateMinMessageHandler",["I64","MAWMiActOnMiThreadReadyForChatIdOrJid","ReQL","ReQLTable","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var e=(h||(h=d("I64"))).of_float(b.minTimestampMs),f=b.minMessageId;return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,b.threadId,b.threadJid,"MAWBridgeUpdateMinMessageHandler",function(a,g){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages_ranges_v2__generated).getKeyRange(g)).then(function(h){if(h==null)return;var i=b.hasMoreBefore,j=i!=null?i:h.hasMoreBefore;return d("ReQLTable").update(a.messages_ranges_v2__generated,[g,h.minTimestampMs,h.minMessageId],function(a){if(a!=null)return{hasMoreAfter:a.hasMoreAfter,hasMoreBefore:j,isLoadingAfter:a.isLoadingAfter,isLoadingBefore:a.isLoadingBefore,maxMessageId:a.maxMessageId,maxTimestampMs:a.maxTimestampMs,minMessageId:f,minTimestampMs:e,threadKey:a.threadKey};throw c("unrecoverableViolation")("Thread is missing in updating the min message in message range","messenger_e2ee_web")})})})}g.call=a}),98);
__d("MAWBridgeXMAShareExpiredHandler",["MAWMiActOnMiThreadReadyForChatIdOrJid","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,c){var e=String(c.xmaId);return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,c.chatId,c.threadJid,"MAWBridgeXMAShareExpiredHandler",function(a,d){return a.attachments.get(d,c.msgId,e).then(function(f){if(f==null)return(h||(h=b("Promise"))).resolve();f=[f.defaultCtaId,f.attachmentCta1Id,f.attachmentCta2Id,f.attachmentCta3Id].filter(Boolean);f=f.map(function(b){return a.attachment_ctas["delete"](b)});return(h||(h=b("Promise"))).all(f).then(function(){return a.attachments["delete"](d,c.msgId,e)})})})}g.call=a}),98);
__d("MAWBridgeXMAShareTombstonedHandler",["FBLogger","MAWMiActOnMiThreadReadyForChatIdOrJid","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){var f=String(e.xmaId);return d("MAWMiActOnMiThreadReadyForChatIdOrJid").onMiThreadReadyForChatIdOrJid(a,e.threadId,e.threadJid,"MAWBridgeXMAShareTombstonedHandler",function(a,g){return a.attachments.get(g,e.msgId,f).then(function(i){if(i==null)return(h||(h=b("Promise"))).resolve();i=[i.defaultCtaId,i.attachmentCta1Id,i.attachmentCta2Id,i.attachmentCta3Id].filter(Boolean);i=i.map(function(b){return a.attachment_ctas["delete"](b)});return(h||(h=b("Promise"))).all(i).then(function(){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.attachments).getKeyRange(g,e.msgId,f)).then(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(d){if(d!=null){d=babelHelpers["extends"]({},d,{attachmentCta1Id:void 0,attachmentCta2Id:void 0,attachmentCta3Id:void 0,cta1Title:void 0,cta1Type:void 0,cta2Title:void 0,cta2Type:void 0,cta3Title:void 0,cta3Type:void 0,defaultCtaId:void 0,defaultCtaTitle:void 0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,previewHeight:void 0,previewHeightLarge:void 0,previewWidth:void 0,previewWidthLarge:void 0,subtitleText:void 0,titleText:void 0});yield a.attachments.put(d)}c("FBLogger")("messenger_e2ee_web").blameToPreviousFrame().mustfix("Trying to tombstone a secure xma attachment but no existing attachment");return(h||(h=b("Promise"))).resolve()});return function(a){return d.apply(this,arguments)}}())})})})}g.call=a}),98);
__d("isInstamadilloDYI",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("665")===!0}g["default"]=a}),98);
__d("MAWBridgeUIEventHandler",["FBLogger","JSResourceForInteraction","MAWAbPropsClient","MAWBridgeDeleteGroupInviteHandler","MAWBridgeDeleteMessageRangesV2Handler","MAWBridgeDeleteMessagesHandler","MAWBridgeDeleteReactionHandler","MAWBridgeDropAllSecureThreadsHandler","MAWBridgeEditMsgHistoryAddedHandler","MAWBridgeGroupInfoUpdatedHandler","MAWBridgeGroupInviteLoadedHandler","MAWBridgeGroupInviteUpdateHandler","MAWBridgeHandleCOPDigest","MAWBridgeMediaExpiredHandler","MAWBridgeMsgRangeLoadedHandler","MAWBridgeMsgUpdatedHandler","MAWBridgeMsgsLoadedHandler","MAWBridgeMsgsStartCountdownHandler","MAWBridgeNewMediaHandler","MAWBridgeNewMediaRangeHandler","MAWBridgeNewMsgHandler","MAWBridgeNewXMAHandler","MAWBridgeOccamadilloVerifyThreadExistsHandler","MAWBridgeOneToOneMessageRequestLoadedHandler","MAWBridgeParticipantRemovedHandler","MAWBridgeParticipantUpdatedHandler","MAWBridgeParticipantsUpdatedHandler","MAWBridgeRavenActionMsgForUIHandler","MAWBridgeReactionUpsertHandler","MAWBridgeReceivedChatStateHandler","MAWBridgeReceivedReceiptHandler","MAWBridgeSyncContacts","MAWBridgeThreadBumpedHandler","MAWBridgeThreadBumpedServerHandler","MAWBridgeThreadBumpedV2Handler","MAWBridgeThreadHiddenHandler","MAWBridgeThreadTimestampsHandler","MAWBridgeThreadUpdatedHandler","MAWBridgeThreadsLoadedHandler","MAWBridgeUIEventQPLLogger","MAWBridgeUIEventQueueQPLLogger","MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler","MAWBridgeUpdateClientRestoreStatus","MAWBridgeUpdateE2EEMetadataParticipantsHandler","MAWBridgeUpdateMessageRangeHandler","MAWBridgeUpdateMinMessageHandler","MAWBridgeXMAShareExpiredHandler","MAWBridgeXMAShareTombstonedHandler","MAWEphemeralMessageExpirationStorage","Promise","WAResultOrError","WATagsLogger","WATimeUtils","asyncToGeneratorRuntime","getErrorSafe","isArmadillo","isInstamadilloDYI","promiseDone","recoverableViolation","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Handle UI Events: ",""]);i=function(){return a};return a}var j=(f=c("requireDeferred"))("MAWBridgeDeleteMessagesOfThreadHandler").__setRef("MAWBridgeUIEventHandler"),k=f("MAWBridgeIssuePointQueryHandler").__setRef("MAWBridgeUIEventHandler"),l=f("MAWBridgeStartTraceHandler").__setRef("MAWBridgeUIEventHandler"),m=f("MAWBridgeStartTraceWithTraceIdHandler").__setRef("MAWBridgeUIEventHandler"),n=f("MAWBridgeTraceRecordCheckpointHandler").__setRef("MAWBridgeUIEventHandler"),o=f("MAWBridgeUpdateDyiStatus").__setRef("MAWBridgeUIEventHandler"),p=f("MAWBridgeUpdateTraceHandler").__setRef("MAWBridgeUIEventHandler"),q=f("MAWBridgeUploadMessageByBatchHandler").__setRef("MAWBridgeUIEventHandler"),r=f("MAWBridgeUploadMessageHandler").__setRef("MAWBridgeUIEventHandler");function s(a,e,f){switch(f.tag){case"NewMsg":return d("MAWBridgeNewMsgHandler").call(a,e,f.value);case"MsgsStartCountdown":return d("MAWBridgeMsgsStartCountdownHandler").call(e,f.value);case"MsgClearCountdown":return(h||(h=b("Promise"))).resolve(d("MAWEphemeralMessageExpirationStorage").clearMessageFromExpiration(f.value));case"DropAllSecureThreads":return d("MAWBridgeDropAllSecureThreadsHandler").call(e);case"VerifyThreadExists":var g=f.value;return d("MAWBridgeOccamadilloVerifyThreadExistsHandler").call(e,g);case"EditMsgHistoryAdded":return d("MAWBridgeEditMsgHistoryAddedHandler").call(a,e,f.value);case"MsgUpdated":return d("MAWBridgeMsgUpdatedHandler").call(a,e,f.value);case"NewMedia":return d("MAWBridgeNewMediaHandler").call(e,f.value);case"NewMediaRange":return d("MAWBridgeNewMediaRangeHandler").call(e,f.value);case"MediaExpired":return d("MAWBridgeMediaExpiredHandler").call(e,f.value);case"XMAShareExpired":return d("MAWBridgeXMAShareExpiredHandler").call(e,f.value);case"NewXMA":return d("MAWBridgeNewXMAHandler").call(e,f.value);case"XMAShareTombstoned":return d("MAWBridgeXMAShareTombstonedHandler").call(e,f.value);case"ParticipantUpdated":return d("MAWBridgeParticipantUpdatedHandler").call(e,f.value);case"ParticipantRemoved":return d("MAWBridgeParticipantRemovedHandler").call(e,f.value);case"UpdateE2EEMetadataParticipants":return d("MAWBridgeUpdateE2EEMetadataParticipantsHandler").call(e,f.value);case"ReceivedReceipt":return d("MAWBridgeReceivedReceiptHandler").call(e,f.value);case"ThreadUpdated":return d("MAWBridgeThreadUpdatedHandler").call(a,e,f.value);case"GroupInfoUpdated":return d("MAWBridgeGroupInfoUpdatedHandler").call(e,f.value);case"ThreadBumped":return d("MAWBridgeThreadBumpedHandler").call(a,e,f.value);case"ThreadBumpedV2":return d("MAWBridgeThreadBumpedV2Handler").call(a,e,f.value);case"ThreadsLoaded":return d("MAWBridgeThreadsLoadedHandler").call(e,f.value);case"ThreadTimestampsUpdated":return d("MAWBridgeThreadTimestampsHandler").call(e,f.value);case"MsgsLoaded":return d("MAWBridgeMsgsLoadedHandler").call(e,f.value);case"MsgRangeLoaded":return d("MAWBridgeMsgRangeLoadedHandler").call(e,f.value);case"StartTrace":return l.load().then(function(a){return a.call(e,f.value)});case"UpdateTrace":return p.load().then(function(a){return a.call(e,f.value)});case"ThreadHidden":return d("MAWBridgeThreadHiddenHandler").call(e,f.value);case"SyncContacts":return d("MAWBridgeSyncContacts").call(e,f.value);case"ReceivedChatState":return d("MAWBridgeReceivedChatStateHandler").call(e,f.value);case"ClockSkewUpdated":return(h||(h=b("Promise"))).resolve(d("WATimeUtils").setClockSkew(f.value));case"ABPropsUpdated":c("FBLogger")("messenger_e2ee_web").warn("[messenger_e2ee_web] ABPropsUpdated has been deprecated. Please use the bridge with ABPropsUpdated");return(h||(h=b("Promise"))).resolve(d("MAWAbPropsClient").rewrite(f.value));case"COPDigestReceived":return d("MAWBridgeHandleCOPDigest").call(e,f.value);case"UpsertReaction":return d("MAWBridgeReactionUpsertHandler").call(e,f.value);case"DeleteReaction":return d("MAWBridgeDeleteReactionHandler").call(e,f.value);case"UploadMessage":return r.load().then(function(a){return a.call(e,f.value)});case"UploadMessageByBatch":return q.load().then(function(a){return a.call(e,f.value)});case"DeleteMessagesOfThread":return j.load().then(function(a){return a.call(e,f.value)});case"UploadAttachment":return c("JSResourceForInteraction")("MAWBridgeUploadAttachmentHandler").__setRef("MAWBridgeUIEventHandler").load().then(function(a){return a.call(e,f.value)});case"ResignAttachmentCDNUrl":return c("JSResourceForInteraction")("MAWBridgeResignAttachmentCDNUrlHandler").__setRef("MAWBridgeUIEventHandler").load().then(function(a){return a.call(e,f.value)});case"DeleteMessages":return d("MAWBridgeDeleteMessagesHandler").call(e,f.value);case"RestoreMessageBatch":return c("JSResourceForInteraction")("MAWBridgeRestoreMessageBatchHandler").__setRef("MAWBridgeUIEventHandler").load().then(function(a){return a.call(e,f.value)});case"OneToOneMessageRequestLoaded":return d("MAWBridgeOneToOneMessageRequestLoadedHandler").call(e,f.value);case"GroupInviteUpdate":return d("MAWBridgeGroupInviteUpdateHandler").call(e,f.value);case"UpdateDyiStatus":return o.load().then(function(a){return a.call(e,f.value)});case"DeleteGroupInvite":return d("MAWBridgeDeleteGroupInviteHandler").call(e,f.value);case"TraceRecordCheckpoint":return n.load().then(function(a){return a.call(e,f.value)});case"DeleteMessageRangesV2":return d("MAWBridgeDeleteMessageRangesV2Handler").call(e,f.value);case"UpdateMinMessage":return d("MAWBridgeUpdateMinMessageHandler").call(e,f.value);case"IssuePointQuery":return k.load().then(function(a){return a.call(e,f.value)});case"ThreadBumpedServer":return d("MAWBridgeThreadBumpedServerHandler").call(e,f.value);case"ParticipantsUpdated":return d("MAWBridgeParticipantsUpdatedHandler").call(e,f.value);case"StartTraceWithTraceId":return m.load().then(function(a){return a.call(e,f.value)});case"UpdateClientRestoreStatus":return d("MAWBridgeUpdateClientRestoreStatus").call(e,f.value);case"NewMsgs":return d("MAWBridgeNewMsgHandler").bulkCall(a,e,f.value.msgs);case"UnArchivedSelfDeviceChangeAlerts":return d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler").call(e,f.value);case"EphemeralSettingsUpdatedForUI":return c("JSResourceForInteraction")("MAWBridgeEphemeralSettingsUpdatedForUIHandler").__setRef("MAWBridgeUIEventHandler").load().then(function(a){return a.call(e,f.value)});case"RavenActionUpdate":return d("MAWBridgeRavenActionMsgForUIHandler").call(e,f.value);case"GroupInviteLoaded":return d("MAWBridgeGroupInviteLoadedHandler").call(e,f.value);case"UpdateMessageRange":return d("MAWBridgeUpdateMessageRangeHandler").call(e,f.value);default:return(h||(h=b("Promise"))).resolve()}}function a(a,b){if(!c("isArmadillo")()&&!c("isInstamadilloDYI")()){c("recoverableViolation")("User is neither part of armadillo QE and dual send QE but somehow loaded this handler","messenger_web_product");return}if(!(b.length===1&&b[0].tag==="TraceRecordCheckpoint")){var e={};e=b.reduce(function(a,b){a[b.tag]=((b=a[b.tag])!=null?b:0)+1;return a},e);d("WATagsLogger").TAGS(["MAWBridgeUIEvent"]).LOG(i(),e)}c("promiseDone")(t(a,b))}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=(yield a);a=d("MAWBridgeUIEventQPLLogger").getInstanceKey();var g=e.map(function(a){return a.tag}),h="";d("MAWBridgeUIEventQueueQPLLogger").start(a,g);var i;try{i=(yield f.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){for(var g=0;g<e.length;g++){var i=e[g],j=d("MAWBridgeUIEventQPLLogger").getInstanceKey();d("MAWBridgeUIEventQPLLogger").start(j,i);try{yield s(f,b,i),d("MAWBridgeUIEventQPLLogger").endSuccess(j)}catch(b){var a=c("getErrorSafe")(b);h=i.tag;d("MAWBridgeUIEventQPLLogger").endFailure(j,i.tag);c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("[MAWBridgeUIEventHandler] Failed to handle UI event: %s",i.tag);return d("WAResultOrError").makeError(a)}}return d("WAResultOrError").makeResult(!0)});return function(b){return a.apply(this,arguments)}}(),"readwrite","background",{events:e,type:"maw_ui_bridge"}))}catch(a){var j=c("getErrorSafe")(a);c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("DbError handling UI events");i=d("WAResultOrError").makeError(j)}!i.success?(d("MAWBridgeUIEventQueueQPLLogger").endFailure(a,h),c("FBLogger")("messenger_e2ee_web").catching(i.error).mustfix("MAWBridgeUIEventHandler] Did not commit UI events to DB: %s",g.toString())):d("MAWBridgeUIEventQueueQPLLogger").endSuccess(a)});return u.apply(this,arguments)}function e(a,b,c){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=d("MAWBridgeUIEventQPLLogger").getInstanceKey();try{d("MAWBridgeUIEventQPLLogger").start(f,e),yield s(a,b,e),d("MAWBridgeUIEventQPLLogger").endSuccess(f)}catch(b){a=c("getErrorSafe")(b);d("MAWBridgeUIEventQPLLogger").endFailure(f,e.tag);c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("[handleShimEvent] Failed to handle UI event: %s",e.tag);throw b}});return v.apply(this,arguments)}g.handleEvents=a;g.handleShimEvent=e}),98);
__d("MAWCrossWorkerPortal",["FBLogger","WACrossWorkerPortal","pageID"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e){if(h!=null)return h;h=d("WACrossWorkerPortal").attachPortal(a,b,e,c("pageID"));return h}function b(){if(h==null){c("FBLogger")("messenger_e2ee_web").warn("Trying to kill portal before its setup");return}d("WACrossWorkerPortal").killPortalAndSendPendingToBridge(h)}g.getOrCreateCrossWorkerPortal=a;g.killPortalWhenWorkerTerminating=b}),98);
__d("WADevToolMessageChannel",[],(function(a,b,c,d,e,f){"use strict";var g=new MessageChannel(),h;a=function(){g=new MessageChannel();h(g);return g};b=function(){return g};c=function(a){h=a,h(g)};f.createNewChannel=a;f.getMostRecentChannel=b;f.onCreateNewChannel=c}),66);
__d("MAWCommonSetupBridge",["BrowserLockManager","CurrentUser","ErrorTransport","I64","LSDatabaseSingleton","LSIntEnum","LSMessagingThreadAttributionType","MAWBridge","MAWChatJid","MAWCrossWorkerPortal","MAWCurrentUser","MAWDbMedia","MAWEBSwitch","MAWExceededStorageQuota","MAWFrontendMediaUtils","MAWJobActionsV2","MAWMICSafe","MAWThreadCutover","MAWVault","MAWXMAUtils","MWLogSend","MultipleTabsLogger","ODS","Promise","QPLEvent","QPLUserFlow","URLMatcher","WACrossWorkerPortal","WADevToolMessageChannel","WADevToolsBridge","WAJids","cr:8689","err","gkx","justknobx","pageID","promiseDone","requireDeferred","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n=c("requireDeferred")("MAWMainThreadLogger").__setRef("MAWCommonSetupBridge"),o=new Set([25312111,25311870]),p=new Map(),q=new Map(),r=new Map([[(a=d("MAWDbMedia")).MEDIA_TYPE.IMAGE,8],[a.MEDIA_TYPE.VIDEO,10],[a.MEDIA_TYPE.GIF,6],[a.MEDIA_TYPE.STICKER,4],[a.MEDIA_TYPE.PTT,11],[a.MEDIA_TYPE.DOCUMENT_FILE,9]]),s=new Set([25312150,25313100,1056840931,25299294]);function t(a,b){return a+"_"+b}function u(a,b,c,d,e,f,g){if(a==="revokeMsg")return 26;if(e!=null)return e;if(c)return 3;if(d&&f===!1)return 13;if(g===!0)return 13;a=b!=null?r.get(b):null;return(e=a)!=null?e:0}function v(a,b,e){return(i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(f){return d("MAWThreadCutover").isCutoverSecureThreadFromChatJid(f,a).then(function(a){c("QPLUserFlow").addAnnotations(b,{bool:{is_cutover:a}},{instanceKey:e})})})}var w={fbErrorProxy:function(a){d("ErrorTransport").log(a)},log:function(a){var b=a.logLevel,c=a.logString,d=a.tags;switch(b){case"log":n.onReadyImmediately(function(a){a=a.info;return a(c,d)});return;case"warn":n.onReadyImmediately(function(a){a=a.warn;return a(c,d)});return;case"logRestricted":n.onReadyImmediately(function(a){a=a.logRestricted;return a(c,d)});return;case"debug":break;case"error":break;default:break}},logError:function(a){var b=a.entriesToReport,c=a.framesToPop,d=a.logString,e=a.message,f=a.stack,g=a.tags;n.onReadyImmediately(function(a){a=a.logError;return a(d,g,e,f,c,b)})},odsBumpEntityKey:function(a){var b=a.amount,e=a.entity;a=a.key;(j||(j=d("ODS"))).bumpEntityKey(3185,e,a+"."+(c("CurrentUser").getAppID()||"unknown"),b)},onJobFinished:function(a){a.type==="createGroup"&&a.originalArgs.key!=null&&d("MAWJobActionsV2").recentFinishedJobsCache.set(a.originalArgs.key,a.result);switch(a.type){case"sendMsg":case"sendMediaMsg":case"sendReactionMsg":case"sendXMAShareMsg":case"forwardMsg":var b=a.originalArgs.chatJid,e=a.type==="sendXMAShareMsg"?a.originalArgs.xmaMsgExternalId:a.originalArgs.externalId;p.set(t(b,e),babelHelpers["extends"]({},a.originalArgs,{type:"sendMsg"}));break;case"revokeMsgs":b=a.result;b.forEach(function(a){var b=a.deleting;a=a.original;p.set(t(b.chat,b.externalId),{chatJid:a.chat,externalId:a.externalId,type:"revokeMsg"})});break;case"sendAppData":e=a.originalArgs;var f=a.result;(b=e.args.contents.actions)==null?void 0:b.forEach(function(a){a=a.messageAction;if(a==null||a.type!=="delete_for_me"||f.type!=="not_sent")return;q.set(f.appDataExternalId,{chatJid:a.protocolMsgId.chat,externalId:a.protocolMsgId.externalId,type:"deleteMsgForMe"})});break}if(a.type==="sendWrittenMsg"){e=a.originalArgs.protocolMsgId;b=e.chat;e=e.externalId;b=t(b,e);var g=p.get(b);p["delete"](b);if(a.result.success&&g!=null){var h,j=g.type!=="revokeMsg"?e:g.externalId,m=g.args,n=g.chatJid;b=g.file;e=g.type;g=(m==null?void 0:m.reactToAuthor)!=null;var o=null;g&&(o=(m==null?void 0:m.reaction)!=null?20:27);g=(m==null?void 0:m.specialTextSize)!=null;b=b!=null?d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(b.type).mediaType:null;var r=(m==null?void 0:m.xmaMessageType)!=null,s=(m==null?void 0:m.quote)!=null||d("MAWXMAUtils").isXMAStoryReply(m==null?void 0:m.xmaMessageType);h=c("URLMatcher").match(d("MAWVault").unvault((h=m==null?void 0:m.content)!=null?h:""));h=h!=null&&h.length>0;var v=u(e,b,g,r,o,s,h),w=d("WAJids").switchOnMsgrChatJidType(n,{group:function(){return(k||(k=d("LSIntEnum"))).ofNumber(16)},user:function(){return(k||(k=d("LSIntEnum"))).ofNumber(15)}});c("promiseDone")((i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(a){var b=(m==null?void 0:m.source)!=null?m.source:(k||(k=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").UNKNOWN);c("promiseDone")(d("MAWChatJid").toThreadKey(a.tables,n).then(function(a){var e;if(c("justknobx")._("154")&&d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()&&(c("BrowserLockManager")!=null&&!d("MultipleTabsLogger").hasUniqueLock()))return;d("MWLogSend").log({actor:(l||(l=d("I64"))).of_string(d("MAWCurrentUser").getID()),attachmentFbids:[],attachmentType:v,backend:1,hasReply:s,initatingSource:m==null?void 0:m.initiatingSource,messagingThreadId:l.to_string(a),msgTtl:m==null?void 0:(e=m.ephemeralSetting)==null?void 0:e.ephemeralExpirationInSec,offlineThreadingId:j,sendType:1,source:b,threadKey:a,threadType:w})}))}))}}if(a.type==="sendWrittenAppData"){e=a.originalArgs.appDataExternalId;b=q.get(e);q["delete"](e);if(b!=null&&b.type==="deleteMsgForMe"&&a.result.type==="success"){var x=b.chatJid,y=b.externalId,z=d("WAJids").switchOnMsgrChatJidType(x,{group:function(){return(k||(k=d("LSIntEnum"))).ofNumber(16)},user:function(){return(k||(k=d("LSIntEnum"))).ofNumber(15)}});c("promiseDone")((i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(a){c("promiseDone")(d("MAWChatJid").toThreadKey(a.tables,x).then(function(a){d("MWLogSend").log({actor:(l||(l=d("I64"))).of_string(d("MAWCurrentUser").getID()),attachmentFbids:[],attachmentType:25,backend:1,hasReply:!1,messagingThreadId:l.to_string(a),offlineThreadingId:y,sendType:3,source:(k||(k=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").UNKNOWN),threadKey:a,threadType:z})}))}))}}},qplEvent:function(a){var e=a.action,f=a.annotations,g=a.debugInfo,i=a.error,j=a.event,k=a.instanceKey,l=a.timestamp;if(!c("CurrentUser").isEmployee()&&o.has((m||(m=d("QPLEvent"))).getMarkerId(j)))return;var n=k||0;k=f==null?void 0:(a=f.string)==null?void 0:a.jid;a=k!=null?d("WAJids").validateChatJid(k):void 0;k=s.has((m||(m=d("QPLEvent"))).getMarkerId(j))&&a!=null?v(a,j,n):(h||(h=b("Promise"))).resolve();switch(e.type){case"start":c("QPLUserFlow").start(j,{annotations:babelHelpers["extends"]({},f||{},{bool:babelHelpers["extends"]({},(f==null?void 0:f.bool)||{},{is_eb_enabled:c("MAWEBSwitch").isEnabled(),is_pdb:c("gkx")("24032"),isArmadilloPublicLaunchUser:c("gkx")("23405"),isDev:0,isDeviceRegistrationDomainUniquenessEnabled:c("gkx")("23969"),isGifSearchEnbled:c("gkx")("23997"),isM1M2OverrideUser:c("gkx")("24022"),isRestoreDBEnabled:c("gkx")("23906"),isSpillOverCAUser:c("gkx")("24023"),isSpillOverVNUser:c("gkx")("24024"),isTlcPublicUser:d("MAWCurrentUser").isTlcPublicUser(),useSharedWorker:d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()})}),instanceKey:n,timestamp:l});break;case"success":c("QPLUserFlow").addAnnotations(j,{bool:{exceededStorageQuota:d("MAWExceededStorageQuota").getExceededStorageQuota(),isRelaxedDurability:!0}},{instanceKey:n});k["finally"](function(){c("QPLUserFlow").endSuccess(j,{annotations:f,instanceKey:n,timestamp:l})});break;case"point":f&&c("QPLUserFlow").addAnnotations(j,f,{instanceKey:n});(m||(m=d("QPLEvent"))).getMarkerId(j)===1056839232?d("MAWMICSafe").markEvent(e.name,l):c("QPLUserFlow").addPoint(j,e.name,{instanceKey:n,timestamp:l});break;case"annotations":c("QPLUserFlow").addAnnotations(j,(a=f)!=null?a:{},{instanceKey:n});break;case"failure":c("QPLUserFlow").addAnnotations(j,{bool:{exceededStorageQuota:d("MAWExceededStorageQuota").getExceededStorageQuota(),isRelaxedDurability:!0}},{instanceKey:n});k["finally"](function(){c("QPLUserFlow").endFailure(j,e.name,{annotations:f,instanceKey:n,timestamp:l})});break;case"error":c("QPLUserFlow").markError(j,e.name,{debugInfo:g,error:i,instanceKey:n});break;default:throw c("err")("Bridge sends unreachable qplEvent action type")}}},x=function(a,b){a.push(b);return a};e=function(a){var e=a.customizeEventHandlers;a=a.worker;var f=d("MAWBridge").getBridge();f.setHandlers("event",babelHelpers["extends"]({},w,e));e=d("MAWCrossWorkerPortal").getOrCreateCrossWorkerPortal(f,["backend"],x);e.setPort(a);if(c("gkx")("3282")){var g=d("WADevToolsBridge").getDevToolBridge();a=new MessageChannel();var i=d("WACrossWorkerPortal").attachPortal(g,["backend"],x,c("pageID")),j=d("WACrossWorkerPortal").attachPortal(g,["devtool"],x,c("pageID"));d("WADevToolMessageChannel").onCreateNewChannel(function(a){i.setPort(a.port1)});j.setPort(a.port1);b("cr:8689")==null?void 0:b("cr:8689").connectAddonPort(a.port2);e.addListener(function(a,b){return g.fireAndForget("devtool","bridgeMessage",{direction:b==="outgoing"?"toWorker":"toMain",msg:a,ts:Date.now()},!0)})}return(h||(h=b("Promise"))).resolve(f)};g.initBridge=e}),98);
__d("toMsgrUserJid",["MAWJids"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=d("MAWJids").toUserJid}),98);
__d("MAWFetchContacts",["I64","LSContactTypeExact","LSIntEnum","MAWContactRelationshipType","ReQL","WAJids","asyncToGeneratorRuntime","requireDeferred","toMsgrUserJid"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("MAWFetchContacts");function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield j.load());b=(yield b());var e=new Set(a.map(function(a){return d("WAJids").extractUserId(a)}));return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(b.table("contacts")).filter(function(a){return e.has((h||(h=d("I64"))).to_string(a.id))})).then(function(a){return new Map(a.map(function(a){return[c("toMsgrUserJid")((h||(h=d("I64"))).to_string(a.id)),a]}))})});return l.apply(this,arguments)}function a(a){return k(a).then(function(a){var b=new Map();a.forEach(function(a,c){b.set(c,d("MAWContactRelationshipType").getContactRelationshipType(a))});return b})}function e(a){return k(a).then(function(a){var b=new Map();a.forEach(function(a,e){a=a.contactTypeExact!=null&&(h||(h=d("I64"))).equal(a.contactTypeExact,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactTypeExact").MESSENGER_ONLY_NOT_ALLOWED_ON_FB));b.set(e,a)});return b})}g.fetchContacts=k;g.fetchContactsRelationships=a;g.fetchContactsIsMsplit=e}),98);
__d("MAWSetupBridgeOfflineSnapshot",["InteractionTracingMetrics","MAWMIC","MWChatInteraction","WAOfflineUtils","WATagsLogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["WA infra offline connection lost"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stats end: "," / ",", messages: "," / ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Progress: "," / ",", messages: "," / ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stats start: ",", messages: ",""]);k=function(){return a};return a}var l=d("WATagsLogger").TAGS(["ServerRPC","Offline"]);function m(a){d("MAWMIC").addIntAnnotation("offlineQueueSize",a);var b=d("MWChatInteraction").get(d("MWChatInteraction").MW_AUTO_CHAT_TAB_OPEN);b!=null&&c("InteractionTracingMetrics").addAnnotationInt(b,"offlineQueueSize",a)}a=function(a){return function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b.downloaded,e=b.expected,f=b.status;b=b.timestamp;switch(f){case d("WAOfflineUtils").WAClientInfraOfflineProgress.Initializing:l.LOG(k(),e.count,e.message);m(e.count);a({tag:"InitOfflineQueueSyncStart",value:e.count});d("MAWMIC").markEvent("worker_download_offline_queue_start",b);return;case d("WAOfflineUtils").WAClientInfraOfflineProgress.Processing:l.LOG(j(),c.count,e.count,c.message,e.message);a({tag:"InitOfflineQueueSyncProgress",value:c.count});return;case d("WAOfflineUtils").WAClientInfraOfflineProgress.Complete:l.LOG(i(),c.count,e.count,c.message,e.message);d("MAWMIC").addIntAnnotation("offlineQueueDownloadedCount",c.count);a({tag:"InitOfflineQueueSyncProgress",value:e.count});d("MAWMIC").markEvent("worker_download_offline_queue_end",b);return;case d("WAOfflineUtils").WAClientInfraOfflineProgress.Failed:l.LOG(h());d("MAWMIC").markEvent("worker_download_offline_queue_connection_lost",b);return}});return function(a){return c.apply(this,arguments)}}()};e=a;g["default"]=e}),98);
__d("MAWSetupBridge",["LSDatabaseSingleton","LSInitSyncCompleteSubscription","MAWAbPropsClient","MAWBridgeReceivedChatStateHandler","MAWBridgeUIEventHandler","MAWCommonSetupBridge","MAWEncryptionErrorHandler","MAWExceededStorageQuota","MAWFetchContacts","MAWGetEphemeralSettings","MAWSetupBridgeOfflineConsumer","MAWSetupBridgeOfflineSnapshot","Run","Visibility","asyncToGeneratorRuntime","cr:3411","cr:5889","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("ArmadilloCutoverClientFalcoEvent").__setRef("MAWSetupBridge"),j=c("requireDeferred")("MAWBridgeUpdateDYIStatusV2").__setRef("MAWSetupBridge"),k=(h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(d("LSInitSyncCompleteSubscription").use).then(function(){return(h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton}),l=function(a){i.loadImmediately(function(b){b=b.log;return b(function(){return{armadillo_thread_id:a.armadilloThreadId,domain:a.domain,event:a.event,event_details:a.eventDetails,open_thread_id:a.openThreadId,success:a.success,trace_id:a.traceId}})})};function a(a){var e=a.dispatch,f=a.logout,g=a.reregisterDevice,h=a.rotateCryptoAuthToken,i=a.worker;function m(){i.postMessage({type:"force-flush-data"})}d("Run").onUnload(m);d("Run").onBeforeUnload(m,!1);c("Visibility").addListener(c("Visibility").HIDDEN,function(){i.postMessage({type:"force-flush-logs-only"})});return d("MAWCommonSetupBridge").initBridge({customizeEventHandlers:{abPropsUpdated:function(a){d("MAWAbPropsClient").rewrite(a.abProps)},earDecryptionFailure:function(a){d("MAWEncryptionErrorHandler").deleteAllDbs(a.tableName)},getLSDBEphemeralSetting:function(a){return d("MAWGetEphemeralSettings").getEphemeralSetting(a.chatJid)},getLSDBUsersIsMsplit:function(a){return d("MAWFetchContacts").fetchContactsIsMsplit(a.users)},getLSDBUsersRelationships:function(a){return d("MAWFetchContacts").fetchContactsRelationships(a.users)},logCutoverEvent:l,logout:f,offlineConsumerProgress:function(){return c("MAWSetupBridgeOfflineConsumer")(k,e).apply(void 0,arguments)},offlineSnapshot:c("MAWSetupBridgeOfflineSnapshot")(e),receivedChatState:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield k);yield b.runInTransaction(function(b){return d("MAWBridgeReceivedChatStateHandler").call(b,a)},"readwrite")});function c(b){return a.apply(this,arguments)}return c}(),relayUpdate:function(a){b("cr:5889")==null?void 0:b("cr:5889").handleUpdateFromWorker(a)},reregisterDevice:g,rotateCryptoAuthToken:h,storageQuota:function(a){a=a.exceededStorageQuota;d("MAWExceededStorageQuota").setExceededStorageQuota(a)},uiUpdate:function(a){a=a.events;e&&a.forEach(function(a){return e(a)});b("cr:3411")==null?void 0:b("cr:3411").recordBridgeUIEvent(a);d("MAWBridgeUIEventHandler").handleEvents(k,a)},updateDYIStatus:function(a){var b=a.qplInstanceKeyE2E,d=a.status;c("promiseDone")(j.load().then(function(a){return a.call({qplInstanceKeyE2E:b,status:d})}))}},worker:i})}g.setupBridge=a}),98);
__d("MAWClientConsistencyRefresh",["ClientConsistencyEventEmitter","CurrentUser"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(c("CurrentUser").getAppID()){case 772021112871879:c("ClientConsistencyEventEmitter").emit("hardRefresh",a);break;default:c("ClientConsistencyEventEmitter").emit("softRefresh",a)}}g["default"]=a}),98);
__d("MAWInit",["ExecutionEnvironment","MAWCurrentUser","MAWEBSwitch","MAWGetStorageQplAnnotations","MAWMIC","QPLUserFlow","QuickPerformanceLogger","UserTimingUtils","WALogger","asyncToGeneratorRuntime","gkx","performanceNow","qpl","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to get storage info"]);k=function(){return a};return a}var l=c("qpl")._(25310776,"6155"),m=!1,n=[],o=[],p=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this,a)||this;c.error=null;c.name="MAWInitError";c.message=a;c.error=null;return c}var c=a.prototype;c.catching=function(a){this.error=a;return this};return a}(babelHelpers.wrapNativeSuper(Error)),q=!1;function r(){if(q)return;q=!0;c("QPLUserFlow").addAnnotations(l,{bool:{armadillo_init_sync_api_improvements:c("gkx")("24025"),is_eb_enabled:c("MAWEBSwitch").isEnabled(),isArmadilloPublicLaunchUser:c("gkx")("23405"),isTlcPublicUser:d("MAWCurrentUser").isTlcPublicUser(),useSharedWorker:d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()}})}var s=!1;function a(){if(s)return;d("MAWMIC").markEvent("maw_init_start");s=!0;c("QPLUserFlow").start(l,{annotations:{string:{hostname:window.location.hostname}},cancelOnUnload:!0,onFlowTimeout:function(){m=!0,d("MAWMIC").addStringAnnotation("mawInitFailReason","timeout")},timeoutInMs:(h||(h=c("ExecutionEnvironment"))).canUseDOM?6e4:0});void d("MAWGetStorageQplAnnotations").getStorageQplAnnotations().then(function(a){c("QPLUserFlow").addAnnotations(l,a)})["catch"](function(){d("WALogger").ERROR(k())});r();n.forEach(function(a){return a()});o.forEach(function(a){return a()});n.splice(0,n.length);o.splice(0,o.length)}function t(a,b){if(!s||m){if(!s&&(b==null?void 0:b.allowEarlyLogPoints)){var d=(i||(i=c("QuickPerformanceLogger"))).currentTimestamp();o.push(function(){c("QPLUserFlow").addPoint(l,a,{timestamp:d})})}return}r();c("QPLUserFlow").addPoint(l,a)}function e(a,b,d){if(!s||m){!s&&(d==null?void 0:d.allowEarlyAnnotations)&&n.push(function(){var d;c("QPLUserFlow").addAnnotations(l,{bool:(d={},d[a]=b,d)})});return}c("QPLUserFlow").addAnnotations(l,{bool:(d={},d[a]=b,d)})}function f(a,b,d){if(!s||m){!s&&(d==null?void 0:d.allowEarlyAnnotations)&&n.push(function(){var d;c("QPLUserFlow").addAnnotations(l,{string:(d={},d[a]=b,d)})});return}c("QPLUserFlow").addAnnotations(l,{string:(d={},d[a]=b,d)})}function u(a,b,d){if(!s||m){!s&&(d==null?void 0:d.allowEarlyAnnotations)&&n.push(function(){var d;c("QPLUserFlow").addAnnotations(l,{"int":(d={},d[a]=b,d)})});return}c("QPLUserFlow").addAnnotations(l,{"int":(d={},d[a]=b,d)})}function v(a,b){r(),m=!0,c("QPLUserFlow").addAnnotations(l,{string:{failReason:a}}),c("QPLUserFlow").endFailure(l,"maw_init_fail",{error:b}),q=!1,d("MAWMIC").addStringAnnotation("mawInitFailReason",a),d("MAWMIC").fail("maw_init_failure",b)}function w(a,b){r(),m=!0,c("QPLUserFlow").addAnnotations(l,{string:{cancelReason:a}}),b&&c("QPLUserFlow").markError(l,"maw_init_cancel_with_error",{error:b}),c("QPLUserFlow").endCancel(l),q=!1,d("MAWMIC").addStringAnnotation("mawInitCancelReason",a),d("MAWMIC").cancel("maw_init_cancel",b)}function x(a){if(m)return;r();m=!0;q=!1;d("MAWMIC").addStringAnnotation("mawInitDropReason",a);(i||(i=c("QuickPerformanceLogger"))).markerDrop(l)}function y(){r(),m=!0,c("QPLUserFlow").endSuccess(l),d("MAWMIC").markEvent("maw_init_end"),q=!1}function z(a,b){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(j||(j=c("performanceNow")))(),f=a+"_start",g=a+"_end";t(f);f=(yield b());t(g);c("gkx")("24026")&&d("UserTimingUtils").measureModern(a,{end:(j||(j=c("performanceNow")))(),start:e});return f});return A.apply(this,arguments)}e={addBoolAnnotation:e,addIntAnnotation:u,addStringAnnotation:f,cancel:w,drop:x,endSuccess:y,fail:v,logPoint:t,measurePerformance:z,start:a};g.MAWInitError=p;g.MAWInit=e}),98);
__d("SharedWorkerDevChangeManager",["gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=!1,i=new Set();function a(a,b){var c=b.storageWorkerResource;b=b.tabResource;if(!h)return!0;if(i.has(a))return!0;if(new URLSearchParams(window.location.search).has("force_shared_worker_updates"))return!1;if(c.version===2&&b.version===2&&c.sandboxOnlyChecksum!=null)return c.sandboxOnlyChecksum===b.sandboxOnlyChecksum;return c.version===2&&c.rsrcBundleUrl==null||b.version===2&&b.getJSModuleBundleResource().url==null?!1:c.rsrcBundleUrl===b.getJSModuleBundleResource().url}function b(a){h&&i.add(a)}g.shouldUseStorageWorkerForDev=a;g.trackCreatedWorker=b}),98);
__d("SharedWorkerEventManager",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){a.port.addEventListener("message",function(a){var d;if(typeof a.data==="object"&&((d=a.data)==null?void 0:d.type)==="console"&&typeof ((d=a.data)==null?void 0:d.response)==="object"&&((d=a.data)==null?void 0:d.response)!=null){d=a.data.response;a=d.method;d=d.args;if(typeof a!=="string"||!["log","error","info","debug","warn"].includes(a)){c("FBLogger")("worker").mustfix("Unexpected console method: %s",String(a));return}if(!Array.isArray(d)){c("FBLogger")("worker").mustfix('Expected console args "%s" to be an array',JSON.stringify(d));return}b({method:a,args:d})}})}function b(a,b){a.port.addEventListener("message",function(a){var c;if(typeof a.data==="object"&&((c=a.data)==null?void 0:c.type)==="sw-uncaught-error"){a=typeof ((c=a.data)==null?void 0:c.e)==="object"?(c=a.data.e)!=null?c:{}:{};c=a.error;var d=a.lineno,e=a.colno,f=a.filename;a=a.message;b({error:c instanceof Error?c:null,errorObject:{lineno:typeof d==="number"?d:null,colno:typeof e==="number"?e:null,filename:typeof f==="string"?f:null,message:typeof a==="string"?a:null}})}})}function d(a,b,d){a.port.addEventListener("message",function(a){var e;if(typeof a.data==="object"&&((e=a.data)==null?void 0:e.type)==="sw-get-rev"&&typeof a.data.response==="object"){b==null?void 0:b.markPoint("get_worker_rev_ack_received");a=typeof a.data==="object"&&typeof ((e=a.data)==null?void 0:e.response)==="object"?(e=a.data)==null?void 0:e.response:{};e=a==null?void 0:a.workerRevision;a=a==null?void 0:a.spinTime;if(e==null||typeof e!=="number"){b==null?void 0:b.addAnnotations({string:{malformedData:"rev is non-number"}});c("FBLogger")("worker").mustfix("Expected worker rev to be non-null number, but instead received: %s",String(e));return}if(a==null||typeof a!=="number"){b==null?void 0:b.addAnnotations({string:{malformedData:"spin_time is non-number"}});c("FBLogger")("worker").mustfix("Expected worker spin time to be non-null number, but instead received: %s",String(a));return}d({rev:e,spinTime:a})}})}function e(a,b,c){var d=function d(e){var f;if(typeof e.data==="object"&&((f=e.data)==null?void 0:f.type)==="sw-shutdown"&&typeof e.data.response==="object"){var g,h;f=typeof ((f=e.data.response)==null?void 0:f.reason)==="string"?(f=e.data.response)==null?void 0:f.reason:null;g=typeof ((g=e.data.response)==null?void 0:g.workerID)==="string"?(g=e.data.response)==null?void 0:g.workerID:null;e=typeof ((h=e.data.response)==null?void 0:h.isInitialized)==="boolean"?(h=e.data.response)==null?void 0:h.isInitialized:null;b({reason:f,workerID:g,isInitialized:e});(c==null?void 0:c.once)===!0&&a.port.removeEventListener("message",d)}};a.port.addEventListener("message",d);return function(){return a.port.removeEventListener("message",d)}}function f(a,b){a.port.addEventListener("message",function(a){var c;typeof a.data==="object"&&((c=a.data)==null?void 0:c.type)==="sw-uptime-tracking"&&typeof ((c=a.data)==null?void 0:c.response)==="object"&&typeof ((c=a.data)==null?void 0:(c=c.response)==null?void 0:c.trackerID)==="number"&&b({trackerID:a.data.response.trackerID})})}function h(a,b,d){var e=function(a){var e;if(typeof a.data==="object"&&((e=a.data)==null?void 0:e.type)==="execute-worker-ack"&&typeof ((e=a.data)==null?void 0:e.response)==="object"){b==null?void 0:b.markPoint("execute_worker_ack_received");e=typeof a.data==="object"&&typeof ((e=a.data)==null?void 0:e.response)==="object"?(a=(e=a.data)==null?void 0:e.response)!=null?a:{}:{};a=e.workerRevision;var f=e.spinMode,g=e.spinTime,h=e.firstInit;e=e.errorGettingSiteData;if(typeof h!=="boolean"){b==null?void 0:b.addAnnotations({string:{malformedData:"firstInit is non-boolean"}});c("FBLogger")("worker").mustfix("Expected firstInit to be a boolean, but instead received: %s",String(h));return}if(typeof e==="string")return d({err:e,isFirstInit:h});if(typeof a==="number"&&typeof f==="number"&&typeof g==="number")return d({workerRev:a,workerSpinTime:g,workerSpinMode:f,isFirstInit:h});else b==null?void 0:b.addAnnotations({string:{malformedData:"workerRevision, spinMode, and/or spinTime are non-numbers"}}),c("FBLogger")("worker").mustfix("Expected workerRevision, spinMode, and spinTime to be non-null number, but instead received: %s %s %s",String(a),String(f),String(g))}};a.port.addEventListener("message",e);return function(){return a.port.removeEventListener("message",e)}}function i(a,b,d,e){var f=function f(g){var h;if(typeof g.data==="object"&&((h=g.data)==null?void 0:h.type)==="execute-worker-imports"&&typeof ((h=g.data)==null?void 0:h.response)==="object"){(e==null?void 0:e.once)===!0&&a.port.removeEventListener("message",f);b==null?void 0:b.markPoint("bundle_imports_ack");h=typeof g.data==="object"&&typeof ((h=g.data)==null?void 0:h.response)==="object"?(g=(h=g.data)==null?void 0:h.response)!=null?g:{}:{};g=h.err;h=h.attempts;if(g!=null&&typeof g!=="string"){b==null?void 0:b.addAnnotations({string:{malformedData:"err is neither null or a string"}});c("FBLogger")("worker").mustfix("Expected err to be null or a string, but instead receieved: %s",String(g));return}if(h!=null&&typeof h!=="number"){b==null?void 0:b.addAnnotations({string:{malformedData:"attempts is neither null or a number"}});c("FBLogger")("worker").mustfix("Expected attempts to be a number or null, but instead receieved: %s",String(h));return}d({err:g,attempts:h})}};a.port.addEventListener("message",f);return function(){return a.port.removeEventListener("message",f)}}function j(a,b,d){a.port.addEventListener("message",function(a){var e;if(typeof a.data==="object"&&((e=a.data)==null?void 0:e.type)==="ww-hrp-init"){b==null?void 0:b.markPoint("hrp_init_ack_received");e=typeof a.data==="object"&&typeof ((e=a.data)==null?void 0:e.response)==="object"?(a=(e=a.data)==null?void 0:e.response)!=null?a:{}:{};a=e.err;if(a!=null&&typeof a!=="string"){b==null?void 0:b.addAnnotations({string:{malformedData:"err is neither null or a string"}});c("FBLogger")("worker").mustfix("Expected err to be null or a string, but instead receieved: %s",String(a));return}d({err:a})}})}function k(a,b){a.port.addEventListener("message",function(a){var c;if(typeof a.data==="object"&&((c=a.data)==null?void 0:c.type)==="worker-init-mark"&&typeof ((c=a.data)==null?void 0:c.response)==="object"&&typeof ((c=a.data)==null?void 0:(c=c.response)==null?void 0:c.point)==="string"){b((c=a.data)==null?void 0:(a=c.response)==null?void 0:a.point)}})}function l(a,b,c){var d=function d(e){var f;if(typeof e.data==="object"&&((f=e.data)==null?void 0:f.type)==="self-terminate"&&typeof ((f=e.data)==null?void 0:f.response)==="object"&&typeof ((f=e.data)==null?void 0:(f=f.response)==null?void 0:f.from)==="string"){f=(f=e.data)==null?void 0:(e=f.response)==null?void 0:e.from;(c==null?void 0:c.once)===!0&&a.port.removeEventListener("message",d);b(f)}};a.port.addEventListener("message",d);return function(){return a.port.removeEventListener("message",d)}}function m(a,b){b=(b=b)!=null?b:{};var c=b.reason;b=b.upgrade;a.port.postMessage({type:"sw-shutdown",args:[{reason:c,upgrade:b}]})}function n(a){a.port.postMessage({type:"sw-get-rev",args:[]})}function o(a,b){b=(b=b)!=null?b:{};var c=b.jsModuleResource;b=b.isDev;a.port.postMessage({type:"execute-worker",args:[(a=c)!=null?a:{},b]})}function p(a,b){var c=function(a){var c;if(typeof a.data==="object"&&((c=a.data)==null?void 0:c.type)==="connection-ack"&&typeof ((c=a.data)==null?void 0:c.response)==="object"&&typeof ((c=a.data)==null?void 0:(c=c.response)==null?void 0:c.from)==="string"){c=typeof ((c=a.data)==null?void 0:(c=c.response)==null?void 0:c.workerID)==="string"?(c=a.data)==null?void 0:(c=c.response)==null?void 0:c.workerID:void 0;b((a=a.data)==null?void 0:(a=a.response)==null?void 0:a.from,c)}};a.port.addEventListener("message",c);return function(){return a.port.removeEventListener("message",c)}}function q(a,b){var c=b.isDev,d=b.hrp;b=b.js_env;a.port.postMessage({type:"ww-hrp-init",hrp:d,is_dev:c,js_env:b})}function r(a,b){b=b.trackerID;a.port.postMessage({type:"sw-uptime-tracking",args:{trackerID:b}})}g.registerLogFowardingListener=a;g.registerUncaughtErrorForwardingListener=b;g.registerGetWorkerRevListener=d;g.registerWorkerShutdownListener=e;g.registerUptimeTrackerListener=f;g.registerExecuteWorkerAckListener=h;g.registerExecuteWorkerImportsListener=i;g.registerHrpInitListener=j;g.registerWorkerInitPointsListener=k;g.registerWorkerSelfTerminationListener=l;g.emitWorkerShutdown=m;g.emitGetRev=n;g.emitExecuteWorker=o;g.registerConnectionAckListener=p;g.emitHrpInit=q;g.emitUptimeTracking=r}),98);
__d("SharedWorkerLockManager",["Deferred","FBLogger","WebStorageLockManager","emptyFunction","pageID","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h="shared_worker_mutex",i=6e4;function j(){var a;a=(a=window)==null?void 0:(a=a.navigator)==null?void 0:a.locks;if(a!=null)return a;var b=d("WebStorageLockManager").make(c("pageID"));return b!=null?{request:function(a,c){return b.request(a,c)}}:null}function k(a,b,d){c("setTimeout")(function(){a.isSettled()||(b==null?void 0:b.markPoint("lock_timeout"),c("FBLogger")("worker").warn("[SharedWorkerLockManager]: lock timed out in %s ms",i),a.resolve(),d==null?void 0:d())},i)}function l(){return self.LockManager!=null&&self.navigator.locks instanceof self.LockManager}function a(a,b){var d=b.workerQPLLogger,e=b.onLockTimeout;b=j();d==null?void 0:d.addAnnotations({bool:{native_locks:b!=null?l():null}});if(b==null){c("FBLogger")("worker").warn("Unable to initialize lock manager");a(c("emptyFunction"));return}var f=new(c("Deferred"))();c("promiseDone")(b.request(h,function(){d==null?void 0:d.markPoint("lock_obtained");k(f,d,e);a(function(){d==null?void 0:d.markPoint("lock_released"),f.resolve()});return f.getPromise()}))}g.supportsNativeWebLock=l;g.withWorkerLock=a}),98);
__d("validateSharedWorkerReference",["ConstUriUtils","isRelativeURL","isSameOrigin","memoize"],(function(a,b,c,d,e,f,g){"use strict";var h=c("memoize")(function(){return d("ConstUriUtils").getUri(window.location.href)});function i(a){var b=h(),e=d("ConstUriUtils").getUri(a);e=b!=null&&e!=null?c("isSameOrigin")(e,b):!1;return e||c("isRelativeURL")(a)}function a(a){if(a==null||typeof a!=="object")return null;var b=a.rev,c=a.spin_time,d=a.url,e=a.version,f=a.rsrcBundleUrl;a=a.sandboxOnlyChecksum;return typeof b!=="number"||typeof c!=="number"||e!=null&&e!==1&&e!==2||!Number.isInteger(b)||!Number.isInteger(c)||typeof d!=="string"||!i(d)||f!=null&&typeof f!=="string"||a!=null&&typeof a!=="string"?null:{rev:b,spin_time:c,url:d,version:(b=e)!=null?b:1,rsrcBundleUrl:f,sandboxOnlyChecksum:a}}g["default"]=a}),98);
__d("SharedWorkerStorageManager",["Deferred","FBLogger","Promise","WebAsyncStorage","validateSharedWorkerReference"],(function(a,b,c,d,e,f,g){"use strict";var h,i="__swbundle__",j={};function k(a){return""+i+a}function l(a){var b=new(c("Deferred"))();c("WebAsyncStorage").removeItem(k(a),function(c){if(c)return b.reject(c);j[a]=null;b.resolve()});return b.getPromise()}function m(a,b){var d=new(c("Deferred"))();c("WebAsyncStorage").setItem(k(a),b,function(c){if(c!=null)return d.reject(c);j[a]=b;d.resolve()});return d.getPromise()}function n(a){var b=new(c("Deferred"))();c("WebAsyncStorage").getItem(k(a),function(c,d){if(c)return b.reject(c);j[a]=d;b.resolve(d)});return b.getPromise()}function a(){return j}function d(a){return n(a).then(function(a){a=c("validateSharedWorkerReference")(a);return a==null?null:a})}function e(a){return l(a)}function f(a,d){var e=c("validateSharedWorkerReference")(d);if(e==null){c("FBLogger")("worker").mustfix('Failed to save worker reference for bundle "%s". Invalid reference: %s',a,JSON.stringify(d));return(h||(h=b("Promise"))).resolve()}return m(a,e)}g.SHARED_WORKER_STORAGE_KEY_BASE=i;g.getDebugState=a;g.getSharedWorkerReference=d;g.removeSharedWorkerReference=e;g.saveSharedWorkerReference=f}),98);
__d("SharedWorkerUptimeTracker",["FBLogger","ODS","SharedWorkerEventManager","clearInterval","performanceNow","setInterval","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=1e4,k=45e3,l=new Map();function m(a){return Math.floor(((i||(i=c("performanceNow")))()-a)/1e3)}function n(a,b){var e=0,f={};d("SharedWorkerEventManager").registerUptimeTrackerListener(a,function(a){a=a.trackerID;var c=f[a];if(c==null)return;(h||(h=d("ODS"))).bumpFraction(6653,"shared_worker_infra","worker_uptime."+b,1,0);h.bumpEntityKey(6653,"shared_worker_infra","worker_uptime_elapsed_time_to_response_sec."+m(c.createdMs)+"."+b);delete f[a]});return c("setInterval")(function(){var g=e++;c("setTimeout")(function(){var a=f[g];if(a==null)return;delete f[g]},k);f[g]={createdMs:(i||(i=c("performanceNow")))()};(h||(h=d("ODS"))).bumpFraction(6653,"shared_worker_infra","worker_uptime."+b,0,1);d("SharedWorkerEventManager").emitUptimeTracking(a,{trackerID:g})},j)}function a(a,b){if(l.has(b)){c("FBLogger")("worker").mustfix('Uptime tracking for worker "%s" already started.',b);return}l.set(b,{intervalID:n(a,b)})}function b(a){var b=l.get(a);b!=null&&(c("clearInterval")(b.intervalID),l["delete"](a))}g.startUptimeTracking=a;g.stopUptimeTracking=b}),98);
__d("XCometFBMultiSiteWebWorkerV2HasteResponseControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/static_resources/webworker/rsrc/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("WebWorkerV2DynamicData",["Promise","XCometFBMultiSiteWebWorkerV2HasteResponseControllerRouteBuilder","cometAsyncFetchShared","err","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Map();function a(a){var b=a.name,c=i.get(b);c==null&&(c=j(a),i.set(b,c));return c}function j(a){var d=a.name,e=a.v2HasteResponsePreloader;if(e==null)return k(d);var f=null;a=new(h||(h=b("Promise")))(function(a,b){e.onLoaded(function(b){b=b.data;f=b;a(b)}).onError(b)});return h.race([a,new h(function(a,b){window.setTimeout(function(){f==null?c("promiseDone")(k(d),a,b):a(f)},1e4)})])}function k(a){return c("cometAsyncFetchShared")(c("XCometFBMultiSiteWebWorkerV2HasteResponseControllerRouteBuilder").buildUri({worker_module:a}).toString(),{data:{},getFullPayload:!0,method:"POST",skipSRState:!0}).then(function(b){if(b!=null&&typeof b==="object"&&Object.prototype.hasOwnProperty.call(b,"hrp")&&typeof b.hrp==="object")return b;throw c("err")("Unexpected data from WorkerInitResourceDeliveryController for worker %s",a)})}g.readDynamicDataForWorker=a}),98);
__d("buildSharedWorkerInitQPLLogger",["QPLUserFlow","SiteData","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=c("qpl")._(931595918,"2062"),i=0;function a(a){var b=!1,d=!1,e=i++;function f(f){var g=f.version,i=f.workerName,j=f.callReason;f=f.supportsIDB;if(b||d)return;b=!0;g={"int":{version:g,clientRev:c("SiteData").client_revision},bool:{isDev:!1,supportsIDB:f},string:{workerName:i,hostname:window.location.hostname,callReason:j,pageID:c("pageID")}};c("QPLUserFlow").start(h,{onFlowTimeout:function(){c("QPLUserFlow").addAnnotations(h,{bool:{setupTimeout:!0}},{instanceKey:e}),d=!0},cancelOnUnload:!0,annotations:g,timeoutInMs:6e4,instanceKey:e});a==null?void 0:a({type:"start",data:{annotations:g}})}function g(f,g){if(!b||d)return;f=f+"_start";c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function j(f,g){if(!b||d)return;f=f+"_end";c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function k(f,g){if(!b||d)return;c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function l(f){if(!b||d)return;c("QPLUserFlow").endSuccess(h,{annotations:f,instanceKey:e});a==null?void 0:a({type:"end",data:{annotations:f}});d=!0}function m(f,g){if(!b||d)return;c("QPLUserFlow").endFailure(h,f,{annotations:g,instanceKey:e});a==null?void 0:a({type:"end",data:{errorName:f,annotations:g}});d=!0}function n(f){if(!b||d)return;c("QPLUserFlow").addAnnotations(h,f,{instanceKey:e});a==null?void 0:a({type:"annotate",data:{annotations:f}})}return{start:f,endFailure:m,addAnnotations:n,endSuccess:l,markEventStart:g,markEventEnd:j,markPoint:k}}g["default"]=a}),98);
__d("buildSharedWorkerTerminateQPLLogger",["QPLUserFlow","SiteData","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=c("qpl")._(931600201,"1438"),i=0;function a(a){var b=!1,d=!1,e=i++;function f(f){var g=f.workerName;f=f.callReason;if(b||d)return;b=!0;g={"int":{clientRev:c("SiteData").client_revision},bool:{isDev:!1},string:{workerName:g,hostname:window.location.hostname,callReason:f,pageID:c("pageID")}};c("QPLUserFlow").start(h,{onFlowTimeout:function(){c("QPLUserFlow").addAnnotations(h,{bool:{setupTimeout:!0}},{instanceKey:e}),d=!0},cancelOnUnload:!0,annotations:g,timeoutInMs:3e4,instanceKey:e});a==null?void 0:a({type:"start",data:{annotations:g}})}function g(f,g){if(!b||d)return;f=f+"_start";c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function j(f,g){if(!b||d)return;f=f+"_end";c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function k(f,g){if(!b||d)return;c("QPLUserFlow").addPoint(h,f,{data:g,instanceKey:e});a==null?void 0:a({type:"point",data:{annotations:g,event:f}})}function l(f){if(!b||d)return;c("QPLUserFlow").endSuccess(h,{annotations:f,instanceKey:e});a==null?void 0:a({type:"end",data:{annotations:f}});d=!0}function m(f,g){if(!b||d)return;c("QPLUserFlow").endFailure(h,f,{annotations:g,instanceKey:e});a==null?void 0:a({type:"end",data:{errorName:f,annotations:g}});d=!0}function n(f){if(!b||d)return;c("QPLUserFlow").addAnnotations(h,f,{instanceKey:e});a==null?void 0:a({type:"annotate",data:{annotations:f}})}return{start:f,endFailure:m,addAnnotations:n,endSuccess:l,markEventStart:g,markEventEnd:j,markPoint:k}}g["default"]=a}),98);
__d("checkForIndexedDbSupported",[],(function(a,b,c,d,e,f){"use strict";function a(){return!window.indexedDB?!1:!0}f["default"]=a}),66);
__d("XCometFBMultiSiteSharedWorkerStaticInitScriptControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/static_resources/sharedworker/init_script/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("getSharedWorkerHash",["uuidv4"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("uuidv4")()}g["default"]=a}),98);
__d("createSharedWorkerBundleUrl",["XCometFBMultiSiteSharedWorkerStaticInitScriptControllerRouteBuilder","getSharedWorkerHash","getWorkerInitScriptSPINParams","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a;return c("nullthrows")((a=c("XCometFBMultiSiteSharedWorkerStaticInitScriptControllerRouteBuilder").buildUri({hash:c("getSharedWorkerHash")()}).addQueryParams(c("getWorkerInitScriptSPINParams")()))==null?void 0:a.toString())}g["default"]=a}),98);
__d("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/static_resources/webworker/init_script/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("supportsModuleSharedWorker",[],(function(a,b,c,d,e,f){"use strict";var g=null;function a(){if(g!=null)return g;var a={get type(){g=!0}};try{new SharedWorker("blob://",a)}finally{g=(a=g)!=null?a:!1;return g}}f["default"]=a}),66);
__d("createSharedWorkerV2BundleUrl",["XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder","getSharedWorkerHash","getWorkerInitScriptSPINParams","nullthrows","supportsModuleSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("supportsModuleSharedWorker")(),b=c("getWorkerInitScriptSPINParams")();b.set("hash",c("getSharedWorkerHash")());return c("nullthrows")((a=c("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder").buildUri({worker_type:a?"MODULE":"CLASSIC"}))==null?void 0:(a=a.addQueryParams(b))==null?void 0:a.toString())}g["default"]=a}),98);
__d("handleWorkerWriteError",["FBLogger","WebStorageCleanupReason"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a instanceof Error){c("FBLogger")("worker").catching(a).mustfix("Error occured checking in shared worker reference");return}if(a==="writes disabled"){var b;c("FBLogger")("worker").warn("Writes to WebAsyncStorage is disabled. Unable to save shared worker reference. Reason: %s",(b=d("WebStorageCleanupReason").getLastCleanupReason())!=null?b:"n/a");return}c("FBLogger")("worker").mustfix("Error occured checking in shared worker reference: %s",JSON.stringify(a))}g["default"]=a}),98);
__d("SharedWorkerInitFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4266");b=d("FalcoLoggerInternal").create("shared_worker_init",a);e=b;g["default"]=e}),98);
__d("logSharedWorkerInitStep",["SharedWorkerInitFalcoEvent","SiteData","gkx","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h=c("uuidv4")();function a(a,b,d,e){if(!c("gkx")("21115"))return;c("SharedWorkerInitFalcoEvent").log(function(){return{client_id:h,bundle_name:a,client_rev:String(c("SiteData").client_revision),local_shared_worker_ref:b!=null?{bundle_url:b.url,rev:String(b.rev),spin_time:String(b.spin_time)}:null,new_shared_worker_ref:d!=null?{bundle_url:d}:null,init_step:e}})}g["default"]=a}),98);
__d("SharedWorkerBundleResource",["BootloaderPreloader","Deferred","FBLogger","ODS","Promise","SharedWorkerDevChangeManager","SharedWorkerEventManager","SharedWorkerLockManager","SharedWorkerStatusLock","SharedWorkerStorageManager","SharedWorkerUptimeTracker","SiteData","StaticSiteData","TrustedTypesWebWorkerScriptURLPolicy","WebStorage","WebWorkerV2DynamicData","buildSharedWorkerInitQPLLogger","buildSharedWorkerTerminateQPLLogger","checkForIndexedDbSupported","createSharedWorkerBundleUrl","createSharedWorkerV2BundleUrl","err","getErrorSafe","gkx","handleWorkerWriteError","justknobx","logSharedWorkerInitStep","promiseDone","regeneratorRuntime","supportsModuleSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a){d("SharedWorkerEventManager").registerLogFowardingListener(a,function(a){var b,c=a.args;a=a.method;(b=console)[a].apply(b,c)}),d("SharedWorkerEventManager").registerUncaughtErrorForwardingListener(a,function(a){var b=a.error;a=a.errorObject;b!=null?c("FBLogger")("worker").catching(b).mustfix("Shared Worker uncaught error."):c("FBLogger")("worker").mustfix("Shared Worker uncaught error with no Error object. %s:%d:%d:%s",a.message,a.lineno,a.colno,a.filename)})}function l(a,b,e,f,g){g==null?void 0:g.markEventStart("shared_worker_construct");var h=new SharedWorker(c("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(a),b);g==null?void 0:g.markEventEnd("shared_worker_construct");h.addEventListener("error",function(a){var b;g==null?void 0:g.addAnnotations({string_array:{onErrorHandler:[(b=JSON.stringify(a==null?void 0:a.message))!=null?b:"undefined",String(a==null?void 0:a.lineno),String(a==null?void 0:a.colno),String(a==null?void 0:a.filename)]}})});d("SharedWorkerEventManager").registerWorkerSelfTerminationListener(h,function(a){(j||(j=d("ODS"))).bumpEntityKey(6653,"shared_worker_infra","worker_self_termination."+a+"."+b)},{once:!0});d("SharedWorkerEventManager").registerConnectionAckListener(h,function(a,b){g==null?void 0:g.addAnnotations({string:{connectedFrom:a,workerID:b}}),g==null?void 0:g.markPoint("worker_connection_established")});var i=new Set();d("SharedWorkerEventManager").registerWorkerInitPointsListener(h,function(a){if(i.has(a))return;i.add(a);g==null?void 0:g.markPoint("worker_init_point_"+a)});h.port.start();d("SharedWorkerEventManager").registerExecuteWorkerImportsListener(h,g,function(a){var b=a.err;a=a.attempts;g==null?void 0:g.addAnnotations({string:{importsError:b},"int":{importAttempts:a}});b==null?g==null?void 0:g.markPoint("bundle_imports_success"):g==null?void 0:g.markPoint("bundle_imports_failure")});var k=new(c("Deferred"))();f==null?void 0:f.push(k);d("SharedWorkerEventManager").registerExecuteWorkerAckListener(h,g,function(a){var b=a.workerSpinTime,d=a.err,e=a.isFirstInit,f=a.workerRev;a=a.workerSpinMode;g==null?void 0:g.markEventEnd("execute_worker");g==null?void 0:g.addAnnotations({"int":{runningWorkerRev:f,runningWorkerSpinTime:b,runningWorkerSpinMode:a},string:{executeWorkerErr:d},bool:{isFirstInit:e}});d!=null?k.reject(c("err")(d)):k.resolve()});g==null?void 0:g.markEventStart("execute_worker");d("SharedWorkerEventManager").emitExecuteWorker(h,{jsModuleResource:e,isDev:!1});return k.getPromise().then(function(){return h})}function m(a,b,e,f,g){var h=c("supportsModuleSharedWorker")();a=c("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(a);var i;h?(g==null?void 0:g.markEventStart("shared_worker_construct"),i=new SharedWorker(a,{name:b,type:"module"}),g==null?void 0:g.markEventEnd("shared_worker_construct")):(g==null?void 0:g.markEventStart("shared_worker_construct"),i=new SharedWorker(a,b),g==null?void 0:g.markEventEnd("shared_worker_construct"));i.addEventListener("error",function(a){var b;g==null?void 0:g.addAnnotations({string_array:{onErrorHandler:[(b=JSON.stringify(a==null?void 0:a.message))!=null?b:"undefined",String(a==null?void 0:a.lineno),String(a==null?void 0:a.colno),String(a==null?void 0:a.filename)]}})});d("SharedWorkerEventManager").registerWorkerSelfTerminationListener(i,function(a){(j||(j=d("ODS"))).bumpEntityKey(6653,"shared_worker_infra","worker_self_termination."+a+"."+b)},{once:!0});d("SharedWorkerEventManager").registerConnectionAckListener(i,function(a,b){g==null?void 0:g.addAnnotations({string:{connectedFrom:a,workerID:b}}),g==null?void 0:g.markPoint("worker_connection_established")});var k=new Set();d("SharedWorkerEventManager").registerWorkerInitPointsListener(i,function(a){if(k.has(a))return;k.add(a);g==null?void 0:g.markPoint("worker_init_point_"+a)});i.port.start();var l=new(c("Deferred"))();f==null?void 0:f.push(l);d("SharedWorkerEventManager").registerHrpInitListener(i,g,function(a){a=a.err;g==null?void 0:g.markEventEnd("hrp_init");a!=null?l.reject(c("err")(a)):l.resolve()});g==null?void 0:g.markPoint("read_dynamic_data");c("promiseDone")(d("WebWorkerV2DynamicData").readDynamicDataForWorker(e).then(function(a){g==null?void 0:g.markEventStart("hrp_init");try{var e=c("justknobx")._("1979");e&&d("BootloaderPreloader").preloadWorkerJSFromHRP(a.hrp);g==null?void 0:g.addAnnotations({bool:{prefetchWorkerScripts:e}})}catch(a){c("FBLogger")("worker").catching(a).warn("Failed to preload worker %s JS from HRP",b)}d("SharedWorkerEventManager").emitHrpInit(i,{hrp:a.hrp,js_env:a.js_env,isDev:!1})},function(a){a=c("getErrorSafe")(a);g==null?void 0:g.addAnnotations({string:{hrpInitErr:a.toString()}})}));var m=new(c("Deferred"))();f==null?void 0:f.push(m);d("SharedWorkerEventManager").registerExecuteWorkerAckListener(i,g,function(a){var b=a.workerSpinTime,d=a.err,e=a.isFirstInit,f=a.workerRev;a=a.workerSpinMode;g==null?void 0:g.markEventEnd("execute_worker");g==null?void 0:g.addAnnotations({"int":{runningWorkerRev:f,runningWorkerSpinTime:b,runningWorkerSpinMode:a},string:{executeWorkerErr:d},bool:{isFirstInit:e}});d!=null?m.reject(c("err")(d)):m.resolve()});g==null?void 0:g.markEventStart("execute_worker");d("SharedWorkerEventManager").emitExecuteWorker(i);return m.getPromise().then(function(){return i})}function n(a,b,e,f,g,h,i){var j=new(c("Deferred"))();h==null?void 0:h.push(j);d("SharedWorkerEventManager").registerGetWorkerRevListener(a,i,function(a){var h=a.rev;a=a.spinTime;c("promiseDone")(d("SharedWorkerStorageManager").saveSharedWorkerReference(e,{url:b,rev:h,spin_time:a,version:g.version,rsrcBundleUrl:g.getJSModuleBundleResource().url,sandboxOnlyChecksum:g.sandboxOnlyChecksum}).then(function(){return d("SharedWorkerStorageManager").getSharedWorkerReference(e)}).then(function(a){c("logSharedWorkerInitStep")(e,a,g.resourceUrlForLogging,"after_worker_reference_save")}),function(){i.markEventEnd("get_worker_rev",{bool:{successfullySavedWorkerRef:!0}}),j.resolve(),f()},function(a){i.markEventEnd("get_worker_rev",{bool:{successfullySavedWorkerRef:!1}}),j.reject(a),c("handleWorkerWriteError")(a),f()})});i.markEventStart("get_worker_rev");d("SharedWorkerEventManager").emitGetRev(a);return j.getPromise()}function o(a,e,f,g,h){k(a),d("SharedWorkerEventManager").registerWorkerShutdownListener(a,function(a){a=a.reason;a==="requested-upgrade"&&(e==null?void 0:e());d("SharedWorkerUptimeTracker").stopUptimeTracking(f)}),d("SharedWorkerDevChangeManager").trackCreatedWorker(f),d("SharedWorkerUptimeTracker").startUptimeTracking(a,f),c("logSharedWorkerInitStep")(f,null,null,"create_worker_end"),g!=null&&c("promiseDone")((i||(i=b("Promise"))).all(g.map(function(a){return a.getPromise()})),function(){h.endSuccess()},function(a){var b=typeof a==="string"?c("err")(a):a;h.endFailure("worker_init_failure",{string:{workerInitFailureReason:a.message}});c("FBLogger")("worker").catching(b).warn("Failed to mark QPL end for shared worker init")})}function p(a,d,e,f,g,h,i){var j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:i.addAnnotations({string:{initFlow:"use_existing_ref"}});c("logSharedWorkerInitStep")(a,null,null,"using_existing_worker_ref");if(!(d.version===2)){k.next=8;break}k.next=5;return b("regeneratorRuntime").awrap(m(d.url,a,e.getJSModuleBundleResource(),h,i));case 5:j=k.sent;k.next=11;break;case 8:k.next=10;return b("regeneratorRuntime").awrap(l(d.url,a,e.getJSModuleBundleResource(),h,i));case 10:j=k.sent;case 11:f();o(j,g,a,h,i);return k.abrupt("return",j);case 14:case"end":return k.stop()}},null,this)}function q(){return self.LockManager!=null&&self.navigator.locks instanceof self.LockManager}function r(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(q()){e.next=2;break}return e.abrupt("return",!0);case 2:e.next=4;return b("regeneratorRuntime").awrap(self.navigator.locks.query());case 4:c=e.sent;return e.abrupt("return",c.held.some(function(b){return b.name===d("SharedWorkerStatusLock").getStatusLockName(a)}));case 6:case"end":return e.stop()}},null,this)}function s(a,e,f,g,h,i,j){var k,l,m,p,q;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:j.addAnnotations({string:{initFlow:"upgrade_worker_ref"}});c("logSharedWorkerInitStep")(a,null,null,"upgrading_worker_ref");s.next=4;return b("regeneratorRuntime").awrap(d("SharedWorkerStorageManager").removeSharedWorkerReference(a));case 4:s.next=6;return b("regeneratorRuntime").awrap(r(a));case 6:if(!s.sent){s.next=14;break}e.version===2&&c("supportsModuleSharedWorker")()?k=new SharedWorker(e.url,{name:a,type:"module"}):k=new SharedWorker(e.url,a);l=new(c("Deferred"))();i.push(l);d("SharedWorkerEventManager").registerWorkerShutdownListener(k,function(a){var b=a.workerID;a=a.isInitialized;l.resolve();j.markEventEnd("old_worker_shutdown",{string:{oldWorkerID:b},bool:{oldWorkerWasInitialized:a}})},{once:!0});j.markEventStart("old_worker_shutdown");d("SharedWorkerEventManager").emitWorkerShutdown(k,{upgrade:!0});k.port.start();case 14:s.next=16;return b("regeneratorRuntime").awrap(f.createSharedWorker());case 16:m=s.sent;p=m[0];q=m[1];s.next=21;return b("regeneratorRuntime").awrap(n(q,p,a,g,f,i,j));case 21:o(q,h,a,i,j);return s.abrupt("return",q);case 23:case"end":return s.stop()}},null,this)}function t(a,d,e,f,g,h){var i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:h.addAnnotations({string:{initFlow:"new_worker_ref"}});c("logSharedWorkerInitStep")(a,null,null,"new_worker_ref");l.next=4;return b("regeneratorRuntime").awrap(d.createSharedWorker());case 4:i=l.sent;j=i[0];k=i[1];l.next=9;return b("regeneratorRuntime").awrap(n(k,j,a,e,d,g,h));case 9:o(k,f,a,g,h);return l.abrupt("return",k);case 11:case"end":return l.stop()}},null,this)}function u(a,e,f,g,h){var i,j,k,l,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:h.markEventStart("create_worker");i=a.name;d("SharedWorkerUptimeTracker").stopUptimeTracking(i);o.t0=h;if(!q()){o.next=10;break}o.next=7;return b("regeneratorRuntime").awrap(r(i));case 7:o.t1=o.sent;o.next=11;break;case 10:o.t1=null;case 11:o.t2=o.t1;o.t3={workerAlreadyRunning:o.t2};o.t4={bool:o.t3};o.t0.addAnnotations.call(o.t0,o.t4);o.next=17;return b("regeneratorRuntime").awrap(d("SharedWorkerStorageManager").getSharedWorkerReference(i));case 17:j=o.sent;h.addAnnotations({"int":{storageWorkerSpinTime:j==null?void 0:j.spin_time,storageWorkerVersion:j==null?void 0:j.version,storageWorkerRev:j==null?void 0:j.rev}});c("logSharedWorkerInitStep")(i,j,a.resourceUrlForLogging,"create_worker_start");if(!(j!=null)){o.next=38;break}if(!(j.rev>=c("SiteData").client_revision&&(a.version===((k=j.version)!=null?k:1)||j.spin_time>=c("SiteData")[c("StaticSiteData").spin_time_key])&&d("SharedWorkerDevChangeManager").shouldUseStorageWorkerForDev(i,{storageWorkerResource:j,tabResource:a}))){o.next=30;break}h.markEventStart("using_storage_reference");o.next=25;return b("regeneratorRuntime").awrap(p(i,j,a,e,f,g,h));case 25:l=o.sent;h.markEventEnd("using_storage_reference");return o.abrupt("return",l);case 30:h.markEventStart("upgrading_worker_reference");o.next=33;return b("regeneratorRuntime").awrap(s(i,j,a,e,f,g,h));case 33:m=o.sent;h.markEventEnd("upgrading_worker_reference");return o.abrupt("return",m);case 36:o.next=44;break;case 38:h.markEventStart("new_worker_reference");o.next=41;return b("regeneratorRuntime").awrap(t(i,a,e,f,g,h));case 41:n=o.sent;h.markEventEnd("new_worker_reference");return o.abrupt("return",n);case 44:case"end":return o.stop()}},null,this)}function v(){if(c("gkx")("21113")&&!c("checkForIndexedDbSupported")()){var a=(h||(h=c("WebStorage"))).getLocalStorage();if(a!=null){var b="afab0ea5-8ede-41bd-9933-dca4eea1e9b4009b1647-9c95-448c-b5f5-bcc6653853c49a83be9e-1e94-40be-a23b-c8ac74114c1e9fad1a9b-d2b3-4cf8-8751-22cc16cd96fde876fbf6-b739-4871-8586-55b51c4332a97606adc6-f4dc-4935-bb80-07e2b12a77533ae5ef90-dbc4-4003-ba54-2450fff94bbce0542942-228e-4f14-a41e-b3eef321a126eb8a6b22-a915-487f-aae7-b1a042f80274116403b4-8cdf-466a-afc7-1fc481fe95bac9585547-5693-4c3a-aba6-c8b5eec23e2cd3c74809-ef4d-4157-bf02-e0693e105906559a86c2-66a4-407c-8c45-126ff24dab57bba15e7d-da70-4d46-bff1-b4deaa9e328788a7ae98-7313-4158-97ee-5f1349d5f3b8b3a889b2-7c53-4443-8be3-9ff617a09503b13d6954-e863-40d6-b831-a24c81eae3a0099c6236-d6af-4c99-a104-61a7afe99d22";a=(h||(h=c("WebStorage"))).setItemGuarded(a,"shw_t",b);a!=null?(j||(j=d("ODS"))).bumpEntityKey(6653,"shared_worker_infra","local_storage_write_fail"):(j||(j=d("ODS"))).bumpEntityKey(6653,"shared_worker_infra","local_storage_write_success")}}}function a(a,e,f){f=(f=f)!=null?f:{};var g=f.onQPLEvent;f=f.reason;var h=a.name,i=[],j=c("buildSharedWorkerInitQPLLogger")(g);j.start({version:1,workerName:h,callReason:f,supportsIDB:c("checkForIndexedDbSupported")()});v();var k=new(c("Deferred"))();i.push(k);var m=new(c("Deferred"))();d("SharedWorkerLockManager").withWorkerLock(function(d){var f;c("promiseDone")(u({name:h,version:1,resourceUrlForLogging:(f=a.url)!=null?f:"",getJSModuleBundleResource:function(){return a},createSharedWorker:function(){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=c("createSharedWorkerBundleUrl")();e.t0=d;e.next=4;return b("regeneratorRuntime").awrap(l(d,h,a,i,j));case 4:e.t1=e.sent;return e.abrupt("return",[e.t0,e.t1]);case 6:case"end":return e.stop()}},null,this)}},d,e,i,j),function(a){j.markEventEnd("create_worker"),k.resolve(),m.resolve(a)},function(a){j.endFailure("worker_init_failure",{string:{workerInitFailureReason:a.message}}),m.reject(a),d()})},{workerQPLLogger:j,onLockTimeout:function(){return m.reject(c("err")("Worker lock timeout"))}});return m.getPromise()}function e(a,e,f){var g=a.name;f=(f=f)!=null?f:{};var h=f.onQPLEvent;f=f.reason;var i=[],j=c("buildSharedWorkerInitQPLLogger")(h);j.start({version:2,workerName:g,callReason:f,supportsIDB:c("checkForIndexedDbSupported")()});v();j.addAnnotations({bool:{usingModuleWorker:c("supportsModuleSharedWorker")()}});var k=new(c("Deferred"))();i.push(k);var l=new(c("Deferred"))();d("SharedWorkerLockManager").withWorkerLock(function(d){c("promiseDone")(u({name:g,version:2,getJSModuleBundleResource:function(){return a},sandboxOnlyChecksum:a.sandboxOnlyChecksum,createSharedWorker:function(){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=c("createSharedWorkerV2BundleUrl")();e.t0=d;e.next=4;return b("regeneratorRuntime").awrap(m(d,g,a,i,j));case 4:e.t1=e.sent;return e.abrupt("return",[e.t0,e.t1]);case 6:case"end":return e.stop()}},null,this)}},d,e,i,j),function(a){j.markEventEnd("create_worker"),k.resolve(),l.resolve(a)},function(a){j.endFailure("worker_init_failure",{string:{workerInitFailureReason:a.message}}),l.reject(a),d()})},{workerQPLLogger:j,onLockTimeout:function(){return l.reject(c("err")("Worker lock timeout"))}});return l.getPromise()}function f(a,b,e){var f=(b=b)!=null?b:a.name,g=new(c("Deferred"))(),h=c("buildSharedWorkerTerminateQPLLogger")();h.start({workerName:f});d("SharedWorkerLockManager").withWorkerLock(function(b){c("promiseDone")(d("SharedWorkerStorageManager").getSharedWorkerReference(f).then(function(b){h.markPoint("read_worker_reference",{"int":{storageWorkerVersion:b==null?void 0:b.version},bool:{storageReferenceExists:b!=null}});if(b!=null){var c;b.version===2?c=m(b.url,f,a,void 0,void 0):c=l(b.url,f,a);return d("SharedWorkerStorageManager").removeSharedWorkerReference(f).then(function(){h.markPoint("removed_worker_reference");return c})}return null}),function(a){try{b(),d("SharedWorkerUptimeTracker").stopUptimeTracking(f),a!=null?(d("SharedWorkerEventManager").registerWorkerShutdownListener(a,function(a){var b=a.workerID;a=a.isInitialized;h.endSuccess({string:{workerID:b},bool:{wasInitialized:a}})},{once:!0}),d("SharedWorkerEventManager").emitWorkerShutdown(a,{reason:e})):h.endSuccess()}finally{g.resolve()}},function(a){c("FBLogger")("worker").catching(c("getErrorSafe")(a)).mustfix("Failed to terminate worker"),h.endFailure("terminate_worker_failure",{string:{workerTerminateFailReason:a.message}}),b()})},{workerQPLLogger:h});return g.getPromise()}function w(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("SharedWorkerStorageManager").getSharedWorkerReference(a.name));case 2:c=e.sent;return e.abrupt("return",c!=null);case 4:case"end":return e.stop()}},null,this)}g.createPushSafeSharedWebWorkerAsync=a;g.createPushSafeSharedWebWorkerV2Async=e;g.terminateSharedWorker=f;g.doesSharedWorkerReferenceExist=w}),98);
__d("waitForMAWWorkerCreated",["WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";a=new(d("WAResolvable").Resolvable)();b=a.promise;g.resolvable=a;g.promise=b}),98);
__d("MAWSetupWorker",["CurrentUser","Deferred","IGDWebUtils","MAWClientConsistencyRefresh","MAWCommonSetupWorker","MAWCrossWorkerPortal","MAWInit","MAWLoggerUtils","MAWWebWorkerInstance","MAWWebWorkerSingleton","MAWWorkerWatchdog","MessengerIntent","Promise","SharedWorkerBundleResource","WATagsLogger","asyncToGeneratorRuntime","cr:6600","err","gkx","justknobx","pageID","promiseDone","setTimeout","shouldUseMAWSharedWorker","startMAWWorkerWatchdog","waitForMAWWorkerCreated"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker terminating: for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker doesn't exist, no need to terminate"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to startup worker watchdog: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["MAW worker watchdog successfully setup"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker setting up"]);m=function(){return a};return a}var n="testing",o=c("justknobx")._("816"),p=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.WorkerSetup,d("MAWLoggerUtils").Tag.MAWInit]),q=d("IGDWebUtils").isInstagramWebSupportedApp(Number(c("CurrentUser").getAppID())),r=q?"IGDAWMainWorker":"MAWMainWorker",s=c("gkx")("24001"),t=null,u=null,v=!1;function w(a){switch(a){case"mawInit":return!0;case"mawReinitSetupMutex":case"mawReinitReregDevice":case"watchdogRestart":case"workerUpgraded":return!1}}function x(e,f,g,h,i,j){var k;j===void 0&&(j=null);if(v)throw c("err")("Worker is permanently killed.");var l=function(){return x(e,f,g,h,"workerUpgraded")};d("MAWInit").MAWInit.logPoint("create_worker_start");(k=j)==null?void 0:k.sharedWorkerRestartAddPoint("create_worker_instance_start");d("MAWWebWorkerSingleton").setOnCloseForWorkerInstance(function(){B("createWorkerIfNone:onClose"),d("MAWInit").MAWInit.addBoolAnnotation("workerUpgraded",!0),c("promiseDone")(l())});d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()||c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!(yield z()))return;yield F()})());d("shouldUseMAWSharedWorker").logExposureForMAWSharedWorker();k=d("MAWWebWorkerSingleton").createWorkerIfNone(i);var n=new(c("Deferred"))();t=n.getPromise();a=k;return a.then(function(a){var h;d("waitForMAWWorkerCreated").resolvable.resolve();d("MAWInit").MAWInit.logPoint("create_worker_end");(h=j)==null?void 0:h.sharedWorkerRestartAddPoint("create_worker_instance_end");if(a===null)throw c("err")("Client is starting bridge without a worker.");p.LOG(m());d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()&&a.addEventListener("message",function(a){var b;typeof a.data==="object"&&((b=a.data)==null?void 0:b.type)==="sw-shutdown"&&typeof a.data.response==="object"&&((b=a.data.response)==null?void 0:b.reason)==="maw-request-refresh"&&(s?d("MAWWorkerWatchdog").terminateWatchdog():u==null?void 0:u(),c("MAWClientConsistencyRefresh")("worker_mismatch"))});d("shouldUseMAWSharedWorker").logExposureForMAWSharedWorker();var i=new(d("MAWCommonSetupWorker").BridgeAdapter)(a,r);n.resolve(i);f(i);return d("MAWInit").MAWInit.measurePerformance("maw_init_worker",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=function(){return d("MAWCommonSetupWorker").initWorker(i,e,l,g)},b;!d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()?b=(yield i.fullyConnected.then(a)):b=(yield a());d("MessengerIntent").markWorkerReady();return b}))})}function y(a,d,e,f,g){c("promiseDone")((h||(h=b("Promise"))).race([E(o).then(function(){return!0}),a.then(function(){u=c("startMAWWorkerWatchdog")(d,e,f,g,c("pageID"));return!1})]).then(function(a){if(a)throw c("err")("Bridge setup timed out.")}),function(){p.LOG(l())},function(a){a=a.description||a.message||a;p.ERROR(k(),a)})}function e(a,b,e,f,g,h){h===void 0&&(h=null);if(t){var i;(i=h)==null?void 0:i.sharedWorkerRestartAddPoint("not_needed")}if(!t){i=x(a,b,e,f,g,h);if(s)w(g)&&d("MAWWorkerWatchdog").startWatchdog({initPageID:c("pageID"),onConnectToExistingWorker:e,onTerminateWorker:f,onWorkerReconnect:b,vaultMaterials:a});else{(g=h)==null?void 0:g.sharedWorkerRestartAddPoint("setup_watchdog_start");y(i,a,b,e,f);(g=h)==null?void 0:g.sharedWorkerRestartAddPoint("setup_watchdog_end")}return i}return t}function z(){return d("SharedWorkerBundleResource").doesSharedWorkerReferenceExist(b("cr:6600"))}function A(a,b){var e=a!==n;if(!t){e&&p.LOG(j());return!1}e&&p.LOG(i(),a);c("promiseDone")(t.then(function(a){return a==null?void 0:a.close()}));t=null;d("MAWCrossWorkerPortal").killPortalWhenWorkerTerminating();d("MAWWebWorkerInstance").destroyWorkerInstance();b&&(s?d("MAWWorkerWatchdog").terminateWatchdog():(u==null?void 0:u(),u=null));return!0}function B(a){A(a,!s)}function f(){A("terminateWorkerPermanently",!0),v=!0}function C(){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){A(n,!1)&&(yield E(45e3))});return D.apply(this,arguments)}function E(a){return new(h||(h=b("Promise")))(function(b){return c("setTimeout")(b,a)})}function F(a){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!0),yield d("SharedWorkerBundleResource").terminateSharedWorker(b("cr:6600"),null,a?"maw-request-refresh":void 0)});return G.apply(this,arguments)}function H(a){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();d("shouldUseMAWSharedWorker").logExposureForMAWSharedWorker();b?yield F(!1):A(a,!0)});return I.apply(this,arguments)}g.getOrSetupWorker=e;g.isSharedWorkerActive=z;g.terminateWorker=B;g.terminateWorkerPermanently=f;g.killWorkerForTest=C;g.killSharedWorker=F;g.killSharedWorkerOrTerminateWebWorkerTmp=H}),98);
__d("MAWSharedWorkerReboot",["MAWSetupWorker","ODS","Promise","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["shared worker reconnection failed - ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Clear the shared worker reference in MAWSharedWorkerReboot"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["starting reconnection to shared worker"]);l=function(){return a};return a}function m(a){(i||(i=d("ODS"))).bumpEntityKey(3185,"armadillo_shared_worker_reboot","shared_worker_reboot_"+a)}function a(a,c,e,f,g){d("WALogger").LOG(l());m("start");g.startSharedWorkerRestart();d("WALogger").LOG(k());d("MAWSetupWorker").terminateWorker("Clear the shared worker reference in MAWSharedWorkerReboot");return new(h||(h=b("Promise")))(function(b,h){return d("MAWSetupWorker").getOrSetupWorker(a,c,e,f,"watchdogRestart").then(function(a){m("success"),g.endSuccessSharedWorkerRestart(),c(a),b()})["catch"](function(a){d("WALogger").ERROR(j(),a.message),m("fail"),g.endFailureSharedWorkerRestart(a.message),h(a)})})}g.rebootSharedWorker=a}),98);
__d("MessengerWaitForEvent",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,c,d){var e,f=d;return new(g||(g=b("Promise")))(function(b){f?e=function(){f.apply(this,arguments)&&b.apply(this,arguments)}:e=b,a==null?void 0:a.addEventListener==null?void 0:a.addEventListener(c,e)})["finally"](function(){a==null?void 0:a.removeEventListener==null?void 0:a.removeEventListener(c,e)})}f.waitForEvent=a}),66);
__d("LocalStorageMutex",["MessengerWaitForEvent","Promise","QPLUserFlow","err","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=null,j=1e3;a=function(){function a(a){var b=this,d=a.mutexKey,e=a.localTakeoverKey,f=a.log,g=a.logError,h=a.getStorage,i=a.setItemGuarded,k=a.mutexTimeoutMs;k=k===void 0?j:k;a=a.mutexTimeoutCallback;this.mutexFilter=function(a){if(a.key!==b.$1)return!1;a=a.newValue||"";if(!a.includes(c("pageID")))return!0;else return!1};this.$1=d;this.$2=e;this.$5=h;this.$6=i;this.$3=f;this.$4=g;this.$7=k;this.$8=a}var e=a.prototype;e.init=function(){c("QPLUserFlow").start(c("qpl")._(1056847375,"584"));this.$3("APPMUTEX - this tab is "+c("pageID"));var a=this.getMutex();if(a!=null&&a===c("pageID")){this.$3("APPMUTEX - WE ALREADY HAVE THE MUTEX LOCK WITHIN INIT");c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return(h||(h=b("Promise"))).resolve(!0)}if(a!=null){this.$3("APPMUTEX - initiating localTAKEOVER");return this.localTakeover()}else{this.$3("APPMUTEX - NO1 ELSE IS ALIVE, GET THE MUTEX");a=this.$9(c("pageID"));var d=this.$10(c("pageID"));if(!a.success||!d.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{bool:{setMutexResult:d.success,setTakeoverResult:a.success},string:{setMutexError:d.error,setTakeoverError:a.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"fail_to_set_takeover_or_mutex");return(h||(h=b("Promise"))).resolve(!1)}c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return(h||(h=b("Promise"))).resolve(!0)}};e.localTakeover=function(){var a,e=this,f=this.$9(c("pageID"));if(!f.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{string:{initTakeoverError:f.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_init_takeover_failure");return(h||(h=b("Promise"))).resolve(!1)}var g,i=function(){g!=null&&clearTimeout(g)};f=d("MessengerWaitForEvent").waitForEvent(window,"storage",this.mutexFilter);var k=(a=this==null?void 0:this._mutexTimeoutMs)!=null?a:j;return(h||(h=b("Promise"))).race([f,new h(function(a){g=setTimeout(function(){a()},k)}),this.$8?this.$8():new(h||(h=b("Promise")))(function(a){})]).then(function(a){if(a==null){e.$3("AppMutex - Forcefully took the mutex and takeover lock");var b=e.$9(c("pageID")),d=e.$10(c("pageID"));if(!b.success||!d.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{string:{setMutexError:d.error,setTakeoverError:b.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_forcefully_takeover_failure");return!1}c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return!0}e.$3("APPMUTEX - GOT MUTEX STORAGE EVENT CHANGE FROM ANOTHER TAB");d=e.$11(a.newValue);if(!d&&e.hasTakeoverPermission()){e.$3("APPMUTEX - setting mutex on localtakeover");b=e.$10(c("pageID"));if(!b.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{string:{setMutexError:b.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_set_mutex_failure");return!1}c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return!0}else{e.hasTakeoverPermission()&&e.$12();c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_no_takeover_permission");return!1}}).then(function(a){i();return a})["catch"](function(a){i();e.$4("AppMutex - localTakeover error no permission - "+a);c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_general_failure");return!1})};e.onMutexDeath=function(){var a=this.getMutex();a!=null&&a==c("pageID")&&(this.$3("APPMUTEX - removing mutex on death"),this.$13(),this.hasTakeoverPermission()&&this.$12())};e.takeoverFilter=function(a){if(a.key!==this.$2)return!1;a=a.newValue||"";if(!a.includes(c("pageID")))return!0;else return!1};e.$14=function(){if(!i){var a=this.$5();if(!a)throw c("err")("Could not get localStorage");i=a}return i};e.getMutex=function(){i=this.$14();return i.getItem(this.$1)};e.$10=function(a){i=this.$14();return this.$6(i,this.$1,a)};e.$13=function(){i=this.$14(),i.removeItem(this.$1)};e.getTakeover=function(){i=this.$14();return i.getItem(this.$2)};e.$9=function(a){i=this.$14();a=this.$6(i,this.$2,a);return a};e.$12=function(){i=this.$14(),i.removeItem(this.$2)};e.$11=function(a){return a!=null?a:""};e.hasTakeoverPermission=function(){var a=this.getTakeover();return a!=null&&a==c("pageID")};return a}();g.THIS_TAB=c("pageID");g.LocalStorageMutex=a}),98);
__d("MAWAppMutex",["LocalStorageMutex","MAWLocalStorage","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h="armadillo_msgr_mutex",i="armadillo_msgr_local_takeover",j=null;function a(){j==null&&(j=new(d("LocalStorageMutex").LocalStorageMutex)({getStorage:d("MAWLocalStorage").getStorage,localTakeoverKey:i,log:function(a){d("WALogger").LOG([a])},logError:function(a){d("WALogger").ERROR([a])},mutexKey:h,setItemGuarded:d("MAWLocalStorage").setItemGuarded}));return j}g.MAW_MUTEX_KEY=h;g.MAW_LOCALTAKEOVER_KEY=i;g.use=a}),98);
__d("MAWIssueNewUserVisibleErrors",["fbt","$InternalEnum","LSDatabaseSingleton","LSFactory","LSIssueNewErrorStoredProcedure","LSRemoveErrorStoredProcedure","Promise","ReQL","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;function a(a,b,e,f){c("promiseDone")((j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(d){return d.runInTransaction(function(d){return c("LSIssueNewErrorStoredProcedure")(c("LSFactory")(d),{errorBodyText:a!=null?a.toString():void 0,errorExtraData:f,errorTitleText:b.toString(),presentationStyle:String(e)})},"readwrite")}))}function k(a,b){return a.runInTransaction(function(a){return c("LSRemoveErrorStoredProcedure")(c("LSFactory")(a),{errorId:b})},"readwrite")}function e(){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton),c=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.user_visible_errors)));yield (i||(i=b("Promise"))).all(c.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield k(a,b.errorId)});return function(a){return c.apply(this,arguments)}}()))})())}function f(a){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var c=(yield (j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton),e=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(c.tables.user_visible_errors)));yield (i||(i=b("Promise"))).all(e.map(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b.errorExtraData===a&&(yield k(c,b.errorId))});return function(a){return d.apply(this,arguments)}}()))})())}var l=b("$InternalEnum")({TOAST:"toast",BANNER:"banner"}),m=h._("__JHASH__GYf1KHsnFi8__JHASH__"),n=h._("__JHASH__sfKyyq_GmTy__JHASH__"),o=h._("__JHASH__GFcUdiCyJga__JHASH__"),p=h._("__JHASH__eNLW45dJwcf__JHASH__"),q=h._("__JHASH__ullHqmlWvhs__JHASH__");h=h._("__JHASH__1UM5NSCZCUv__JHASH__");var r=new Map([[m.toString(),m],[o.toString(),o]]),s=new Map([[n.toString(),n],[p.toString(),p]]);g.issueError=a;g.deleteUserVisibleError=k;g.deleteAllErrors=e;g.deleteUserVisibleErrorByJSErrorMessage=f;g.MAWUserVisibleErrorPresentationType=l;g.MAWGeneralErrorMsgTitle=m;g.MAWGeneralErrorMsgBody=n;g.MAWLegacyUserErrorMsgTitle=o;g.MAWLegacyUserErrorMsgBody=p;g.MAWUnsupportedIndexedDBErrorMsgTitle=q;g.MAWUnsupportedIndexedDBErrorMsg=h;g.errorMsgTitleToFbtMap=r;g.errorMsgBodyToFbtMap=s}),226);
__d("MWTabCommunicationChannel",["MAWLocalStorage"],(function(a,b,c,d,e,f,g){"use strict";var h=typeof window!=="undefined"?window:self;function i(a){var b=d("MAWLocalStorage").getStorage(),c=function(c){d("MAWLocalStorage").setItemGuarded(b,a,JSON.stringify(c))},e=function(c){window.removeEventListener("storage",c),d("MAWLocalStorage").removeItemGuarded(b,a)},f=function(a){window.addEventListener("storage",a)},g=function(b){return b!=null&&b.key===a&&typeof b.newValue==="string"?JSON.parse(b.newValue):null};return{getMessage:g,onRequestReceived:function(a){var b=function(b){b=g(b);b!=null&&a(b)};f(b);return{release:function(){e(b)}}},sendMessage:c,stopWaitingForReply:e,waitForReply:f}}function j(a){var b=new h.BroadcastChannel(a),c=new Set();b.addEventListener("message",function(a){c.forEach(function(b){b(a)})});var d=function(a){c.add(a)},e=function(a){c["delete"](a)};a=function(a){b.postMessage(JSON.stringify(a))};var f=function(a){return a!=null&&typeof a.data==="string"?JSON.parse(a.data):null};return{getMessage:f,onRequestReceived:function(a){var b=function(b){b=f(b);b!=null&&a(b)};d(b);return{release:function(){e(b)}}},sendMessage:a,stopWaitingForReply:e,waitForReply:d}}function a(a){return h.BroadcastChannel!=null?j(a):i(a)}g.getChannel=a}),98);
__d("MWTabCommunication",["MWTabCommunicationChannel","Promise","clearTimeout","pageID","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a,b){var c=this;this.$2=null;this.$5=function(a){a=c.$4.getMessage(a);a!=null&&a.a==="sb"&&a.t!==c.tabID()&&a.r===c.tabID()&&a.k!=null&&(c.$2&&c.$2(a.k),c.$4.stopWaitingForReply(c.$5),c.$2=null)};this.$1=a;this.$3=b!=null?b:500;this.$4=d("MWTabCommunicationChannel").getChannel(a)}var e=a.prototype;e.tabID=function(){return c("pageID")};e.$6=function(){var a={a:"r",t:this.tabID()};this.$4.sendMessage(a)};e.listenToRequest=function(a){var b=this,c=function(c){if(c.a==="r"&&c.t!==b.tabID()){c={a:"sb",k:a(),r:c.t,t:b.tabID()};b.$4.sendMessage(c)}};return this.$4.onRequestReceived(c)};e.$7=function(){var a=this;return new(h||(h=b("Promise")))(function(b){a.$2=b,a.$4.waitForReply(a.$5),a.$6()})};e.request=function(a,d){var e=this,f,g=function(){f!=null&&c("clearTimeout")(f)};return(h||(h=b("Promise"))).race([this.$7().then(function(b){e.$4.stopWaitingForReply(e.$5);return a(b)}),new h(function(a){f=c("setTimeout")(function(){a(d()),e.$4.stopWaitingForReply(e.$5)},e.$3)})]).then(function(a){g();return a})};return a}();g.MWTabCommunication=a}),98);
__d("MAWVaultMaterialsStorage",["BrowserLockManager","FBLogger","MAWVaultMaterials","MWTabCommunication","Promise","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i="mw_vaulting_materials_lock";e="mw_exchange_vm";var j=new(d("MWTabCommunication").MWTabCommunication)(e);function k(){return j.listenToRequest(d("MAWVaultMaterials").materialsToString)}function l(){var a=function(a){return d("MAWVaultMaterials").fromStringToMaterials(a)};return j.request(a,function(){}).then(function(a){return d("MAWVaultMaterials").initializeVaultMaterials(a)})}function m(){if(c("BrowserLockManager")!=null)return new(h||(h=b("Promise")))(function(a,e){c("BrowserLockManager").request(i,{ifAvailable:!0},function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e==null){c("promiseDone")(c("BrowserLockManager").request(i,function(){return new(h||(h=b("Promise")))(function(){})}));e=(yield l());a(e);return}a(d("MAWVaultMaterials").initializeVaultMaterials());return new(h||(h=b("Promise")))(function(){})});return function(a){return e.apply(this,arguments)}}())["catch"](function(a){e(a)})});else{c("FBLogger")("mpf_web_foundations").info("navigator.locks is not available, using fallback");return l()}}function a(){return d("MAWVaultMaterials").hasVaultBeenSetup()?(h||(h=b("Promise"))).resolve(d("MAWVaultMaterials").getVaultMaterials()):m().then(function(a){k();return a})}g.setupVaultMaterials=a}),98);
__d("MAWCommonBackendSetup",["MAWAppMutex","MAWEncyptionIndexedDbV2","MAWInit","MAWIssueNewUserVisibleErrors","MAWLocalStorage","MAWVaultMaterialsStorage","MWSetupDBEncryption","Promise","asyncToGeneratorRuntime","promiseDone","requireDeferred","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("MAWMainThreadLogger").__setRef("MAWCommonBackendSetup");function a(a,b,c,d,e,f){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,j,k){yield e.start();e.logPoint("setup_armadillo_backend");i.onReadyImmediately(function(a){a=a.setupMainWaLogger;return a()});var l=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();yield e.measurePerformance("detection_support",function(){if(l)return(h||(h=b("Promise"))).resolve();var a=d("MAWLocalStorage").isLocalStorageAvailable();if(!a)throw new(d("MAWInit").MAWInitError)("localstorage_not_supported");return(h||(h=b("Promise"))).resolve()});var m=e.measurePerformance("setup_vault_materials",function(){return d("MAWVaultMaterialsStorage").setupVaultMaterials()}),n=(yield e.measurePerformance("acquire_mutex",function(){try{d("shouldUseMAWSharedWorker").logExposureForMAWSharedWorker();var a=d("MAWAppMutex").use().init();if(l){c("promiseDone")(a);return(h||(h=b("Promise"))).resolve(!0)}return a}catch(a){if(l)return(h||(h=b("Promise"))).resolve(!0);throw a}})),o=(yield e.measurePerformance("ear_db_setup",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("MWSetupDBEncryption").setPerformanceMeasurementTool(d("MAWInit").MAWInit.measurePerformance);var a=(yield d("MWSetupDBEncryption").init());d("MAWEncyptionIndexedDbV2").maybeSetEncryptionDbOnVersionChange(function(){var a;(a=d("MAWIssueNewUserVisibleErrors")).issueError(a.MAWLegacyUserErrorMsgBody,a.MAWLegacyUserErrorMsgTitle,a.MAWUserVisibleErrorPresentationType.BANNER)});return a})));if(!o.success){e.logPoint("keychain_setup_failure");throw new(d("MAWInit").MAWInitError)("keychain_setup_failure")}if(!n){e.logPoint("maw_appmutex_no_permission");throw new(d("MAWInit").MAWInitError)("maw_appmutex_no_permission")}var p=(yield m);yield e.measurePerformance("setup_worker",function(){return a(p,f,g,j,k)})});return j.apply(this,arguments)}g.setupArmadilloBackend=a}),98);
__d("MAWStateContext.react",["EncryptedBackupsDYITypes","MAWSharedProtocolQueueConst","err","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=i.createContext,k=i.useCallback,l=i.useContext,m=i.useEffect,n=i.useRef,o=i.useState;i={ebDYIState:d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.NotStarted,eBInitialThreadsRestoreStatus:{},ephemeralSettings:{},messageLatencies:{},offlineQueueCount:0,offlineQueueProgressDownloaded:0,offlineQueueProgressProcessed:0,offlineQueueSyncState:d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Initializing,offlineQueueThreadStatus:{},unArchivedSelfDeviceChangeAlerts:0};function a(){var a=l(q)(),b=a.dispatch;return k(function(a,c){c===void 0&&(c=Date.now()),b({optimisticMsgId:a,tag:"OptimisticSendMessage",timestamp:c})},[b])}function b(){var a=l(q)(),b=a.dispatch;return k(function(a,d,e){c("gkx")("23920")||b({tag:"EphemeralSettingsUpdatedForUI",value:{chatJid:a,ephemeralSettingArgs:d,isEphemeralSettingReset:e}})},[b])}function e(){var a=l(r),b=a.dispatch;return k(function(){b({tag:"ClearEphemeralSettings"})},[b])}function f(){var a=l(r),b=a.dispatch;return k(function(a){b({tag:"eBInitialThreadsRestoreStatus",value:a})},[b])}var p={dispatch:function(a){throw c("err")("MAW Dispatch not implemented")},state:i,subscriptions:new Set()},q=j(function(){return p}),r=j(p);function s(a){var b=l(q)(),c=b.state,d=b.subscriptions;b=o(function(){return a(c)});var e=b[0],f=b[1],g=n(e);m(function(){var b=function(b){b=a(b);b!==g.current&&(g.current=b,f(b))};d.add(b);return function(){d["delete"](b)}},[d,a]);return e}g.initialState=i;g.useDispatchOptimisticSendMessage=a;g.useDispatchEphemeralSettingsUpdatedForUI=b;g.useDispatchClearEphemeralSettings=e;g.useDispatchEBInitialThreadsRestoreStatus=f;g.MAWNonRerenderingStateContext=q;g.MAWStateContext=r;g.useMAWSelector=s}),98);
__d("XPlatRelayEnvironment",["CometRelayEnvironment","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){throw c("err")("RelayEnvironment is already set")}function b(){return c("CometRelayEnvironment")}g.setRelayEnvironment=a;g.getRelayEnvironment=b}),98);
__d("useMWEncryptedBackupsProcessBackupIdsDeferred",["promiseDone","react","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect,j=c("requireDeferred")("MWEncryptedBackupsProcessBackupIds").__setRef("useMWEncryptedBackupsProcessBackupIdsDeferred");function a(a){var b=c("useAsyncReStore")();i(function(){var d,e=!1;j.onReadyImmediately(function(f){c("promiseDone")(b,function(b){e||(d=f.subscribeToEncryptedBackupsRow(b,a))})});return function(){e=!0,d==null?void 0:d()}},[b,a])}g["default"]=a}),98);
__d("MAWCommonSetup",["InteractionTracingMetrics","MAWBridge","MAWBridgeFireAndForget","MAWCommonBackendSetup","MAWCryptoAuthToken","MAWEncryptedBackupsStateManager","MAWInit","MAWIssueNewUserVisibleErrors","MAWJobDefinitions","MAWMIC","MAWMICSafe","MAWRestoreRewriteUtils","MAWSetupUtils","MAWStateContext.react","MAWUIJob","MAWWaitForBackendSetup","MWChatInteraction","Promise","WAJobOrchestratorTypes","XPlatRelayEnvironment","asyncToGeneratorRuntime","getErrorSafe","gkx","performance","promiseDone","react","requireDeferred","useMWEncryptedBackupsProcessBackupIdsDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;f=j||d("react");var k=f.useContext,l=f.useEffect,m=c("requireDeferred")("FBLogger").__setRef("MAWCommonSetup"),n=!1,o=null,p=null,q=function(){return(i||(i=c("performance"))).now()},r=function(a){d("MAWEncryptedBackupsStateManager").setEncryptedBackupsState(a),d("MAWBridgeFireAndForget").fireAndForget("backend","setEncryptedBackupsState",{newState:a})};function a(a){var b=k(d("MAWStateContext.react").MAWStateContext),e=b.dispatch,f=d("MAWSetupUtils").useIsIDBOperational();l(function(){f&&c("promiseDone")(z({dispatch:e,fromReact:!0,platformSetupUtils:a}))},[a,e,f]);c("useMWEncryptedBackupsProcessBackupIdsDeferred")(r)}var s,t=new(h||(h=b("Promise")))(function(a){s=function(c){a(c),c.onmessage=function(a){return u.onmessage==null?void 0:u.onmessage(a)},s=function(a){a.onmessage=function(a){return u.onmessage==null?void 0:u.onmessage(a)},t=(h||(h=b("Promise"))).resolve(a)}}}),u={onmessage:null,postMessage:function(a){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield t);b.postMessage(a)})())}},v=[],w=[];function x(){var a=o;if(a!=null)while(w.length>0)a(w.shift());a=p;if(a!=null)while(v.length>0){var b=v.shift();switch(b){case"logout":a.logout();break;case"reregisterDevice":a.reregisterDevice();break;default:b}}}function e(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("MAWSetupUtils").isIDBOperational(!0));if(!b)return;b=function(a){x(),o!=null?o(a):w.push(a)};a=babelHelpers["extends"]({},a,{logout:function(){v.push("logout")},reregisterDevice:function(){v.push("reregisterDevice")},rotateCryptoAuthToken:function(){return d("MAWCryptoAuthToken").fetchFreshCAT(d("XPlatRelayEnvironment").getRelayEnvironment())}});return z({dispatch:b,fromReact:!1,platformSetupUtils:a})});return y.apply(this,arguments)}function z(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.dispatch,e=a.fromReact;a=a.platformSetupUtils;e&&(o=b,p=a,x());if(n)return;n=!0;yield d("MAWMIC").startMAWMICFlow();d("MAWMIC").addStringAnnotation("entrypoint",e?"react":"preload");d("MAWInit").MAWInit.addStringAnnotation("entrypoint",e?"react":"preload",{allowEarlyAnnotations:!0});try{d("MAWIssueNewUserVisibleErrors").deleteAllErrors();e=a.getOrSetupWorker;var f=a.logout,g=a.reregisterDevice,h=a.rotateCryptoAuthToken,i=a.setupBridge;yield d("MAWCommonBackendSetup").setupArmadilloBackend(e,d("MAWInit").MAWInit,function(a){var d={close:function(){},onmessage:null,postMessage:function(b){return a.postMessage(b)}},e={close:function(){return a.close()},onmessage:null,postMessage:function(b){return a.postMessage(b)}};s==null?void 0:s(d);a.onmessage=function(a){d.onmessage==null?void 0:d.onmessage(a),e.onmessage==null?void 0:e.onmessage(a)};c("promiseDone")(i({dispatch:b,logout:f,reregisterDevice:g,rotateCryptoAuthToken:h,worker:e}))},function(){b({tag:"InitOfflineQueueSyncComplete",value:void 0}),d("MAWMIC").endSuccess(!0)},function(){b({tag:"InitOfflineQueueSyncComplete",value:void 0})},"mawInit");d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").jobSerializers.handleFutureproofMsg({priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}));d("MAWInit").MAWInit.addIntAnnotation("endTimePageRelative",q());d("MAWInit").MAWInit.endSuccess();!d("MAWRestoreRewriteUtils").isOneDBEnabled()&&!c("gkx")("23906")&&c("promiseDone")(d("MAWBridge").getBridge().sendAndReceive("backend","getSecureThreadTotalCount"),function(a){d("MAWMICSafe").addIntAnnotation("totalSecureThreadCount",a);var b=d("MWChatInteraction").get(d("MWChatInteraction").MW_AUTO_CHAT_TAB_OPEN);b!=null&&c("InteractionTracingMetrics").addAnnotationInt(b,"totalSecureThreadCount",a)});d("MAWWaitForBackendSetup").resolveBackendSetup()}catch(b){var j=b,k="failure_during_armadillo_backend_setup";if(j instanceof d("MAWInit").MAWInitError){j=c("getErrorSafe")((a=j.error)!=null?a:b);k=(e=j.message)!=null?e:"Error: MAWInitError without message."}else{j=c("getErrorSafe")(b);k=((e=(a=j)==null?void 0:a.name)!=null?e:"Error:")+": "+((e=(a=j)==null?void 0:a.message)!=null?e:"Unknown")}a=k==="maw_appmutex_no_permission"&&document.visibilityState!=="visible";a?d("MAWInit").MAWInit.cancel(k,j):(d("MAWWaitForBackendSetup").rejectBackendSetup(b),d("MAWInit").MAWInit.fail(k,j));d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER,k);void m.load().then(function(a){return a("messenger_e2ee_web").catching(j).mustfix("MAW backend setup failed -- %s",k)});throw j}});return A.apply(this,arguments)}g.useArmadillo=a;g.workerProxy=u;g.setupArmadilloWithoutReact=e}),98);
__d("WebWorkerV2Resource",["TrustedTypesWebWorkerScriptURLPolicy","WebWorkerV2DynamicData","XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder","forEachObject","getAsyncParamsFromCurrentPageURI","getWorkerInitScriptSPINParams","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function i(){if(h!=null)return h;var a={get type(){h=!0}};try{new Worker("blob://",a)}finally{h=(a=h)!=null?a:!1;return h}}function a(a,b){b=(b=b)!=null?b:a.name;var e=i()?"module":"classic",f=c("getWorkerInitScriptSPINParams")();c("forEachObject")(c("getAsyncParamsFromCurrentPageURI")(),function(a,b){f.set(b,a)});var g=c("nullthrows")(c("XCometFBMultiSiteWebWorkerV2InitScriptControllerRouteBuilder").buildUri({worker_type:i()?"MODULE":"CLASSIC"}).addQueryParams(f)).toString(),h=new Worker(c("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(g),{name:b,type:e});c("promiseDone")(d("WebWorkerV2DynamicData").readDynamicDataForWorker(a).then(function(a){h.postMessage({type:"ww-hrp-init",hrp:a.hrp,js_env:a.js_env,is_dev:!1})}));return h}g.createDedicatedV2WebWorker=a}),98);
__d("MAWWebWorkerSingleton",["FBLogger","MAWCommonSetup","MAWInit","MAWMICSafe","MAWSetupBridge","MAWSetupWorker","MAWWebWorkerInstance","Promise","SharedWorkerBundleResource","WAResolvable","WebWorkerV2Resource","cr:6600","err","gkx","promiseDone","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("MAWWebWorkerInstance").destroyWorkerInstance,j=new(d("WAResolvable").Resolvable)();function k(a,b){c("FBLogger")("messenger_e2ee_web").mustfix("[MAWWebWorkerSingletonAsync Script Import Error: "+a+"]: %s:%s:%s:%s",JSON.stringify(b==null?void 0:b.message),b==null?void 0:b.lineno,b==null?void 0:b.colno,b==null?void 0:b.filename),d("MAWInit").MAWInit.fail("import_scripts_failure")}function l(a,b){var d;d=(d=b==null?void 0:b.message)!=null?d:"";if(d.indexOf("Failed to execute 'importScripts'")>=0){k(a,b);return}c("FBLogger")("messenger_e2ee_web").mustfix("[MAWWebWorkerSingletonAsync: "+a+"]: %s:%s:%s:%s",JSON.stringify(b==null?void 0:b.message),b==null?void 0:b.lineno,b==null?void 0:b.colno,b==null?void 0:b.filename)}function m(a){var b=a.data.annotations;if(b!=null){var e={allowEarlyAnnotations:!0};Object.keys(b).forEach(function(a){var c;c=(c=b[a])!=null?c:{};Object.entries(c).forEach(function(b){var c=b[0];b=b[1];c="sharedWorkerInit"+c.charAt(0).toUpperCase()+c.substring(1);a==="int"&&typeof b==="number"?d("MAWInit").MAWInit.addIntAnnotation(c,b,e):a==="string"&&typeof b==="string"?d("MAWInit").MAWInit.addStringAnnotation(c,b,e):a==="bool"&&typeof b==="boolean"&&d("MAWInit").MAWInit.addBoolAnnotation(c,b,e)})})}var f={allowEarlyLogPoints:!0};switch(a.type){case"start":d("MAWInit").MAWInit.logPoint("shared_worker_init_start",f);break;case"end":var g;g=(g=a.data)==null?void 0:g.errorName;g!=null?d("MAWInit").MAWInit.fail("shared_worker_init_failure",c("err")(g)):d("MAWInit").MAWInit.logPoint("shared_worker_init_end",f);break;case"point":g="shared_worker_init_"+a.data.event;d("MAWInit").MAWInit.logPoint(g,f);break}}function a(a){var e=d("MAWWebWorkerInstance").getWorkerInstancePromise();if(!e){d("MAWMICSafe").markEvent("maw_worker_create_start");var f=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();d("shouldUseMAWSharedWorker").logExposureForMAWSharedWorker();n();if(f){f=d("SharedWorkerBundleResource").createPushSafeSharedWebWorkerV2Async;e=f(b("cr:6600"),function(){c("promiseDone")(j.promise.then(function(){return i()}))},{onQPLEvent:m,reason:a}).then(function(a){a.addEventListener("error",function(a){return l("Shared Worker",a)});return a.port})}else{var g=c("gkx")("24003");e=(h||(h=b("Promise"))).resolve(d("WebWorkerV2Resource").createDedicatedV2WebWorker(b("cr:6600"))).then(function(a){a.onerror=function(a){return l("Dedicated Worker",a)};if(g){var b=function b(d){d=d==null?void 0:d.data;if(typeof d==="object")if((d==null?void 0:d.type)==="importScripts_error"){a.removeEventListener("message",b);var e=c("FBLogger")("messenger_e2ee_web");if((d==null?void 0:d.stack)!=null){var f;e=e.addMetadata("FBLOGGER","ERROR_STACK",(f=typeof (d==null?void 0:d.stack)==="string"?d==null?void 0:d.stack:JSON.stringify(d==null?void 0:d.stack))!=null?f:"no_stack")}f=(f=d==null?void 0:d.perfEntry)!=null?f:{};var g=f.duration,h=f.encodedBodySize,i=f.responseStatus;f=f.transferSize;e.mustfix("[MAWWebWorkerSingletonAsync Script Import Error Details]: %s:%s:%s || errCode:%s || respStatus:%s || encBodySize:%s || duration:%s || transferSize:%s",(d==null?void 0:d.source)!=null&&JSON.stringify(d==null?void 0:d.source)||"no_source",(d==null?void 0:d.error_name)!=null&&JSON.stringify(d==null?void 0:d.error_name)||"no_name",(d==null?void 0:d.error_msg)!=null&&JSON.stringify(d==null?void 0:d.error_msg)||"no_msg",(d==null?void 0:d.error_code)!=null&&JSON.stringify(d==null?void 0:d.error_code)||"no_error_code",(e=JSON.stringify(i))!=null?e:"none",(i=JSON.stringify(h))!=null?i:"none",(e=JSON.stringify(g))!=null?e:"none",(h=JSON.stringify(f))!=null?h:"none")}else(d==null?void 0:d.type)==="importScripts_success"&&a.removeEventListener("message",b)};a.addEventListener("message",b)}return a})}e=e.then(function(a){d("MAWMICSafe").markEvent("maw_worker_create_end");return a})}d("MAWWebWorkerInstance").setWorkerInstancePromise(e);return e}function e(){var a;a={doesWorkerExist:d("MAWWebWorkerInstance").doesWorkerExist,getOrSetupWorker:(a=d("MAWSetupWorker")).getOrSetupWorker,isSharedWorkerActive:a.isSharedWorkerActive,setupBridge:d("MAWSetupBridge").setupBridge,terminateWorker:a.terminateWorker,terminateWorkerPermanently:a.terminateWorkerPermanently};return d("MAWCommonSetup").setupArmadilloWithoutReact(a)}function f(a){i=a,j.resolve()}function n(){}g.createWorkerIfNone=a;g.setupArmadilloForComet=e;g.setOnCloseForWorkerInstance=f}),98);
__d("MAWWorkerBadStateRecovery",["HiddenTabDataUtils","QPLUserFlow","performanceNow","qpl","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("qpl")._(1056840252,"808"),j=0;function a(){var a=j++,b;function e(e){var f=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();b=(h||(h=c("performanceNow")))();var g=d("HiddenTabDataUtils").getHiddenTabDataForTimeInterval(0,b);c("QPLUserFlow").start(i,{annotations:{bool:{isSharedWorker:f,wasHiddenBefore:g.wasHidden(),wasHiddenOnStart:g.isHidden()},"int":{lastTimeHiddenBefore:g.lastTimeHidden(),totalHiddenTimeBefore:g.totalHiddenTime()},string:{trigger:"heartbeat_timeout",workerInitPageID:e}},instanceKey:a});f||c("QPLUserFlow").endFailure(i,"recovery_not_supported",{instanceKey:a})}function f(d){if(b==null)return;var e=p(b);c("QPLUserFlow").addPoint(i,"shared_worker_restart_"+d,{instanceKey:a});c("QPLUserFlow").addAnnotations(i,e,{instanceKey:a})}function g(){f("start")}function k(){f("success")}function l(d){if(b==null)return;var e=p(b);f("fail");c("QPLUserFlow").addAnnotations(i,babelHelpers["extends"]({},e,{string:{sharedWorkerRestartFailureReason:d}}),{instanceKey:a})}function m(d){if(b==null)return;var e=p(b);c("QPLUserFlow").addPoint(i,"heartbeat_still_fails",{instanceKey:a});c("QPLUserFlow").addAnnotations(i,babelHelpers["extends"]({},e,{string:{recentHeartbeatFailureReason:d}}),{instanceKey:a})}function n(d){if(b==null)return;var e=p(b);c("QPLUserFlow").endFailure(i,d,{annotations:e,instanceKey:a})}function o(){if(b==null)return;var d=p(b);c("QPLUserFlow").endSuccess(i,{annotations:d,instanceKey:a})}function p(a){a=d("HiddenTabDataUtils").getHiddenTabDataForTimeInterval(a,(h||(h=c("performanceNow")))());return{bool:{wasHiddenDuringRecovery:a.wasHidden(),wasHiddenOnRecoveryEnd:a.isHidden()},"int":{lastTimeHiddenDuringRecovery:a.lastTimeHidden(),totalHiddenTimeDuringRecovery:a.totalHiddenTime()}}}return{endFailure:n,endFailureSharedWorkerRestart:l,endSuccess:o,endSuccessSharedWorkerRestart:k,postRestartHeartbeatsFailed:m,sharedWorkerRestartAddPoint:f,start:e,startSharedWorkerRestart:g}}g.buildWorkerBadStateRecoveryQPLLogger=a}),98);
__d("MAWWorkerWatchdog",["CurrentUser","MAWBridgeLoggingUtils","MAWBridgeSendAndReceive","MAWIssueNewUserVisibleErrors","MAWSharedWorkerReboot","MAWWaitForBackendSetup","MAWWorkerBadStateRecovery","Promise","clearInterval","err","gkx","justknobx","promiseDone","setInterval","setTimeout","shouldUseMAWSharedWorker","vc-tracker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("gkx")("24001"),j=c("justknobx")._("1008"),k=c("justknobx")._("1369"),l=k/2,m=!1,n=!1,o=function(){};function a(){return n}function p(){if(!n||!i)return;o();n=!1}function q(a,b){m=!1;return d("MAWSharedWorkerReboot").rebootSharedWorker(a.vaultMaterials,a.onWorkerReconnect,a.onConnectToExistingWorker,a.onTerminateWorker,b)}function r(a){var b;(b=d("MAWIssueNewUserVisibleErrors")).issueError(b.MAWGeneralErrorMsgBody,b.MAWGeneralErrorMsgTitle,b.MAWUserVisibleErrorPresentationType.BANNER);return c("err")("Cannot recover the worker: "+a)}function s(){return(h||(h=b("Promise"))).race([d("MAWBridgeSendAndReceive").sendAndReceive("backend",d("MAWBridgeLoggingUtils").HEARTBEAT_ROUTE),new h(function(a,b){c("setTimeout")(function(){b(c("err")("Armadillo web worker heartbeat timed out."))},l)})]).then(function(a){return a===!0},function(a){return!1})}function t(){var a=null;return new(h||(h=b("Promise")))(function(b,e){var f=c("setInterval")(function(){c("promiseDone")(d("MAWBridgeSendAndReceive").sendAndReceive("backend",d("MAWBridgeLoggingUtils").HEARTBEAT_ROUTE).then(function(d){d?(c("clearInterval")(f),b()):a="Wrong heartbeat result: "+d.toString()},function(b){a="Heartbeat failure: "+b.message}))},k);c("setTimeout")(function(){var b;c("clearInterval")(f);e(c("err")((b=a)!=null?b:"Did not get heartbeat response on time"))},j)})}function u(a,e){return new(h||(h=b("Promise")))(function(b,f){var g=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();d("shouldUseMAWSharedWorker").logExposureForMAWSharedWorker();g||f(r("Worker recovery is supported for shared worker only."));c("CurrentUser").isLoggedInNow()||f(r("User is not logged in, aborting recovery"));return q(a,e).then(function(){return t()},function(a){e.endFailureSharedWorkerRestart(a.message),f(r(a.message))}).then(function(){return b()},function(a){e.postRestartHeartbeatsFailed(a.message),f(r(a.message))})})}function v(){var a=c("vc-tracker").performanceNow();return c("vc-tracker").VisibilityState.wasHidden(a-1,a)}function e(a){if(n||!i)return;var b=c("setInterval")(function(){if(!m||v())return;c("promiseDone")(s(),function(b){if(!b){d("MAWBridgeLoggingUtils").logRecentBridgeEvents();var e=d("MAWWorkerBadStateRecovery").buildWorkerBadStateRecoveryQPLLogger();e.start(a.initPageID);c("promiseDone")(u(a,e),function(){e.endSuccess(),m=!0},function(a){e.endFailure(a.message),p()})}})},k);d("MAWWaitForBackendSetup").runAfterBackendSetup(function(){m=!0},d("MAWBridgeLoggingUtils").HEARTBEAT_ROUTE);o=function(){a.onTerminateWorker(),c("clearInterval")(b)};n=!0}g.isWatchdogRunning=a;g.terminateWatchdog=p;g.startWatchdog=e}),98);
__d("startMAWWorkerWatchdog",["CurrentUser","MAWBridgeLoggingUtils","MAWBridgeSendAndReceive","MAWIssueNewUserVisibleErrors","MAWSharedWorkerReboot","MAWWorkerBadStateRecovery","Promise","clearInterval","err","justknobx","promiseDone","setInterval","setTimeout","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("justknobx")._("1369"),j=i/2,k=!1,l=null;function a(a,e,f,g,m){var n=c("setInterval")(function(){c("promiseDone")((h||(h=b("Promise"))).race([d("MAWBridgeSendAndReceive").sendAndReceive("backend","getWorkerHeartbeat"),new h(function(a,b){c("setTimeout")(function(){b(c("err")("Armadillo web worker heartbeat timed out. "))},j)})]).then(function(a){if(!a){(a=d("MAWIssueNewUserVisibleErrors")).issueError(a.MAWGeneralErrorMsgBody,a.MAWGeneralErrorMsgTitle,a.MAWUserVisibleErrorPresentationType.BANNER);g();c("clearInterval")(n)}if(k){(a=l)==null?void 0:a.endSuccess()}k=!1})["catch"](function(b){l=d("MAWWorkerBadStateRecovery").buildWorkerBadStateRecoveryQPLLogger();l.start(m);d("MAWBridgeLoggingUtils").logRecentBridgeEvents();var h=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();d("shouldUseMAWSharedWorker").logExposureForMAWSharedWorker();if(h&&!k&&c("CurrentUser").isLoggedInNow())k=!0,c("promiseDone")(d("MAWSharedWorkerReboot").rebootSharedWorker(a,e,f,g,l));else{if(k){(h=l)==null?void 0:h.endFailure(b.message)}d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER);c("clearInterval")(n);g();throw b}}))},i);return function(){g(),c("clearInterval")(n)}}g["default"]=a}),98);
__d("MAWGetDBVersionForTest",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){if(!c("gkx")("652"))return;var a=new URL(document.location.href);a=a.searchParams.get("db_version");if(a==null)return;if(a==="current"||a==="latest")return a;a=parseInt(a,10);if(Number.isInteger(a))return Number(a)}function b(){if(!c("gkx")("1159"))return;var a=new URL(document.location.href);a=a.searchParams.get("db_migration_state");if(a!=null&&(a==="dexie"||a==="restore"))return a}g.getDbVersionForTest=a;g.getDbMigrationState=b}),98);
__d("MAWCommonSetupWorker",["Deferred","MAWCurrentUser","MAWGetDBVersionForTest","MAWInit","MAWSetupWorker","MessengerWebInitData","WADevToolMessageChannel","WALogger","WorkerClient","WorkerMessagePort","err","gkx","pageID"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Terminating worker and rebooting..."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker receive invalid message: ",""]);i=function(){return a};return a}b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var e;e=a.call(this,b,c)||this;e.onmessage=null;e.$BridgeAdapter$p_1=b;d("WorkerClient").init(babelHelpers.assertThisInitialized(e));e.onUnhandledMessage.add(function(a){e.onmessage&&e.onmessage({data:a})});return e}var c=b.prototype;c.getBridgePort=function(){return this};return b}(d("WorkerMessagePort").WorkerSyncedMessagePort);function a(a,b,e,f){var g=new(c("Deferred"))();a.addMessageListener("worker-setup",function(b){if(b.setupHash!==c("pageID"))return;if(b==null||b.type!=="worker-setup"){d("WALogger").WARN(i(),b);return}if(b.status==="success")g.resolve(a.getBridgePort());else if(b.status==="failure"){var j;g.reject(c("err")((j=b.msg)!=null?j:"Encountered an error setting up the armadillo web worker"))}else if(b.status==="already-setup")if(b.action==="no-action"){g.resolve(a.getBridgePort());f();return}else if(b.action==="reboot-required"&&b.setupHash===c("pageID")){d("WALogger").DEV(h());d("MAWSetupWorker").terminateWorker("reboot required");d("MAWInit").MAWInit.addBoolAnnotation("workerRebootRequired",!0);return e().then(function(a){return g.resolve(a)})["catch"](function(a){return g.reject(a)})}else throw c("err")("received invalid action for worker-setup:already-setup: "+b.action);else throw c("err")("received invalid message for worker")});a.addMessageListener("worker-setup-ack",function(a){if(a.setupHash!==c("pageID"))return;d("MAWInit").MAWInit.logPoint("maw_init_worker_ack")});if(c("gkx")("3282")){var j=d("WADevToolMessageChannel").createNewChannel();a.postMessage({content:{devToolMessageChannelPort2:j.port2,fbId:d("MAWCurrentUser").getID(),sessionId:c("MessengerWebInitData").sessionId,testDbMigrationState:d("MAWGetDBVersionForTest").getDbMigrationState(),testDbVersion:d("MAWGetDBVersionForTest").getDbVersionForTest(),vaultMaterials:b},setupHash:c("pageID"),type:"worker-setup"},[j.port2])}else a.postMessage({content:{fbId:d("MAWCurrentUser").getID(),sessionId:c("MessengerWebInitData").sessionId,testDbMigrationState:d("MAWGetDBVersionForTest").getDbMigrationState(),testDbVersion:d("MAWGetDBVersionForTest").getDbVersionForTest(),vaultMaterials:b},setupHash:c("pageID"),type:"worker-setup"});return g.getPromise()}g.BridgeAdapter=b;g.initWorker=a}),98);
__d("MAWBridgeInitOfflineQueueSyncStartHandler",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MessengerLogHistory").__setRef("MAWBridgeInitOfflineQueueSyncStartHandler");function a(){h.onReady(function(a){a=a.getInstance("maw_setup");a.debug("Init Offline Queue Sync Start")})}g.call=a}),98);
__d("MAWEBRestoreStatus",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["IN_PROGRESS","RESTORE_COMPLETED"]);f.EBInitialThreadsRestoreStatus=a}),66);
__d("MAWStateContextProvider.react",["MAWBridgeInitOfflineQueueSyncCompleteHandler","MAWBridgeInitOfflineQueueSyncStartHandler","MAWEBRestoreStatus","MAWSharedProtocolQueueConst","MAWStateContext.react","react","useUnsafeRef_DEPRECATED"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useCallback,l=b.useEffect,m=b.useMemo,n=b.useReducer,o=function(a,b){return Object.entries(a).filter(function(a){var c,d=a[0];a=a[1];return((c=b[d])==null?void 0:c.chatStatus)!==a.chatStatus||((c=b[d])==null?void 0:c.snippetStatus)!==a.snippetStatus})},p=function(a,b){return a.reduce(function(a,b){var c=b[0];b=b[1];a[c]={chatStatus:b.chatStatus,snippetStatus:b.snippetStatus};return a},b)},q=function(a,b){switch(b.tag){case"OptimisticSendMessage":var c;return babelHelpers["extends"]({},a,{messageLatencies:babelHelpers["extends"]({},a.messageLatencies,(c={},c[b.optimisticMsgId]={sent:b.timestamp},c))});case"NewMsg":case"MsgUpdated":var e,f;c=b.value.ack;var g=b.value.msgId;e=(e=b.value.offlineMsg)==null?void 0:e.msgId;e!=null&&a.messageLatencies[e]!=null&&(a.messageLatencies[g]=a.messageLatencies[e],delete a.messageLatencies[e]);e=a.messageLatencies[g];if((e==null?void 0:e.sent)!=null&&(e==null?void 0:e.acked)!=null)return a;e=(e==null?void 0:e.sent)||Date.now();c=c!==0?Date.now():void 0;return babelHelpers["extends"]({},a,{messageLatencies:babelHelpers["extends"]({},a.messageLatencies,(f={},f[g]={acked:c,sent:e},f))});case"InitOfflineQueueSyncProgress":g=b.value;return babelHelpers["extends"]({},a,{offlineQueueProgressDownloaded:g});case"InitOfflineQueueConsumerSyncProgress":c=b.value;e=c.chatJidStatus;f=c.processed;g=a.offlineQueueThreadStatus||{};c=o(e,g);return babelHelpers["extends"]({},a,{offlineQueueProgressProcessed:f,offlineQueueThreadStatus:c.length===0?g:p(c,babelHelpers["extends"]({},g))});case"InitOfflineQueueSyncStart":d("MAWBridgeInitOfflineQueueSyncStartHandler").call();e=b.value;return babelHelpers["extends"]({},a,{offlineQueueCount:e});case"InitOfflineQueueSyncComplete":d("MAWBridgeInitOfflineQueueSyncCompleteHandler").call();f=b.value;c=a.offlineQueueThreadStatus||{};g=f!=null?o(f,c):null;return babelHelpers["extends"]({},a,{offlineQueueSyncState:d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Complete,offlineQueueThreadStatus:g==null||g.length===0?c:p(g,babelHelpers["extends"]({},c))});case"UnArchivedSelfDeviceChangeAlerts":e=b.value;return babelHelpers["extends"]({},a,{unArchivedSelfDeviceChangeAlerts:e});case"EphemeralSettingsUpdatedForUI":f=b.value;g=f.chatJid;c=f.ephemeralSettingArgs;e=c.ephemeralExpirationInSec;f=c.ephemeralLastUpdatedOrSetTimestamp;c=g;return babelHelpers["extends"]({},a,{ephemeralSettings:babelHelpers["extends"]({},a.ephemeralSettings,(g={},g[c]={ephemeralExpirationInSec:e,ephemeralLastUpdatedOrSetTimestamp:f},g))});case"ClearEphemeralSettings":return babelHelpers["extends"]({},a,{ephemeralSettings:{}});case"eBInitialThreadsRestoreStatus":c=b.value;e=a.eBInitialThreadsRestoreStatus;var h=c.reduce(function(a,b){b=b.threadId;return babelHelpers["extends"]({},a,(a={},a[b]=d("MAWEBRestoreStatus").EBInitialThreadsRestoreStatus.IN_PROGRESS,a))},{});Object.keys(e).forEach(function(a){if(!h[a]){var b;h=babelHelpers["extends"]({},h,(b={},b[a]=d("MAWEBRestoreStatus").EBInitialThreadsRestoreStatus.RESTORE_COMPLETED,b))}});return babelHelpers["extends"]({},a,{eBInitialThreadsRestoreStatus:h})}return a};function a(a){a=a.children;var b=n(q,d("MAWStateContext.react").initialState),c=b[0],e=b[1],f=m(function(){return new Set()},[]);b=m(function(){return{dispatch:e,state:c,subscriptions:f}},[c,e,f]);var g=r(b),h=k(function(){return g.current},[g]);l(function(){f==null?void 0:f.forEach(function(a){return a(c)})},[c,f]);return j.jsx(d("MAWStateContext.react").MAWStateContext.Provider,{value:b,children:j.jsx(d("MAWStateContext.react").MAWNonRerenderingStateContext.Provider,{value:h,children:a})})}a.displayName=a.name+" [from "+f.id+"]";function r(a){var b=(h||(h=c("useUnsafeRef_DEPRECATED")))(a);b.current=a;return b}g["default"]=a}),98);
__d("MAWOccamadilloOnMutexChange",["I64","LSDefaultSyncGroups","LSIntEnum","LSSyncGroupsUtils","Promise","WALogger","isOccamadilloResumeSyncEnabled","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Resetting sync cursor and network request"]);k=function(){return a};return a}function l(a){var e=d("LSDefaultSyncGroups").e2eeMetadataSyncGroup;if(!c("isOccamadilloResumeSyncEnabled")()&&e!=null)return a.sync_groups.put(babelHelpers["extends"]({},d("LSSyncGroupsUtils").defaultSyncGroup,{groupId:(j||(j=d("LSIntEnum"))).ofNumber(e.groupId)}));else return(h||(h=b("Promise"))).resolve()}function m(a){if(!c("isOccamadilloResumeSyncEnabled")())return a.network_requests.put({epochId:void 0,failureCount:(i||(i=d("I64"))).zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:i.zero,lastSyncRequestTimestampMs:i.zero,networkTaskIdentifier:void 0,syncDatabaseId:(j||(j=d("LSIntEnum"))).ofNumber(95),taskQueueName:""});else return(h||(h=b("Promise"))).resolve()}function a(a){d("WALogger").LOG(k()),c("promiseDone")(a.runInTransaction(function(a){return(h||(h=b("Promise"))).all([l(a),m(a)])},"readwrite"))}g.onOccamadilloMutexChange=a}),98);
__d("MAWReinit",["ExecutionEnvironment","MAWCurrentUser","MAWEBSwitch","MAWGetStorageQplAnnotations","QPLUserFlow","QuickPerformanceLogger","UserTimingUtils","WALogger","asyncToGeneratorRuntime","gkx","performanceNow","qpl","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to get storage info"]);k=function(){return a};return a}var l=c("qpl")._(25310984,"169");function a(a){var e=a!=null?{instanceKey:a}:void 0,f=!1,g=!1;function m(){if(g)return;g=!0;c("QPLUserFlow").start(l,babelHelpers["extends"]({cancelOnUnload:!0,onFlowTimeout:function(){f=!0},timeoutInMs:(h||(h=c("ExecutionEnvironment"))).canUseDOM?6e4:0},e));void d("MAWGetStorageQplAnnotations").getStorageQplAnnotations().then(function(a){c("QPLUserFlow").addAnnotations(l,a)})["catch"](function(){d("WALogger").ERROR(k())});u()}function n(a){if(!g||f)return;u();c("QPLUserFlow").addPoint(l,a,e)}function o(a,b){var d;if(!g||f)return;c("QPLUserFlow").addAnnotations(l,{bool:(d={},d[a]=b,d)})}function p(a,b){var d;if(!g||f)return;c("QPLUserFlow").addAnnotations(l,{string:(d={},d[a]=b,d)})}function q(a,b){var d;if(!g||f)return;c("QPLUserFlow").addAnnotations(l,{"int":(d={},d[a]=b,d)})}function r(a){u(),f=!0,c("QPLUserFlow").addAnnotations(l,{string:{failReason:a}},e),c("QPLUserFlow").endFailure(l,"maw_init_fail",e),t=!1}function s(a){u(),f=!0,t=!1,c("QPLUserFlow").addAnnotations(l,{string:{dropReason:a}},e),(i||(i=c("QuickPerformanceLogger"))).markerDrop(l)}var t=!1;function u(){if(t)return;t=!0;c("QPLUserFlow").addAnnotations(l,{bool:{armadillo_init_sync_api_improvements:c("gkx")("24025"),is_eb_enabled:c("MAWEBSwitch").isEnabled(),isArmadilloPublicLaunchUser:c("gkx")("23405"),isTlcPublicUser:d("MAWCurrentUser").isTlcPublicUser(),useSharedWorker:d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()}})}function v(a){u(),f=!0,c("QPLUserFlow").addAnnotations(l,{string:{cancelReason:a}},e),c("QPLUserFlow").endCancel(l,e),t=!1}function w(){u(),f=!0,c("QPLUserFlow").endSuccess(l,e),t=!1}function x(a,b){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(j||(j=c("performanceNow")))(),f=a+"_start",g=a+"_end";n(f);f=(yield b());n(g);c("gkx")("24026")&&d("UserTimingUtils").measureModern(a,{end:(j||(j=c("performanceNow")))(),start:e});return f});return y.apply(this,arguments)}return{addBoolAnnotation:o,addIntAnnotation:q,addStringAnnotation:p,cancel:v,drop:s,endSuccess:w,fail:r,logPoint:n,measurePerformance:x,start:m}}g.getMAWReinit=a}),98);
__d("MAWReinitWorker",["MAWCommonBackendSetup","MAWOccamadilloOnMutexChange","MAWReinit","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.allTablesPersisted,e=a.db,f=a.dispatch,g=a.dispatchClearEphemeralSettings,h=a.getOrSetupWorker,i=a.instanceKey,j=a.logout,k=a.reregisterDevice,l=a.rotateCryptoAuthToken,m=a.setupBridge;a=a.workerCreateReason;i=d("MAWReinit").getMAWReinit(i);var n=function(){f({tag:"InitOfflineQueueSyncComplete",value:void 0})};yield d("MAWCommonBackendSetup").setupArmadilloBackend(h,i,function(a){c("promiseDone")(m({dispatch:f,logout:j,reregisterDevice:k,rotateCryptoAuthToken:l,worker:a}).then(function(){b||d("MAWOccamadilloOnMutexChange").onOccamadilloMutexChange(e)}))},n,n,a);i.endSuccess();g()});return h.apply(this,arguments)}g["default"]=a}),98);
__d("MAWSetupMutex",["FBLogger","LocalStorageMutex","MAWAppMutex","MAWBridge","MAWClientConsistencyRefresh","MAWInit","MAWIssueNewUserVisibleErrors","MAWLocalStorage","MAWMIC","MAWReinitWorker","MAWStateContext.react","MAWWaitForBackendSetup","QPLUserFlow","Run","WALoggerDeferred","asyncToGeneratorRuntime","isInstamadillo","qpl","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["AppMutex - Shouldn't reinitialize, shared worker is active on a different tab"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["AppMutex - Shouldn't reinitialize, worker already exists"]);k=function(){return a};return a}e=i||d("react");var l=e.useCallback,m=e.useEffect,n=e.useMemo,o=c("FBLogger")("messenger_e2ee_web"),p=!1,q=0;function r(a,b,c){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(document.visibilityState!=="visible")return!1;a=a();var f=window.indexedDB!=null,g=d("MAWLocalStorage").isLocalStorageAvailable();if(a){void d("WALoggerDeferred").DEV(k());return!1}if(!f||!g)return!1;if(yield b()){void d("WALoggerDeferred").DEV(j());c("MAWClientConsistencyRefresh")("worker_mismatch");e();return!1}return!0});return s.apply(this,arguments)}function a(a,e){var f=a.doesWorkerExist,g=a.getOrSetupWorker,i=a.isSharedWorkerActive,j=a.logout,k=a.reregisterDevice,s=a.rotateCryptoAuthToken,t=a.setupBridge,u=a.terminateWorker,v=a.terminateWorkerPermanently,w=n(function(){return d("MAWAppMutex").use()},[]),x=(h||(h=c("useReStore")))(),y=d("MAWStateContext.react").useDispatchClearEphemeralSettings(),z=x.persistenceTypes.includes("indexeddb"),A=l(function(a){var b=w.takeoverFilter(a);if(!b||a.newValue===d("LocalStorageMutex").THIS_TAB||a.newValue==="")return;!z&&!c("isInstamadillo")()&&d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"DropAllSecureThreads",value:void 0}]});u("MAWSetupMutexV2:handleStoreChange");d("MAWWaitForBackendSetup").resetBackendSetup();d("MAWMIC").cancel("workerMutexLost");d("MAWInit").MAWInit.cancel("workerMutexLost");w.onMutexDeath()},[w,z,u]),B=l(function(){u("MAWSetupMutexV2:handleUnload"),w.onMutexDeath()},[w,u]),C=l(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield r(f,i,v));if(!a||p)return;p=!0;q++;try{yield c("MAWReinitWorker")({allTablesPersisted:z,db:x,dispatch:e,dispatchClearEphemeralSettings:y,getOrSetupWorker:g,instanceKey:q,logout:j,reregisterDevice:k,rotateCryptoAuthToken:s,setupBridge:t,workerCreateReason:"mawReinitSetupMutex"}),d("MAWWaitForBackendSetup").resolveBackendSetup(),d("MAWIssueNewUserVisibleErrors").deleteUserVisibleErrorByJSErrorMessage("maw_appmutex_no_permission")}catch(a){o.mustfix("AppMutex - failed to reinitialize worker: "+a.message.concat(" (",a.error,")")),o.catching(a),c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"failed_to_reinitialize_worker",{annotations:{string:{error:a.message.concat(": ",a.error)}},error:a,instanceKey:q})}finally{p=!1}}),[z,x,e,y,f,g,i,j,k,s,t,v]);m(function(){window.addEventListener("storage",A);var a=d("Run").onBeforeUnload(B,!1),b=d("Run").onUnload(B);window.addEventListener("visibilitychange",C);return function(){window.removeEventListener("storage",A),a.remove(),b.remove(),window.removeEventListener("visibilitychange",C)}},[A,B,C])}g.useMutex=a}),98);
__d("MAWSetupMutex.react",["MAWSetupMutex","react"],(function(a,b,c,d,e,f,g){"use strict";var h;h||d("react");function a(a){var b=a.dispatch;a=a.platformSetupUtils;d("MAWSetupMutex").useMutex(a,b);return null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSGetThreadDataFromTam.nop",["I64","LSMessagingThreadTypeUtil","LSResult","LSShape","LSVec","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){b=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.threads).filter(function(a){a=a.threadType;return d("LSMessagingThreadTypeUtil").isSecure(a)}).take((h||(h=d("I64"))).to_int32(e))));a=b.map(function(a,b){var c=a.lastActivityTimestampMs,e=a.lastReadWatermarkTimestampMs,f=a.threadKey;a=a.threadType;return d("LSShape").ofRecord({client_thread_pk:f,display_timestamp_ms:c,is_group_thread:d("LSMessagingThreadTypeUtil").isGroup(a),last_activity_timestamp_ms:c,last_read_watermark_timestamp_ms:e,server_thread_key:f,sort_order:(h||(h=d("I64"))).of_int32(b)})});return c("LSResult")(c("LSVec").ofArray(a))});function e(b,c,d){return a.apply(this,arguments)}return e}();g["default"]=a}),98);
__d("LSScheduleOccamThreadsIntegrityChecker",["LSGetCursor","LSGetThreadDataFromTam.nop","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.storedProcedure(b("LSGetCursor"),c.i64.cast([0,95])).then(function(a){return a=a,d[0]=a[0],a})},function(b){return d[1]=c.createArray(),d[2]=c.createArray(),c.i64.neq(a[1],void 0)?d[3]=a[1]:d[3]=c.i64.cast([0,20]),c.forEach(c.db.table(220).fetch([[[c.i64.cast([0,95]),c.i64.cast([0,0])]]]),function(a){a=a.item;return d[10]=a.minLastActivityTimestampMs,d[9]=new c.Map(),d[9].set("has_more_before",a.hasMoreBefore),d[9].set("is_loading_before",a.isLoadingBefore),d[9].set("min_last_activity_timestamp_ms",d[10]),d[9].set("min_thread_key",a.minThreadKey),d[9].set("parent_thread_key",c.i64.cast([0,0])),d[11]=(d[2].push(d[9]),d[2]),c.forEach(c.islc(c.filter(c.db.table(9).fetch([[[{gte:d[10]}]],"lastActivityTimestampMs"]),function(a){return c.i64.ge(a.lastActivityTimestampMs,d[10])&&c.i64.eq(a.syncGroup,c.i64.cast([0,95]))&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),0,c.i64.to_float(d[3])),function(a){a=a.item;return d[11]=new c.Map(),d[11].set("authority_level",a.authorityLevel),d[11].set("folder_name",a.folderName),d[11].set("last_activity_timestamp_ms",a.lastActivityTimestampMs),d[11].set("last_read_watermark_timestamp_ms",a.lastReadWatermarkTimestampMs),d[11].set("thread_key",a.threadKey),d[12]=(d[1].push(d[11]),d[1])})})},function(a){return d[4]=c.createArray(),c.nativeOperation(b("LSGetThreadDataFromTam.nop"),d[3]).then(function(a){return a=a,d[5]=a[0],a})},function(a){return d[6]=c.createArray(),d[7]=new c.Map(),d[7].set("cursor",d[0]),d[7].set("mi_act_mapping_columns_for_integrity_check",d[6]),d[7].set("occam_threads_columns_for_integrity_check",d[1]),d[7].set("threads_ranges_columns_for_integrity_check",d[2]),d[7].set("tam_threads_columns_for_integrity_check",d[5]),d[8]=c.toJSON(d[7]),c.storedProcedure(b("LSIssueNewTask"),"occam-threads-integrity-check",c.i64.cast([0,701]),d[8],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSScheduleOccamThreadsIntegrityCheckerStoredProcedure",["LSScheduleOccamThreadsIntegrityChecker","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){b===void 0&&(b={});var d=[];d[0]=b.delayMs;d[1]=b.maxThreadCount;return c("LSScheduleOccamThreadsIntegrityChecker").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MWChatFetchThreadMessageCounts",["asyncToGeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";function a(a){return g.apply(this,arguments)}function g(){g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return{}});return g.apply(this,arguments)}function c(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return 0});return h.apply(this,arguments)}f.fetchArmadilloThreadMessageCounts=a;f.fetchArmadilloThreadMessageCount=c}),66);
__d("globalCryptoSubtle",[],(function(a,b,c,d,e,f){"use strict";b=a.crypto.subtle;c=b;f["default"]=c}),66);
__d("useDataLossStatisticsStorageListener",["LSDatabaseSingleton","MWChatFetchThreadMessageCounts","Visibility","WebStorage","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(i||d("react")).useEffect,l="armadillo_msgr_data_loss_stats";function a(){k(function(){var a;window.setTimeout(function(){a=c("Visibility").addListener(c("Visibility").HIDDEN,function(){c("promiseDone")((j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(a){return d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCounts(a).then(function(a){(h||(h=c("WebStorage"))).setItemGuarded(h.getLocalStorage(),l,JSON.stringify(a))})}))})},3e4);return function(){var b;(b=a)==null?void 0:b.remove()}},[])}g.DATA_LOSS_STATISTICS_STORAGE_KEY=l;g.useDataLossStatisticsStorageListener=a}),98);
__d("MWChatDataLossCheckerUtil",["FBLogger","I64","LSDatabaseSingleton","MAWBridgeSendAndReceive","MAWMiActOnActThreadReady","MWChatFetchThreadMessageCounts","Promise","QuickPerformanceLogger","WebStorage","asyncToGeneratorRuntime","gkx","globalCryptoSubtle","promiseDone","qpl","useDataLossStatisticsStorageListener"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;function m(a){a=Array.from(new Uint8Array(a));return a.map(function(a){return a.toString(16).padStart(2,"0")}).join("")}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(c("gkx")("24059"))return a;var b=new TextEncoder();b=b.encode(a).buffer;a=(yield c("globalCryptoSubtle").digest("SHA-256",b));return m(a)}catch(a){return a}});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.currentIDBCnt,d=a.currentMsgCnt,e=a.logThreadId,f=a.prevMsgCnt,g=a.qplEvent;a=a.threadId;if(e!=null&&e){e=(yield n(a));b!=null?((l||(l=c("QuickPerformanceLogger"))).markerStartFromNavStart(g),l.markerAnnotate(g,{"int":{current_idb_count:b,current_msg_count:d,prev_msg_count:f},string:{encrypted_threadId:e}}),l.markerEnd(g,2)):((l||(l=c("QuickPerformanceLogger"))).markerStartFromNavStart(g),l.markerAnnotate(g,{"int":{current_msg_count:d,prev_msg_count:f},string:{encrypted_threadId:e}}),l.markerEnd(g,2))}else b!=null?((l||(l=c("QuickPerformanceLogger"))).markerStartFromNavStart(g),l.markerAnnotate(g,{"int":{current_idb_count:b,current_msg_count:d,prev_msg_count:f}}),l.markerEnd(g,2)):((l||(l=c("QuickPerformanceLogger"))).markerStartFromNavStart(g),l.markerAnnotate(g,{"int":{current_msg_count:d,prev_msg_count:f}}),l.markerEnd(g,2))});return q.apply(this,arguments)}function r(a){var b=a.currentMsgCnt,e=a.logThreadId,f=a.prevMsgCnt,g=a.qplEvent,h=a.threadId;return!c("gkx")("24060")?p({currentMsgCnt:b,logThreadId:e,prevMsgCnt:f,qplEvent:g,threadId:h}):(i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(a){return d("MAWMiActOnActThreadReady").onActThreadReady(a.tables,(k||(k=d("I64"))).of_string(h),"MWChatDataLossCheckerUtil",function(a,i,j){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","fetchArmadilloThreadMessageCount",{threadId:i}).then(function(a){return p({currentIDBCnt:a,currentMsgCnt:b,logThreadId:e,prevMsgCnt:f,qplEvent:g,threadId:h})})["catch"](function(a){c("FBLogger")("labyrinth").catching(a).warn("Failed to fetch IndexDB message count");return p({currentMsgCnt:b,logThreadId:e,prevMsgCnt:f,qplEvent:g,threadId:h})})})})}function a(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{a=(yield d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCount(a,b));var e=(j||(j=c("WebStorage"))).getAllowlistedKeyFromLocalStorage(d("useDataLossStatisticsStorageListener").DATA_LOSS_STATISTICS_STORAGE_KEY);if(e==null)return{isThreadMissingMessages:!1};e=JSON.parse(e);b=(e=e[(k||(k=d("I64"))).to_string(b)])!=null?e:null;if(b==null)return{isThreadMissingMessages:!1};return b>0&&a===0?{currCount:a,isThreadMissingMessages:!0,prevCount:b}:{isThreadMissingMessages:!1}}catch(a){c("FBLogger")("labyrinth").catching(a).warn("Failed to check for data loss");return{isThreadMissingMessages:!1}}});return s.apply(this,arguments)}function e(a){a=d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCounts(a);a.then(function(a){var e=(j||(j=c("WebStorage"))).getAllowlistedKeyFromLocalStorage(d("useDataLossStatisticsStorageListener").DATA_LOSS_STATISTICS_STORAGE_KEY);if(e==null)return(h||(h=b("Promise"))).resolve(null);e=JSON.parse(e);return(h||(h=b("Promise"))).resolve({current:a,previous:e})}).then(function(a){if(a==null)return(h||(h=b("Promise"))).resolve();var c=a.current;a=a.previous;return t(a,c)})["catch"](function(a){return c("FBLogger")("labyrinth").catching(a).warn("Failed to check for data loss")});return a.then(function(){})}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,d){var e=[];for(var f in a)Object.prototype.hasOwnProperty.call(d,f)&&e.push(f);f=[];for(var g=0;g<e.length;g++){var i=e[g],j={currentMsgCnt:d[i],prevMsgCnt:a[i],threadId:i};a[i]>0&&d[i]===0?(f.push(r(babelHelpers["extends"]({},j,{qplEvent:c("qpl")._(717553665,"1183")}))),f.push(r(babelHelpers["extends"]({},j,{logThreadId:!0,qplEvent:c("qpl")._(717562243,"1358")})))):(f.push(r(babelHelpers["extends"]({},j,{qplEvent:c("qpl")._(717553666,"1184")}))),f.push(r(babelHelpers["extends"]({},j,{logThreadId:!0,qplEvent:c("qpl")._(717556541,"1361")}))))}yield (h||(h=b("Promise"))).all(f)});return u.apply(this,arguments)}function f(a){var b=function(b){c("promiseDone")(n(b).then(function(d){(l||(l=c("QuickPerformanceLogger"))).markerStartFromNavStart(c("qpl")._(717567419,"1383")),l.markerAnnotate(c("qpl")._(717567419,"1383"),{string:{encryptedThreadId:d,msg_count:a[b].toString()}}),l.markerEnd(c("qpl")._(717567419,"1383"),2)}))};for(var d in a)b(d)}g.qplLog=r;g.checkIsThreadMissingMessages=a;g.fetchCountsAndLogDataLoss=e;g.logThreadCompleteDataLoss=t;g.logLocalStatistics=f}),98);
__d("useOnMawSetupComplete.react",["promiseDone","react","waitForMAWMIC"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(a,b,e){b===void 0&&(b=function(){}),i(function(){var e=!1;c("promiseDone")(d("waitForMAWMIC").promise.then(function(){if(e)return;a()})["catch"](function(){if(e)return;b()}));return function(){e=!0}},e)}g.useOnMawSetupComplete=a}),98);
__d("useDataLossChecker",["FBLogger","I64","LSDatabaseSingleton","LSFactory","LSScheduleOccamThreadsIntegrityCheckerStoredProcedure","MWChatDataLossCheckerUtil","asyncToGeneratorRuntime","gkx","justknobx","promiseDone","useDataLossStatisticsStorageListener","useOnMawSetupComplete.react"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(){d("useDataLossStatisticsStorageListener").useDataLossStatisticsStorageListener(),d("useOnMawSetupComplete.react").useOnMawSetupComplete(function(){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton);yield d("MWChatDataLossCheckerUtil").fetchCountsAndLogDataLoss(a)})()),j()},j(),[])}function j(){try{var a=c("gkx")("24061"),e=c("justknobx")._("1683");a&&e&&c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton);return a.runInTransaction(function(a){return c("LSScheduleOccamThreadsIntegrityCheckerStoredProcedure")(c("LSFactory")(a),{delayMs:(i||(i=d("I64"))).of_int32(6e4),maxThreadCount:i.of_int32(20)})},"readonly")})())}catch(a){c("FBLogger")("labyrinth_web").warn("Error running thread integrity checker",a)}}g["default"]=a}),98);
__d("useLegacyUserWatchdog",["MAWIssueNewUserVisibleErrors","clearTimeout","react","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;b=24*60*60*1e3;var j=5*b;function a(){i(function(){var a=c("setTimeout")(function(){var a;(a=d("MAWIssueNewUserVisibleErrors")).issueError(a.MAWLegacyUserErrorMsgBody,a.MAWLegacyUserErrorMsgTitle,a.MAWUserVisibleErrorPresentationType.BANNER)},j);return function(){return c("clearTimeout")(a)}})}g["default"]=a}),98);
__d("useMAWReregisterDeviceOnError",["LSPersistedDbGating","MAWBridgeSendAndReceive","MAWIssueNewUserVisibleErrors","MAWLoggerUtils","MAWReinitWorker","MAWSetupWorker","MAWStateContext.react","ODS","WATagsLogger","asyncToGeneratorRuntime","react","shouldUseMAWSharedWorker","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to reinit worker ",""]);j=function(){return a};return a}e=h||d("react");var k=e.useCallback,l=e.useContext,m=!1,n=typeof window!=="undefined"?window:self;function o(){m=!0,d("MAWSetupWorker").terminateWorkerPermanently(),(i||(i=d("ODS"))).bumpEntityKey(3185,"armadillo_forced_reregister_fail",n.location.hostname),d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER)}function a(a){var e=a.getOrSetupWorker,f=a.rotateCryptoAuthToken,g=a.setupBridge,h=a.terminateWorker,p=c("useAsyncReStore")(),q=d("MAWStateContext.react").useDispatchClearEphemeralSettings();a=l(d("MAWStateContext.react").MAWStateContext);var r=a.dispatch;return k(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(m)return;(i||(i=d("ODS"))).bumpEntityKey(3185,"armadillo_forced_deregister",n.location.hostname);yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","removeCurrentDevice");var a=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();d("shouldUseMAWSharedWorker").logExposureForMAWSharedWorker();a&&(yield d("MAWSetupWorker").killSharedWorker());h("useMAWReregisterDeviceOnError");try{a=(yield p);yield c("MAWReinitWorker")({allTablesPersisted:d("LSPersistedDbGating").allTablesPersisted,db:a,dispatch:r,dispatchClearEphemeralSettings:q,getOrSetupWorker:e,logout:o,reregisterDevice:o,rotateCryptoAuthToken:f,setupBridge:g,workerCreateReason:"mawReinitReregDevice"})}catch(b){a=b.description||b.message||b;d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.DeviceRegistration,d("MAWLoggerUtils").Tag.LogoutHandler,d("MAWLoggerUtils").Tag.WorkerSetup,d("MAWLoggerUtils").Tag.MAWWorker,d("MAWLoggerUtils").Tag.MAWInit]).ERROR(j(),a);d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER)}}),[h,p,r,q,e,f,g])}g["default"]=a}),98);
__d("useStorageUsageMetricsLogger",["cr:3504","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(){i(function(){void (b("cr:3504")==null?void 0:b("cr:3504").logMAWDBUsageMetrics())},[])}g["default"]=a}),98);
__d("MAWSetupImpl.react",["BaseHeadingContext","CometRelay","MAWCommonSetup","MAWCryptoAuthToken","MAWSetupMutex.react","MAWSetupWorker","MAWStateContext.react","MAWWebWorkerInstance","cr:6159","cr:6160","cr:8800","promiseDone","react","shouldUseMAWSharedWorker","useDataLossChecker","useLegacyUserWatchdog","useMAWReregisterDeviceOnError","useStorageUsageMetricsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));e=h;var j=e.useCallback,k=e.useContext,l=e.useEffect,m=e.useMemo;window.XPlatTesting=b("cr:6159");window.XPlatTestingGroups=b("cr:6160");window.XPlatMockServer=b("cr:8800");function a(a){var b,e=a.children,f=a.fbid,g=a.logout,h=a.setupBridge;a=k(d("MAWStateContext.react").MAWStateContext);a=a.dispatch;var n=d("CometRelay").useRelayEnvironment(),o=j(function(){return d("MAWCryptoAuthToken").fetchFreshCAT(n)},[n]),p=c("useMAWReregisterDeviceOnError")({doesWorkerExist:d("MAWWebWorkerInstance").doesWorkerExist,getOrSetupWorker:(b=d("MAWSetupWorker")).getOrSetupWorker,isSharedWorkerActive:b.isSharedWorkerActive,rotateCryptoAuthToken:o,setupBridge:h,terminateWorker:b.terminateWorker,terminateWorkerPermanently:b.terminateWorkerPermanently});b=m(function(){return{doesWorkerExist:d("MAWWebWorkerInstance").doesWorkerExist,getOrSetupWorker:d("MAWSetupWorker").getOrSetupWorker,isSharedWorkerActive:d("MAWSetupWorker").isSharedWorkerActive,logout:g!=null?g:function(){return c("promiseDone")(p())},reregisterDevice:function(){return c("promiseDone")(p())},rotateCryptoAuthToken:o,setupBridge:h,terminateWorker:d("MAWSetupWorker").terminateWorker,terminateWorkerPermanently:d("MAWSetupWorker").terminateWorkerPermanently}},[o,g,p,h]);d("MAWCommonSetup").useArmadillo(b);c("useLegacyUserWatchdog")();c("useDataLossChecker")();c("useStorageUsageMetricsLogger")();l(function(){d("shouldUseMAWSharedWorker").logExposureForMAWSharedWorker()});var q=k(c("BaseHeadingContext")),r=!d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();return i.jsxs(c("BaseHeadingContext").Provider,{value:q+1,children:[e,r?i.jsx(c("MAWSetupMutex.react"),{dispatch:a,environment:n,fbId:f,platformSetupUtils:b}):null]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSSetIGE2EEEligibility",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.filter(c.db.table(176).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.contactId,a[0])&&c.i64.eq(b.e2eeEligibility,a[1])}).next().then(function(e,f){f=e.done;e=e.value;return f?(d[1]=new c.Map(),d[1].set("contact_id",a[0]),d[1].set("new_eligibility",a[1]),d[2]=c.toJSON(d[1]),c.storedProcedure(b("LSIssueNewTask"),"ig_set_e2ee_eligibility",c.i64.cast([0,60001]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):(e.item,0)})},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSSetIGE2EEEligibilityStoredProcedure",["LSSetIGE2EEEligibility","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.id;d[1]=b.e2eeEligibility;return c("LSSetIGE2EEEligibility").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("IGDSetIGE2EEEligibility",["I64","LSDatabaseSingleton","LSFactory","LSInstagramE2EEEligibility","LSIntEnum","LSSetIGE2EEEligibilityStoredProcedure","MAWCurrentUser","asyncToGeneratorRuntime","gkx","justknobx","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=(h||d("react")).useEffect;function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield (i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton);return e.runInTransaction(function(e){return c("LSSetIGE2EEEligibilityStoredProcedure")(c("LSFactory")(e),{e2eeEligibility:(j||(j=d("LSIntEnum"))).ofNumber(b),id:(k||(k=d("I64"))).of_string(a)})},"readwrite")});return n.apply(this,arguments)}function a(){l(function(){if(c("gkx")("8314")===!1||c("justknobx")._("2058"))return;var a=d("MAWCurrentUser").getID();c("promiseDone")(m(a,c("LSInstagramE2EEEligibility").ELIGIBLE))},[])}g.useUpsertSetIGE2EEEligibilityOnMount=a}),98);
__d("IGDSetupBridge",["FBLogger","LSDatabaseSingleton","LSInitSyncCompleteSubscription","MAWAbPropsClient","MAWBridgeReceivedChatStateHandler","MAWBridgeUIEventHandler","MAWCommonSetupBridge","MAWEncryptionErrorHandler","MAWExceededStorageQuota","MAWFetchContacts","MAWGetEphemeralSettings","MAWSetupBridgeOfflineSnapshot","Run","asyncToGeneratorRuntime","cr:3411","cr:5889","isInstamadillo","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("ArmadilloCutoverClientFalcoEvent").__setRef("IGDSetupBridge"),j=c("requireDeferred")("MAWBridgeUpdateDYIStatusV2").__setRef("IGDSetupBridge"),k=c("requireDeferred")("MAWSetupBridgeOfflineConsumer").__setRef("IGDSetupBridge"),l=(h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(d("LSInitSyncCompleteSubscription").use).then(function(){return(h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton}),m=function(a){i.loadImmediately(function(b){b=b.log;return b(function(){return{armadillo_thread_id:a.armadilloThreadId,domain:a.domain,event:a.event,event_details:a.eventDetails,open_thread_id:a.openThreadId,success:a.success,trace_id:a.traceId}})})},n=new Set(["StartTraceWithTraceId","TraceRecordCheckpoint"]),o=new Set(["ABPropsUpdated","ClockSkewUpdated","DropAllSecureThreads","LargeClockSkewValue","ReceivedChatState"]);function a(a){var e=a.dispatch,f=a.logout,g=a.reregisterDevice,h=a.rotateCryptoAuthToken,i=a.worker;function p(){i.postMessage({type:"force-flush-data"})}d("Run").onUnload(p);d("Run").onBeforeUnload(p,!1);return d("MAWCommonSetupBridge").initBridge({customizeEventHandlers:{abPropsUpdated:function(a){d("MAWAbPropsClient").rewrite(a.abProps)},earDecryptionFailure:function(a){d("MAWEncryptionErrorHandler").deleteAllDbs(a.tableName)},getLSDBEphemeralSetting:function(a){return d("MAWGetEphemeralSettings").getEphemeralSetting(a.chatJid)},getLSDBUsersIsMsplit:function(a){return d("MAWFetchContacts").fetchContactsIsMsplit(a.users)},getLSDBUsersRelationships:function(a){return d("MAWFetchContacts").fetchContactsRelationships(a.users)},logCutoverEvent:m,logout:f,offlineConsumerProgress:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return(yield k.load())(l,e).apply(void 0,arguments)});function c(){return a.apply(this,arguments)}return c}(),offlineSnapshot:c("MAWSetupBridgeOfflineSnapshot")(e),receivedChatState:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield l);yield c.runInTransaction(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield d("MAWBridgeReceivedChatStateHandler").call(b,a)});return function(a){return c.apply(this,arguments)}}(),"readwrite")});function c(b){return a.apply(this,arguments)}return c}(),relayUpdate:function(a){b("cr:5889")==null?void 0:b("cr:5889").handleUpdateFromWorker(a)},reregisterDevice:g,rotateCryptoAuthToken:h,storageQuota:function(a){a=a.exceededStorageQuota;d("MAWExceededStorageQuota").setExceededStorageQuota(a)},uiUpdate:function(a){a=a.events;var e=[],f=a.filter(function(a){if(n.has(a.tag)){e.push(a);return!1}if(o.has(a.tag))return!1});e.length>0&&(b("cr:3411")==null?void 0:b("cr:3411").recordBridgeUIEvent(a),d("MAWBridgeUIEventHandler").handleEvents(l,a));if(f.length===0)return;c("isInstamadillo")()?c("FBLogger")("igd_web_on_msgr").warn("[Instamadillo] Unsupported invocation of UI Event Handler. Please deprecate UI Event Handler: %s",a.map(function(a){return a.tag}).join(", ")):c("FBLogger")("igd_web_on_msgr").warn("[IGD] Deprecating UIEventHandlers, please update LSDB directly for UI changes: %s",a.map(function(a){return a.tag}).join(", "))},updateDYIStatus:function(a){var b=a.qplInstanceKeyE2E,d=a.status;c("promiseDone")(j.load().then(function(a){return a.call({qplInstanceKeyE2E:b,status:d})}))}},worker:i})}g.setupBridge=a}),98);
__d("IGDAWSetup.react",["CometRelayEnvironmentProvider","FBLogger","IGDSetIGE2EEEligibility","IGDSetupBridge","MAWCurrentUser","MAWSetupImpl.react","MAWStateContextProvider.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.unstable_useMemoCache;function a(a){var b=j(5);a=a.children;var e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=function(){},b[0]=e):e=b[0];e=e;d("IGDSetIGE2EEEligibility").useUpsertSetIGE2EEEligibilityOnMount();var f;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(f="xjp7ctv",b[1]=f):f=b[1];var g;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(g=d("MAWCurrentUser").getID(),b[2]=g):g=b[2];b[3]!==a?(f=i.jsx("div",{className:f,"data-testid":void 0,children:i.jsx(c("CometRelayEnvironmentProvider"),{children:i.jsx(c("MAWStateContextProvider.react"),{children:i.jsx(c("MAWSetupImpl.react"),{fbid:g,logout:e,setupBridge:d("IGDSetupBridge").setupBridge,children:a})})})}),b[3]=a,b[4]=f):f=b[4];return f}g["default"]=a}),98);
__d("MAWDBUsageMetrics",["WALogger","WebStorageEstimator","asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error while getting the storage manager estimate: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Sending storage manager estimates falco event, quota: ",", usage: ",", usage_details: ",""]);i=function(){return a};return a}var j=c("requireDeferred")("WebStorageManagerEstimatesFalcoEvent").__setRef("MAWDBUsageMetrics");function a(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield d("WebStorageEstimator").estimateStorage());j.onReady(function(b){d("WALogger").DEV(i(),a==null?void 0:a.quota,a==null?void 0:a.usage,a==null?void 0:a.usageDetails),b.log(function(){var b;return{quota:String(a==null?void 0:a.quota),usage:String(a==null?void 0:a.usage),usage_details:{caches:String((b=a==null?void 0:(b=a.usageDetails)==null?void 0:b.caches)!=null?b:""),indexedDB:String((b=a==null?void 0:(b=a.usageDetails)==null?void 0:b.indexedDB)!=null?b:""),serviceWorkerRegistrations:String((b=a==null?void 0:(b=a.usageDetails)==null?void 0:b.serviceWorkerRegistrations)!=null?b:"")}}})})}catch(a){d("WALogger").DEV(h(),a);return}});return k.apply(this,arguments)}g.logMAWDBUsageMetrics=a}),98);
__d("LSDatascriptEvaluatorDeferred",["cr:3164"],(function(a,b,c,d,e,f,g){"use strict";function a(){return b("cr:3164").load()}g["default"]=a}),98);
__d("LSDatascriptEvaluatorDeferredInnerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";a=c("requireDeferred")("LSDatascriptEvaluator").__setRef("LSDatascriptEvaluatorDeferredInnerDeferred");b=a;g["default"]=b}),98);
__d("LSPlatformSyncSystemDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("LSPlatformSyncSystem").__setRef("LSPlatformSyncSystemDeferred");function a(){return h.load()}g["default"]=a}),98);